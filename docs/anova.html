<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 25 ANOVA | R Reference Book</title>
  <meta name="description" content="This is a collection of useful R knowledge" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 25 ANOVA | R Reference Book" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/figures/01_cover/Cover.svg" />
  <meta property="og:description" content="This is a collection of useful R knowledge" />
  <meta name="github-repo" content="retodomax/R_Ref_Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 25 ANOVA | R Reference Book" />
  
  <meta name="twitter:description" content="This is a collection of useful R knowledge" />
  <meta name="twitter:image" content="/figures/01_cover/Cover.svg" />

<meta name="author" content="Reto Zihlmann" />


<meta name="date" content="2023-07-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="figures/00_icon/icon2.ico" type="image/x-icon" />
<link rel="prev" href="regression.html"/>
<link rel="next" href="MultivarStat.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!––JavaScript code for Show/Hide buttons––>
<!––see: https://web.stanford.edu/~naras/post/toggle-visibility-of-solutions-in-bookdown/––>
<!––and see: https://www.w3schools.com/howto/howto_js_toggle_hide_show.asp––>

<script>
function myFunction(myid) {
  var x = document.getElementById(myid);
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }
}
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Reference book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="table-of-content.html"><a href="table-of-content.html"><i class="fa fa-check"></i>Table of content</a></li>
<li class="part"><span><b>I R Language</b></span></li>
<li class="chapter" data-level="1" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>1</b> Objects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="objects.html"><a href="objects.html#inspect-object"><i class="fa fa-check"></i><b>1.1</b> Inspect object</a></li>
<li class="chapter" data-level="1.2" data-path="objects.html"><a href="objects.html#classifications"><i class="fa fa-check"></i><b>1.2</b> Classifications</a></li>
<li class="chapter" data-level="1.3" data-path="objects.html"><a href="objects.html#basic-objects"><i class="fa fa-check"></i><b>1.3</b> Basic Objects</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="objects.html"><a href="objects.html#vectors-functions-and-environments"><i class="fa fa-check"></i><b>1.3.1</b> Vectors, functions and environments</a></li>
<li class="chapter" data-level="1.3.2" data-path="objects.html"><a href="objects.html#symbols"><i class="fa fa-check"></i><b>1.3.2</b> Symbols</a></li>
<li class="chapter" data-level="1.3.3" data-path="objects.html"><a href="objects.html#calls"><i class="fa fa-check"></i><b>1.3.3</b> Calls</a></li>
<li class="chapter" data-level="1.3.4" data-path="objects.html"><a href="objects.html#expression"><i class="fa fa-check"></i><b>1.3.4</b> Expression</a></li>
<li class="chapter" data-level="1.3.5" data-path="objects.html"><a href="objects.html#formulas"><i class="fa fa-check"></i><b>1.3.5</b> Formulas</a></li>
<li class="chapter" data-level="1.3.6" data-path="objects.html"><a href="objects.html#not-understand-yet"><i class="fa fa-check"></i><b>1.3.6</b> Not understand yet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vec.html"><a href="vec.html"><i class="fa fa-check"></i><b>2</b> Vectors</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vec.html"><a href="vec.html#type"><i class="fa fa-check"></i><b>2.1</b> Type</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="vec.html"><a href="vec.html#atomic"><i class="fa fa-check"></i><b>2.1.1</b> Atomic</a></li>
<li class="chapter" data-level="2.1.2" data-path="vec.html"><a href="vec.html#list"><i class="fa fa-check"></i><b>2.1.2</b> List</a></li>
<li class="chapter" data-level="2.1.3" data-path="vec.html"><a href="vec.html#check-type-of-vector"><i class="fa fa-check"></i><b>2.1.3</b> Check type of vector</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="vec.html"><a href="vec.html#length"><i class="fa fa-check"></i><b>2.2</b> Length</a></li>
<li class="chapter" data-level="2.3" data-path="vec.html"><a href="vec.html#attributes"><i class="fa fa-check"></i><b>2.3</b> Attributes</a></li>
<li class="chapter" data-level="2.4" data-path="vec.html"><a href="vec.html#vec-factors"><i class="fa fa-check"></i><b>2.4</b> Factors</a></li>
<li class="chapter" data-level="2.5" data-path="vec.html"><a href="vec.html#matricesarrays"><i class="fa fa-check"></i><b>2.5</b> Matrices/Arrays</a></li>
<li class="chapter" data-level="2.6" data-path="vec.html"><a href="vec.html#data-frames"><i class="fa fa-check"></i><b>2.6</b> Data frames</a></li>
<li class="chapter" data-level="2.7" data-path="vec.html"><a href="vec.html#special-values"><i class="fa fa-check"></i><b>2.7</b> Special values</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="vec.html"><a href="vec.html#missing-values"><i class="fa fa-check"></i><b>2.7.1</b> Missing values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fun.html"><a href="fun.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fun.html"><a href="fun.html#FunTypes"><i class="fa fa-check"></i><b>3.1</b> Types</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="fun.html"><a href="fun.html#primitive-functions"><i class="fa fa-check"></i><b>3.1.1</b> Primitive functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fun.html"><a href="fun.html#function-components"><i class="fa fa-check"></i><b>3.2</b> Function components</a></li>
<li class="chapter" data-level="3.3" data-path="fun.html"><a href="fun.html#function-arguments"><i class="fa fa-check"></i><b>3.3</b> Arguments</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fun.html"><a href="fun.html#lazy-evaluation"><i class="fa fa-check"></i><b>3.3.1</b> Lazy evaluation:</a></li>
<li class="chapter" data-level="3.3.2" data-path="fun.html"><a href="fun.html#elipsis-..."><i class="fa fa-check"></i><b>3.3.2</b> Elipsis <code>...</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="fun.html"><a href="fun.html#function-environment"><i class="fa fa-check"></i><b>3.4</b> Environment</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="fun.html"><a href="fun.html#lexical-scoping"><i class="fa fa-check"></i><b>3.4.1</b> Lexical scoping</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="fun.html"><a href="fun.html#return-value"><i class="fa fa-check"></i><b>3.5</b> Return value</a></li>
<li class="chapter" data-level="3.6" data-path="fun.html"><a href="fun.html#special-calls"><i class="fa fa-check"></i><b>3.6</b> Special calls</a></li>
<li class="chapter" data-level="3.7" data-path="fun.html"><a href="fun.html#generic-functions"><i class="fa fa-check"></i><b>3.7</b> Generic functions</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="fun.html"><a href="fun.html#s3-and-s4"><i class="fa fa-check"></i><b>3.7.1</b> S3 and S4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="env.html"><a href="env.html"><i class="fa fa-check"></i><b>4</b> Environments</a>
<ul>
<li class="chapter" data-level="4.1" data-path="env.html"><a href="env.html#general-properties"><i class="fa fa-check"></i><b>4.1</b> General properties</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="env.html"><a href="env.html#definition"><i class="fa fa-check"></i><b>4.1.1</b> Definition</a></li>
<li class="chapter" data-level="4.1.2" data-path="env.html"><a href="env.html#attributes-1"><i class="fa fa-check"></i><b>4.1.2</b> Attributes</a></li>
<li class="chapter" data-level="4.1.3" data-path="env.html"><a href="env.html#special-environments"><i class="fa fa-check"></i><b>4.1.3</b> Special environments</a></li>
<li class="chapter" data-level="4.1.4" data-path="env.html"><a href="env.html#search-path-and-search-list"><i class="fa fa-check"></i><b>4.1.4</b> Search path and search list</a></li>
<li class="chapter" data-level="4.1.5" data-path="env.html"><a href="env.html#objects-within-the-environment"><i class="fa fa-check"></i><b>4.1.5</b> Objects within the environment</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="env.html"><a href="env.html#environment-of-functions"><i class="fa fa-check"></i><b>4.2</b> Environment of functions</a></li>
<li class="chapter" data-level="4.3" data-path="env.html"><a href="env.html#packages"><i class="fa fa-check"></i><b>4.3</b> Packages</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="env.html"><a href="env.html#package-environment"><i class="fa fa-check"></i><b>4.3.1</b> Package environment</a></li>
<li class="chapter" data-level="4.3.2" data-path="env.html"><a href="env.html#namespace-environment"><i class="fa fa-check"></i><b>4.3.2</b> Namespace environment</a></li>
<li class="chapter" data-level="4.3.3" data-path="env.html"><a href="env.html#imports-environment"><i class="fa fa-check"></i><b>4.3.3</b> Imports environment</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="env.html"><a href="env.html#examples"><i class="fa fa-check"></i><b>4.4</b> Examples</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="env.html"><a href="env.html#example-1-pass-object-of-class-acf-to-plot"><i class="fa fa-check"></i><b>4.4.1</b> Example 1: pass object of class “acf” to <code>plot()</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="env.html"><a href="env.html#example-2-search-list-call-stack"><i class="fa fa-check"></i><b>4.4.2</b> Example 2: Search list ≠ call stack</a></li>
<li class="chapter" data-level="4.4.3" data-path="env.html"><a href="env.html#example-3-change-package-function"><i class="fa fa-check"></i><b>4.4.3</b> Example 3: Change package function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="settings.html"><a href="settings.html"><i class="fa fa-check"></i><b>5</b> Settings</a>
<ul>
<li class="chapter" data-level="5.1" data-path="settings.html"><a href="settings.html#error-language"><i class="fa fa-check"></i><b>5.1</b> Error language</a></li>
<li class="chapter" data-level="5.2" data-path="settings.html"><a href="settings.html#local"><i class="fa fa-check"></i><b>5.2</b> Local</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>6</b> Miscellaneous</a>
<ul>
<li class="chapter" data-level="6.1" data-path="miscellaneous.html"><a href="miscellaneous.html#how-does-r-save-numbers"><i class="fa fa-check"></i><b>6.1</b> How does R save numbers</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-avoid-problems-with-doubles"><i class="fa fa-check"></i><b>6.1.1</b> How to avoid problems with doubles</a></li>
<li class="chapter" data-level="6.1.2" data-path="miscellaneous.html"><a href="miscellaneous.html#more-interesting-information-about-double-representation"><i class="fa fa-check"></i><b>6.1.2</b> More interesting information about double representation</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="miscellaneous.html"><a href="miscellaneous.html#how-packages-can-exist"><i class="fa fa-check"></i><b>6.2</b> How packages can exist</a></li>
<li class="chapter" data-level="6.3" data-path="miscellaneous.html"><a href="miscellaneous.html#good-practice-in-r-programming"><i class="fa fa-check"></i><b>6.3</b> Good practice in R programming</a></li>
</ul></li>
<li class="part"><span><b>II R Basics</b></span></li>
<li class="chapter" data-level="7" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>7</b> Data Import/Export</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-importexport.html"><a href="data-importexport.html#directories"><i class="fa fa-check"></i><b>7.1</b> Directories</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="data-importexport.html"><a href="data-importexport.html#functions"><i class="fa fa-check"></i><b>7.1.1</b> Functions</a></li>
<li class="chapter" data-level="7.1.2" data-path="data-importexport.html"><a href="data-importexport.html#path-to-your-file"><i class="fa fa-check"></i><b>7.1.2</b> Path to your file</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-importexport.html"><a href="data-importexport.html#read-data"><i class="fa fa-check"></i><b>7.2</b> Read data</a></li>
<li class="chapter" data-level="7.3" data-path="data-importexport.html"><a href="data-importexport.html#clipboard"><i class="fa fa-check"></i><b>7.3</b> Clipboard</a></li>
<li class="chapter" data-level="7.4" data-path="data-importexport.html"><a href="data-importexport.html#github"><i class="fa fa-check"></i><b>7.4</b> Github</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>8</b> Data handling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-handling.html"><a href="data-handling.html#atomic-vectors"><i class="fa fa-check"></i><b>8.1</b> Atomic vectors</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="data-handling.html"><a href="data-handling.html#basic-operations"><i class="fa fa-check"></i><b>8.1.1</b> Basic operations</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-handling.html"><a href="data-handling.html#factors"><i class="fa fa-check"></i><b>8.1.2</b> Factors</a></li>
<li class="chapter" data-level="8.1.3" data-path="data-handling.html"><a href="data-handling.html#date-time"><i class="fa fa-check"></i><b>8.1.3</b> Date Time</a></li>
<li class="chapter" data-level="8.1.4" data-path="data-handling.html"><a href="data-handling.html#strings"><i class="fa fa-check"></i><b>8.1.4</b> Strings</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-handling.html"><a href="data-handling.html#lists"><i class="fa fa-check"></i><b>8.2</b> Lists</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="data-handling.html"><a href="data-handling.html#apply-familiy"><i class="fa fa-check"></i><b>8.2.1</b> Apply familiy</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-handling.html"><a href="data-handling.html#long-and-wide-format"><i class="fa fa-check"></i><b>8.2.2</b> Long and wide format</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-handling.html"><a href="data-handling.html#aggregate"><i class="fa fa-check"></i><b>8.2.3</b> Aggregate</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-handling.html"><a href="data-handling.html#sql-joins"><i class="fa fa-check"></i><b>8.2.4</b> SQL joins</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data-handling.html"><a href="data-handling.html#dplyr-functions"><i class="fa fa-check"></i><b>8.3</b> <code>dplyr</code> functions</a></li>
<li class="chapter" data-level="8.4" data-path="data-handling.html"><a href="data-handling.html#basic-functions"><i class="fa fa-check"></i><b>8.4</b> Basic functions</a></li>
<li class="chapter" data-level="8.5" data-path="data-handling.html"><a href="data-handling.html#add-ons"><i class="fa fa-check"></i><b>8.5</b> Add ons</a></li>
<li class="chapter" data-level="8.6" data-path="data-handling.html"><a href="data-handling.html#tidyselect"><i class="fa fa-check"></i><b>8.6</b> tidyselect</a></li>
<li class="chapter" data-level="8.7" data-path="data-handling.html"><a href="data-handling.html#additinally-useful"><i class="fa fa-check"></i><b>8.7</b> Additinally useful</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>9</b> Regular expressions</a></li>
<li class="part"><span><b>III R Programming</b></span></li>
<li class="chapter" data-level="10" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>10</b> Basics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basics.html"><a href="basics.html#objects-in-enviornment"><i class="fa fa-check"></i><b>10.1</b> Objects in Enviornment</a></li>
<li class="chapter" data-level="10.2" data-path="basics.html"><a href="basics.html#functions-2"><i class="fa fa-check"></i><b>10.2</b> Functions</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basics.html"><a href="basics.html#function-debugging"><i class="fa fa-check"></i><b>10.2.1</b> Function debugging</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basics.html"><a href="basics.html#control-structures"><i class="fa fa-check"></i><b>10.3</b> Control structures</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="basics.html"><a href="basics.html#conditional-statements"><i class="fa fa-check"></i><b>10.3.1</b> Conditional statements</a></li>
<li class="chapter" data-level="10.3.2" data-path="basics.html"><a href="basics.html#loops"><i class="fa fa-check"></i><b>10.3.2</b> Loops</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>11</b> Performance</a>
<ul>
<li class="chapter" data-level="11.1" data-path="performance.html"><a href="performance.html#in-general"><i class="fa fa-check"></i><b>11.1</b> In general</a></li>
<li class="chapter" data-level="11.2" data-path="performance.html"><a href="performance.html#profiling"><i class="fa fa-check"></i><b>11.2</b> Profiling</a></li>
<li class="chapter" data-level="11.3" data-path="performance.html"><a href="performance.html#microbenchmark"><i class="fa fa-check"></i><b>11.3</b> Microbenchmark</a></li>
<li class="chapter" data-level="11.4" data-path="performance.html"><a href="performance.html#use-package-compiler"><i class="fa fa-check"></i><b>11.4</b> Use package compiler</a></li>
<li class="chapter" data-level="11.5" data-path="performance.html"><a href="performance.html#parallelise"><i class="fa fa-check"></i><b>11.5</b> Parallelise</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="functional-programming.html"><a href="functional-programming.html"><i class="fa fa-check"></i><b>12</b> Functional programming</a>
<ul>
<li class="chapter" data-level="12.1" data-path="functional-programming.html"><a href="functional-programming.html#FunProgClosures"><i class="fa fa-check"></i><b>12.1</b> Closures</a></li>
<li class="chapter" data-level="12.2" data-path="functional-programming.html"><a href="functional-programming.html#lists-of-functions"><i class="fa fa-check"></i><b>12.2</b> Lists of functions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="r-from-the-shell.html"><a href="r-from-the-shell.html"><i class="fa fa-check"></i><b>13</b> R from the shell</a></li>
<li class="chapter" data-level="14" data-path="use-r-interactively-in-console-linux.html"><a href="use-r-interactively-in-console-linux.html"><i class="fa fa-check"></i><b>14</b> Use R interactively in console (Linux)</a></li>
<li class="chapter" data-level="15" data-path="run-sweave-from-console.html"><a href="run-sweave-from-console.html"><i class="fa fa-check"></i><b>15</b> Run Sweave from console</a></li>
<li class="chapter" data-level="16" data-path="extract-r-code-from-rnw-file.html"><a href="extract-r-code-from-rnw-file.html"><i class="fa fa-check"></i><b>16</b> Extract R code from Rnw file</a></li>
<li class="chapter" data-level="17" data-path="remote-servers.html"><a href="remote-servers.html"><i class="fa fa-check"></i><b>17</b> Remote Servers</a>
<ul>
<li class="chapter" data-level="17.1" data-path="remote-servers.html"><a href="remote-servers.html#uzh-thinlinc"><i class="fa fa-check"></i><b>17.1</b> UZH Thinlinc</a></li>
<li class="chapter" data-level="17.2" data-path="remote-servers.html"><a href="remote-servers.html#eth-euler"><i class="fa fa-check"></i><b>17.2</b> ETH Euler</a></li>
<li class="chapter" data-level="17.3" data-path="remote-servers.html"><a href="remote-servers.html#renkulab"><i class="fa fa-check"></i><b>17.3</b> Renkulab</a></li>
<li class="chapter" data-level="17.4" data-path="remote-servers.html"><a href="remote-servers.html#get-notification-when-finished"><i class="fa fa-check"></i><b>17.4</b> Get notification when finished</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="remote-servers.html"><a href="remote-servers.html#mail-notification"><i class="fa fa-check"></i><b>17.4.1</b> Mail notification</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV R Output</b></span></li>
<li class="chapter" data-level="18" data-path="Plots.html"><a href="Plots.html"><i class="fa fa-check"></i><b>18</b> Base graphics</a>
<ul>
<li class="chapter" data-level="18.1" data-path="Plots.html"><a href="Plots.html#graphical-parameters-par"><i class="fa fa-check"></i><b>18.1</b> Graphical parameters <code>par()</code></a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="Plots.html"><a href="Plots.html#set-graphical-parameters"><i class="fa fa-check"></i><b>18.1.1</b> Set graphical parameters</a></li>
<li class="chapter" data-level="18.1.2" data-path="Plots.html"><a href="Plots.html#default"><i class="fa fa-check"></i><b>18.1.2</b> Default</a></li>
<li class="chapter" data-level="18.1.3" data-path="Plots.html"><a href="Plots.html#device"><i class="fa fa-check"></i><b>18.1.3</b> Device</a></li>
<li class="chapter" data-level="18.1.4" data-path="Plots.html"><a href="Plots.html#device-region"><i class="fa fa-check"></i><b>18.1.4</b> Device region</a></li>
<li class="chapter" data-level="18.1.5" data-path="Plots.html"><a href="Plots.html#coordinate-sytem"><i class="fa fa-check"></i><b>18.1.5</b> Coordinate sytem</a></li>
<li class="chapter" data-level="18.1.6" data-path="Plots.html"><a href="Plots.html#define-device-regions"><i class="fa fa-check"></i><b>18.1.6</b> Define device regions</a></li>
<li class="chapter" data-level="18.1.7" data-path="Plots.html"><a href="Plots.html#user-coordinates-limits"><i class="fa fa-check"></i><b>18.1.7</b> User coordinates limits</a></li>
<li class="chapter" data-level="18.1.8" data-path="Plots.html"><a href="Plots.html#general-appearence"><i class="fa fa-check"></i><b>18.1.8</b> General appearence</a></li>
<li class="chapter" data-level="18.1.9" data-path="Plots.html"><a href="Plots.html#symbols-1"><i class="fa fa-check"></i><b>18.1.9</b> Symbols</a></li>
<li class="chapter" data-level="18.1.10" data-path="Plots.html"><a href="Plots.html#lines"><i class="fa fa-check"></i><b>18.1.10</b> Lines</a></li>
<li class="chapter" data-level="18.1.11" data-path="Plots.html"><a href="Plots.html#text"><i class="fa fa-check"></i><b>18.1.11</b> Text</a></li>
<li class="chapter" data-level="18.1.12" data-path="Plots.html"><a href="Plots.html#axis-labels"><i class="fa fa-check"></i><b>18.1.12</b> Axis labels</a></li>
<li class="chapter" data-level="18.1.13" data-path="Plots.html"><a href="Plots.html#axis"><i class="fa fa-check"></i><b>18.1.13</b> Axis</a></li>
<li class="chapter" data-level="18.1.14" data-path="Plots.html"><a href="Plots.html#ticks"><i class="fa fa-check"></i><b>18.1.14</b> Ticks</a></li>
<li class="chapter" data-level="18.1.15" data-path="Plots.html"><a href="Plots.html#box"><i class="fa fa-check"></i><b>18.1.15</b> Box</a></li>
<li class="chapter" data-level="18.1.16" data-path="Plots.html"><a href="Plots.html#title"><i class="fa fa-check"></i><b>18.1.16</b> Title</a></li>
<li class="chapter" data-level="18.1.17" data-path="Plots.html"><a href="Plots.html#r.o.-read-only"><i class="fa fa-check"></i><b>18.1.17</b> R.O. (Read only)</a></li>
<li class="chapter" data-level="18.1.18" data-path="Plots.html"><a href="Plots.html#useless"><i class="fa fa-check"></i><b>18.1.18</b> Useless</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="Plots.html"><a href="Plots.html#graphics-size-and-resolution"><i class="fa fa-check"></i><b>18.2</b> Graphics Size and Resolution</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="Plots.html"><a href="Plots.html#terminology"><i class="fa fa-check"></i><b>18.2.1</b> Terminology</a></li>
<li class="chapter" data-level="18.2.2" data-path="Plots.html"><a href="Plots.html#devices"><i class="fa fa-check"></i><b>18.2.2</b> Devices</a></li>
<li class="chapter" data-level="18.2.3" data-path="Plots.html"><a href="Plots.html#resolution-and-font-size-with-png"><i class="fa fa-check"></i><b>18.2.3</b> Resolution and Font Size with png</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="Plots.html"><a href="Plots.html#colors"><i class="fa fa-check"></i><b>18.3</b> Colors</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="Plots.html"><a href="Plots.html#convert-fromto-different-color-specification"><i class="fa fa-check"></i><b>18.3.1</b> Convert from/to different color specification</a></li>
<li class="chapter" data-level="18.3.2" data-path="Plots.html"><a href="Plots.html#make-new-palettes"><i class="fa fa-check"></i><b>18.3.2</b> Make new palettes</a></li>
<li class="chapter" data-level="18.3.3" data-path="Plots.html"><a href="Plots.html#partially-transparent-colors"><i class="fa fa-check"></i><b>18.3.3</b> Partially transparent colors</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="Plots.html"><a href="Plots.html#mathematical-annotation"><i class="fa fa-check"></i><b>18.4</b> Mathematical annotation</a></li>
<li class="chapter" data-level="18.5" data-path="Plots.html"><a href="Plots.html#high-level-plots"><i class="fa fa-check"></i><b>18.5</b> High level plots</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="Plots.html"><a href="Plots.html#plot-function"><i class="fa fa-check"></i><b>18.5.1</b> Plot function</a></li>
<li class="chapter" data-level="18.5.2" data-path="Plots.html"><a href="Plots.html#example-barplot"><i class="fa fa-check"></i><b>18.5.2</b> Example: Barplot</a></li>
<li class="chapter" data-level="18.5.3" data-path="Plots.html"><a href="Plots.html#example-matplot"><i class="fa fa-check"></i><b>18.5.3</b> Example: Matplot</a></li>
<li class="chapter" data-level="18.5.4" data-path="Plots.html"><a href="Plots.html#example-image-and-contour-plot"><i class="fa fa-check"></i><b>18.5.4</b> Example: image and contour plot</a></li>
<li class="chapter" data-level="18.5.5" data-path="Plots.html"><a href="Plots.html#example-boxplot"><i class="fa fa-check"></i><b>18.5.5</b> Example: Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="Plots.html"><a href="Plots.html#low-level-plots"><i class="fa fa-check"></i><b>18.6</b> Low level plots</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="Plots.html"><a href="Plots.html#legends"><i class="fa fa-check"></i><b>18.6.1</b> Legends</a></li>
<li class="chapter" data-level="18.6.2" data-path="Plots.html"><a href="Plots.html#arrow"><i class="fa fa-check"></i><b>18.6.2</b> Arrow</a></li>
<li class="chapter" data-level="18.6.3" data-path="Plots.html"><a href="Plots.html#panel.first"><i class="fa fa-check"></i><b>18.6.3</b> panel.first</a></li>
<li class="chapter" data-level="18.6.4" data-path="Plots.html"><a href="Plots.html#area-under-curve"><i class="fa fa-check"></i><b>18.6.4</b> Area under curve</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="Plots.html"><a href="Plots.html#plot-math-coordinate-system"><i class="fa fa-check"></i><b>18.7</b> Plot Math Coordinate System</a></li>
<li class="chapter" data-level="18.8" data-path="Plots.html"><a href="Plots.html#plot-empty"><i class="fa fa-check"></i><b>18.8</b> Plot empty</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="interactive-plots.html"><a href="interactive-plots.html"><i class="fa fa-check"></i><b>19</b> Interactive Plots</a></li>
<li class="chapter" data-level="20" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>20</b> ggplot2</a>
<ul>
<li class="chapter" data-level="20.1" data-path="ggplot2.html"><a href="ggplot2.html#r-base-graphics-vs-ggplot2"><i class="fa fa-check"></i><b>20.1</b> R Base Graphics vs ggplot2</a></li>
<li class="chapter" data-level="20.2" data-path="ggplot2.html"><a href="ggplot2.html#syntax"><i class="fa fa-check"></i><b>20.2</b> Syntax</a></li>
<li class="chapter" data-level="20.3" data-path="ggplot2.html"><a href="ggplot2.html#aesthetic-mappings-aes"><i class="fa fa-check"></i><b>20.3</b> Aesthetic mappings <code>aes</code></a></li>
<li class="chapter" data-level="20.4" data-path="ggplot2.html"><a href="ggplot2.html#goemetric-objects-geoms"><i class="fa fa-check"></i><b>20.4</b> Goemetric objects <code>geoms</code></a></li>
<li class="chapter" data-level="20.5" data-path="ggplot2.html"><a href="ggplot2.html#statistical-transformations-stat"><i class="fa fa-check"></i><b>20.5</b> Statistical transformations <code>stat</code></a></li>
<li class="chapter" data-level="20.6" data-path="ggplot2.html"><a href="ggplot2.html#combine-base-graphics-and-ggplot2"><i class="fa fa-check"></i><b>20.6</b> Combine base graphics and ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="text-output.html"><a href="text-output.html"><i class="fa fa-check"></i><b>21</b> Text output</a>
<ul>
<li class="chapter" data-level="21.1" data-path="text-output.html"><a href="text-output.html#format"><i class="fa fa-check"></i><b>21.1</b> Format</a></li>
<li class="chapter" data-level="21.2" data-path="text-output.html"><a href="text-output.html#new-lines"><i class="fa fa-check"></i><b>21.2</b> New lines</a></li>
<li class="chapter" data-level="21.3" data-path="text-output.html"><a href="text-output.html#print-text-to-console"><i class="fa fa-check"></i><b>21.3</b> Print text to console</a></li>
<li class="chapter" data-level="21.4" data-path="text-output.html"><a href="text-output.html#combine-text-and-variables"><i class="fa fa-check"></i><b>21.4</b> Combine Text and variables</a></li>
</ul></li>
<li class="part"><span><b>V R Statistics</b></span></li>
<li class="chapter" data-level="22" data-path="topics.html"><a href="topics.html"><i class="fa fa-check"></i><b>22</b> Topics</a></li>
<li class="chapter" data-level="23" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>23</b> Basic Statistics</a>
<ul>
<li class="chapter" data-level="23.1" data-path="basic-statistics.html"><a href="basic-statistics.html#distributions"><i class="fa fa-check"></i><b>23.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="basic-statistics.html"><a href="basic-statistics.html#relationships-between-distributions"><i class="fa fa-check"></i><b>23.1.1</b> Relationships between distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>24</b> Regression</a>
<ul>
<li class="chapter" data-level="24.1" data-path="regression.html"><a href="regression.html#preperation"><i class="fa fa-check"></i><b>24.1</b> Preperation</a></li>
<li class="chapter" data-level="24.2" data-path="regression.html"><a href="regression.html#fit"><i class="fa fa-check"></i><b>24.2</b> Fit</a></li>
<li class="chapter" data-level="24.3" data-path="regression.html"><a href="regression.html#inference"><i class="fa fa-check"></i><b>24.3</b> Inference</a></li>
<li class="chapter" data-level="24.4" data-path="regression.html"><a href="regression.html#prediction"><i class="fa fa-check"></i><b>24.4</b> Prediction</a></li>
<li class="chapter" data-level="24.5" data-path="regression.html"><a href="regression.html#plot-regression"><i class="fa fa-check"></i><b>24.5</b> Plot regression</a></li>
<li class="chapter" data-level="24.6" data-path="regression.html"><a href="regression.html#model-comparison"><i class="fa fa-check"></i><b>24.6</b> Model comparison</a></li>
<li class="chapter" data-level="24.7" data-path="regression.html"><a href="regression.html#diagnostic-plots"><i class="fa fa-check"></i><b>24.7</b> Diagnostic plots</a>
<ul>
<li class="chapter" data-level="24.7.1" data-path="regression.html"><a href="regression.html#tukey-anscombe-plot"><i class="fa fa-check"></i><b>24.7.1</b> Tukey-Anscombe plot</a></li>
<li class="chapter" data-level="24.7.2" data-path="regression.html"><a href="regression.html#normal-qq-plot"><i class="fa fa-check"></i><b>24.7.2</b> Normal QQ plot</a></li>
<li class="chapter" data-level="24.7.3" data-path="regression.html"><a href="regression.html#scale-location-plot"><i class="fa fa-check"></i><b>24.7.3</b> Scale-Location plot</a></li>
<li class="chapter" data-level="24.7.4" data-path="regression.html"><a href="regression.html#leverage-plot"><i class="fa fa-check"></i><b>24.7.4</b> Leverage plot</a></li>
<li class="chapter" data-level="24.7.5" data-path="regression.html"><a href="regression.html#residuals-vs-any"><i class="fa fa-check"></i><b>24.7.5</b> Residuals vs any</a></li>
<li class="chapter" data-level="24.7.6" data-path="regression.html"><a href="regression.html#partial-residual-plot"><i class="fa fa-check"></i><b>24.7.6</b> Partial residual plot</a></li>
</ul></li>
<li class="chapter" data-level="24.8" data-path="regression.html"><a href="regression.html#model-improvement"><i class="fa fa-check"></i><b>24.8</b> Model improvement</a>
<ul>
<li class="chapter" data-level="24.8.1" data-path="regression.html"><a href="regression.html#multicollinearity"><i class="fa fa-check"></i><b>24.8.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="24.8.2" data-path="regression.html"><a href="regression.html#aicbic"><i class="fa fa-check"></i><b>24.8.2</b> AIC/BIC</a></li>
<li class="chapter" data-level="24.8.3" data-path="regression.html"><a href="regression.html#variable-selection"><i class="fa fa-check"></i><b>24.8.3</b> Variable selection</a></li>
<li class="chapter" data-level="24.8.4" data-path="regression.html"><a href="regression.html#predictor-relevance"><i class="fa fa-check"></i><b>24.8.4</b> Predictor relevance</a></li>
</ul></li>
<li class="chapter" data-level="24.9" data-path="regression.html"><a href="regression.html#shrinkage"><i class="fa fa-check"></i><b>24.9</b> Shrinkage</a></li>
<li class="chapter" data-level="24.10" data-path="regression.html"><a href="regression.html#smoothing"><i class="fa fa-check"></i><b>24.10</b> Smoothing</a>
<ul>
<li class="chapter" data-level="24.10.1" data-path="regression.html"><a href="regression.html#running-mean-yellow-box"><i class="fa fa-check"></i><b>24.10.1</b> Running mean (yellow box)</a></li>
<li class="chapter" data-level="24.10.2" data-path="regression.html"><a href="regression.html#gaussian-kernel-estimate-green-gaussian"><i class="fa fa-check"></i><b>24.10.2</b> Gaussian kernel estimate (green gaussian)</a></li>
<li class="chapter" data-level="24.10.3" data-path="regression.html"><a href="regression.html#loess-smoother"><i class="fa fa-check"></i><b>24.10.3</b> LOESS smoother</a></li>
</ul></li>
<li class="chapter" data-level="24.11" data-path="regression.html"><a href="regression.html#gam"><i class="fa fa-check"></i><b>24.11</b> GAM</a></li>
<li class="chapter" data-level="24.12" data-path="regression.html"><a href="regression.html#glm"><i class="fa fa-check"></i><b>24.12</b> GLM</a>
<ul>
<li class="chapter" data-level="24.12.1" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>24.12.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="24.12.2" data-path="regression.html"><a href="regression.html#poisson-regression"><i class="fa fa-check"></i><b>24.12.2</b> Poisson Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>25</b> ANOVA</a>
<ul>
<li class="chapter" data-level="25.1" data-path="anova.html"><a href="anova.html#idea"><i class="fa fa-check"></i><b>25.1</b> Idea</a></li>
<li class="chapter" data-level="25.2" data-path="anova.html"><a href="anova.html#example-1"><i class="fa fa-check"></i><b>25.2</b> Example</a></li>
<li class="chapter" data-level="25.3" data-path="anova.html"><a href="anova.html#simulate-data"><i class="fa fa-check"></i><b>25.3</b> Simulate data</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="anova.html"><a href="anova.html#randomization"><i class="fa fa-check"></i><b>25.3.1</b> Randomization</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="anova.html"><a href="anova.html#visualization-2"><i class="fa fa-check"></i><b>25.4</b> Visualization</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="anova.html"><a href="anova.html#stripchart"><i class="fa fa-check"></i><b>25.4.1</b> Stripchart</a></li>
<li class="chapter" data-level="25.4.2" data-path="anova.html"><a href="anova.html#boxplot"><i class="fa fa-check"></i><b>25.4.2</b> Boxplot</a></li>
<li class="chapter" data-level="25.4.3" data-path="anova.html"><a href="anova.html#interaction-plot"><i class="fa fa-check"></i><b>25.4.3</b> Interaction plot</a></li>
<li class="chapter" data-level="25.4.4" data-path="anova.html"><a href="anova.html#summary-plot"><i class="fa fa-check"></i><b>25.4.4</b> Summary plot</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="anova.html"><a href="anova.html#fit-model"><i class="fa fa-check"></i><b>25.5</b> Fit model</a>
<ul>
<li class="chapter" data-level="25.5.1" data-path="anova.html"><a href="anova.html#identifiability"><i class="fa fa-check"></i><b>25.5.1</b> Identifiability</a></li>
<li class="chapter" data-level="25.5.2" data-path="anova.html"><a href="anova.html#fitting-2"><i class="fa fa-check"></i><b>25.5.2</b> Fitting</a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="anova.html"><a href="anova.html#anova-table"><i class="fa fa-check"></i><b>25.6</b> ANOVA table</a>
<ul>
<li class="chapter" data-level="25.6.1" data-path="anova.html"><a href="anova.html#types-of-sum-of-sqares"><i class="fa fa-check"></i><b>25.6.1</b> Types of Sum of Sqares</a></li>
</ul></li>
<li class="chapter" data-level="25.7" data-path="anova.html"><a href="anova.html#model-comparison-2"><i class="fa fa-check"></i><b>25.7</b> Model comparison</a></li>
<li class="chapter" data-level="25.8" data-path="anova.html"><a href="anova.html#coefficients"><i class="fa fa-check"></i><b>25.8</b> Coefficients</a></li>
<li class="chapter" data-level="25.9" data-path="anova.html"><a href="anova.html#tests-and-ci-for-coeficients"><i class="fa fa-check"></i><b>25.9</b> Tests and CI for coeficients</a></li>
<li class="chapter" data-level="25.10" data-path="anova.html"><a href="anova.html#predict"><i class="fa fa-check"></i><b>25.10</b> Predict</a></li>
<li class="chapter" data-level="25.11" data-path="anova.html"><a href="anova.html#diagnostic-plots-1"><i class="fa fa-check"></i><b>25.11</b> Diagnostic plots</a>
<ul>
<li class="chapter" data-level="25.11.1" data-path="anova.html"><a href="anova.html#simulations"><i class="fa fa-check"></i><b>25.11.1</b> Simulations</a></li>
<li class="chapter" data-level="25.11.2" data-path="anova.html"><a href="anova.html#qq-plot-in-mixed-models"><i class="fa fa-check"></i><b>25.11.2</b> QQ plot in mixed models</a></li>
</ul></li>
<li class="chapter" data-level="25.12" data-path="anova.html"><a href="anova.html#contrasts"><i class="fa fa-check"></i><b>25.12</b> Contrasts</a>
<ul>
<li class="chapter" data-level="25.12.1" data-path="anova.html"><a href="anova.html#test-contrast"><i class="fa fa-check"></i><b>25.12.1</b> Test contrast</a></li>
</ul></li>
<li class="chapter" data-level="25.13" data-path="anova.html"><a href="anova.html#multiple-comparison"><i class="fa fa-check"></i><b>25.13</b> Multiple comparison</a>
<ul>
<li class="chapter" data-level="25.13.1" data-path="anova.html"><a href="anova.html#bonferroni-holm-planned-contrasts"><i class="fa fa-check"></i><b>25.13.1</b> Bonferroni Holm (Planned contrasts)</a></li>
<li class="chapter" data-level="25.13.2" data-path="anova.html"><a href="anova.html#scheffe-unplanned-contrasts"><i class="fa fa-check"></i><b>25.13.2</b> Scheffe (Unplanned contrasts)</a></li>
<li class="chapter" data-level="25.13.3" data-path="anova.html"><a href="anova.html#tukey-hsd-all-pairwise-comparisons"><i class="fa fa-check"></i><b>25.13.3</b> Tukey HSD (All pairwise comparisons)</a></li>
<li class="chapter" data-level="25.13.4" data-path="anova.html"><a href="anova.html#dunnett-comparison-with-control"><i class="fa fa-check"></i><b>25.13.4</b> Dunnett (Comparison with control)</a></li>
</ul></li>
<li class="chapter" data-level="25.14" data-path="anova.html"><a href="anova.html#designs"><i class="fa fa-check"></i><b>25.14</b> Designs</a>
<ul>
<li class="chapter" data-level="25.14.1" data-path="anova.html"><a href="anova.html#factorial-design"><i class="fa fa-check"></i><b>25.14.1</b> Factorial design</a></li>
<li class="chapter" data-level="25.14.2" data-path="anova.html"><a href="anova.html#mixed-models"><i class="fa fa-check"></i><b>25.14.2</b> Mixed models</a></li>
<li class="chapter" data-level="25.14.3" data-path="anova.html"><a href="anova.html#nested-model"><i class="fa fa-check"></i><b>25.14.3</b> Nested model</a></li>
<li class="chapter" data-level="25.14.4" data-path="anova.html"><a href="anova.html#split-plot"><i class="fa fa-check"></i><b>25.14.4</b> Split plot</a></li>
<li class="chapter" data-level="25.14.5" data-path="anova.html"><a href="anova.html#incomplete-block-designs"><i class="fa fa-check"></i><b>25.14.5</b> Incomplete Block designs</a></li>
</ul></li>
<li class="chapter" data-level="25.15" data-path="anova.html"><a href="anova.html#power-analysis"><i class="fa fa-check"></i><b>25.15</b> Power Analysis</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="MultivarStat.html"><a href="MultivarStat.html"><i class="fa fa-check"></i><b>26</b> Multivariate Statistics</a>
<ul>
<li class="chapter" data-level="26.1" data-path="MultivarStat.html"><a href="MultivarStat.html#data-sets"><i class="fa fa-check"></i><b>26.1</b> Data sets</a></li>
<li class="chapter" data-level="26.2" data-path="MultivarStat.html"><a href="MultivarStat.html#some-functions"><i class="fa fa-check"></i><b>26.2</b> Some functions</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="MultivarStat.html"><a href="MultivarStat.html#visualization-3"><i class="fa fa-check"></i><b>26.2.1</b> Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="TimeSeries.html"><a href="TimeSeries.html"><i class="fa fa-check"></i><b>27</b> Time series</a>
<ul>
<li class="chapter" data-level="27.1" data-path="TimeSeries.html"><a href="TimeSeries.html#data-sets-1"><i class="fa fa-check"></i><b>27.1</b> Data sets</a></li>
<li class="chapter" data-level="27.2" data-path="TimeSeries.html"><a href="TimeSeries.html#date-and-time"><i class="fa fa-check"></i><b>27.2</b> Date and Time</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="TimeSeries.html"><a href="TimeSeries.html#date"><i class="fa fa-check"></i><b>27.2.1</b> Date</a></li>
<li class="chapter" data-level="27.2.2" data-path="TimeSeries.html"><a href="TimeSeries.html#date-time-1"><i class="fa fa-check"></i><b>27.2.2</b> Date-Time</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="TimeSeries.html"><a href="TimeSeries.html#time-series-classes"><i class="fa fa-check"></i><b>27.3</b> Time series classes</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="TimeSeries.html"><a href="TimeSeries.html#ts"><i class="fa fa-check"></i><b>27.3.1</b> ts</a></li>
<li class="chapter" data-level="27.3.2" data-path="TimeSeries.html"><a href="TimeSeries.html#zoo"><i class="fa fa-check"></i><b>27.3.2</b> zoo</a></li>
<li class="chapter" data-level="27.3.3" data-path="TimeSeries.html"><a href="TimeSeries.html#futher-classes"><i class="fa fa-check"></i><b>27.3.3</b> futher classes</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="TimeSeries.html"><a href="TimeSeries.html#differencing"><i class="fa fa-check"></i><b>27.4</b> Differencing</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html"><i class="fa fa-check"></i><b>28</b> Computational statistics</a>
<ul>
<li class="chapter" data-level="28.1" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html#cross-validation"><i class="fa fa-check"></i><b>28.1</b> Cross validation</a></li>
<li class="chapter" data-level="28.2" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html#k-nearest-neighbor"><i class="fa fa-check"></i><b>28.2</b> k nearest neighbor</a></li>
<li class="chapter" data-level="28.3" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html#bootstrap"><i class="fa fa-check"></i><b>28.3</b> Bootstrap</a></li>
</ul></li>
<li class="part"><span><b>VI R Workflow</b></span></li>
<li class="chapter" data-level="29" data-path="reproducible-research.html"><a href="reproducible-research.html"><i class="fa fa-check"></i><b>29</b> Reproducible Research</a>
<ul>
<li class="chapter" data-level="29.1" data-path="reproducible-research.html"><a href="reproducible-research.html#tasks"><i class="fa fa-check"></i><b>29.1</b> Tasks</a></li>
<li class="chapter" data-level="29.2" data-path="reproducible-research.html"><a href="reproducible-research.html#chronology"><i class="fa fa-check"></i><b>29.2</b> Chronology</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="r-studio.html"><a href="r-studio.html"><i class="fa fa-check"></i><b>30</b> R Studio</a>
<ul>
<li class="chapter" data-level="30.1" data-path="r-studio.html"><a href="r-studio.html#shortcuts"><i class="fa fa-check"></i><b>30.1</b> Shortcuts</a></li>
<li class="chapter" data-level="30.2" data-path="r-studio.html"><a href="r-studio.html#version-control-in-rstudio"><i class="fa fa-check"></i><b>30.2</b> Version Control in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="literate-programming.html"><a href="literate-programming.html"><i class="fa fa-check"></i><b>31</b> Literate programming</a>
<ul>
<li class="chapter" data-level="31.1" data-path="literate-programming.html"><a href="literate-programming.html#sweave"><i class="fa fa-check"></i><b>31.1</b> Sweave</a></li>
<li class="chapter" data-level="31.2" data-path="literate-programming.html"><a href="literate-programming.html#knitr"><i class="fa fa-check"></i><b>31.2</b> Knitr</a></li>
<li class="chapter" data-level="31.3" data-path="literate-programming.html"><a href="literate-programming.html#r-markdown"><i class="fa fa-check"></i><b>31.3</b> R Markdown</a></li>
<li class="chapter" data-level="31.4" data-path="literate-programming.html"><a href="literate-programming.html#basic-elements-of-latex-and-r-markdown"><i class="fa fa-check"></i><b>31.4</b> Basic Elements of Latex and R Markdown</a></li>
<li class="chapter" data-level="31.5" data-path="literate-programming.html"><a href="literate-programming.html#templates"><i class="fa fa-check"></i><b>31.5</b> Templates</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="latex.html"><a href="latex.html"><i class="fa fa-check"></i><b>32</b> Latex</a>
<ul>
<li class="chapter" data-level="32.1" data-path="latex.html"><a href="latex.html#symbols-2"><i class="fa fa-check"></i><b>32.1</b> Symbols</a></li>
<li class="chapter" data-level="32.2" data-path="latex.html"><a href="latex.html#important"><i class="fa fa-check"></i><b>32.2</b> Important</a></li>
<li class="chapter" data-level="32.3" data-path="latex.html"><a href="latex.html#reto-math"><i class="fa fa-check"></i><b>32.3</b> Reto Math</a></li>
<li class="chapter" data-level="32.4" data-path="latex.html"><a href="latex.html#sfs"><i class="fa fa-check"></i><b>32.4</b> SfS</a></li>
<li class="chapter" data-level="32.5" data-path="latex.html"><a href="latex.html#constructs"><i class="fa fa-check"></i><b>32.5</b> Constructs</a></li>
<li class="chapter" data-level="32.6" data-path="latex.html"><a href="latex.html#text-format"><i class="fa fa-check"></i><b>32.6</b> Text format</a></li>
<li class="chapter" data-level="32.7" data-path="latex.html"><a href="latex.html#math-environments"><i class="fa fa-check"></i><b>32.7</b> Math environments</a></li>
<li class="chapter" data-level="32.8" data-path="latex.html"><a href="latex.html#useful-packages"><i class="fa fa-check"></i><b>32.8</b> Useful packages</a></li>
<li class="chapter" data-level="32.9" data-path="latex.html"><a href="latex.html#beamer-package"><i class="fa fa-check"></i><b>32.9</b> Beamer package</a></li>
<li class="chapter" data-level="32.10" data-path="latex.html"><a href="latex.html#retoarticle.sty"><i class="fa fa-check"></i><b>32.10</b> RetoArticle.sty</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="reference-management.html"><a href="reference-management.html"><i class="fa fa-check"></i><b>33</b> Reference management</a>
<ul>
<li class="chapter" data-level="33.1" data-path="reference-management.html"><a href="reference-management.html#literature"><i class="fa fa-check"></i><b>33.1</b> Literature</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="reference-management.html"><a href="reference-management.html#recommended-using-zotero"><i class="fa fa-check"></i><b>33.1.1</b> Recommended: Using Zotero</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="reference-management.html"><a href="reference-management.html#cross-references"><i class="fa fa-check"></i><b>33.2</b> Cross-References</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="r-markdown-1.html"><a href="r-markdown-1.html"><i class="fa fa-check"></i><b>34</b> R Markdown</a>
<ul>
<li class="chapter" data-level="34.1" data-path="r-markdown-1.html"><a href="r-markdown-1.html#components-1"><i class="fa fa-check"></i><b>34.1</b> Components</a>
<ul>
<li class="chapter" data-level="34.1.1" data-path="r-markdown-1.html"><a href="r-markdown-1.html#yaml-frontmatter"><i class="fa fa-check"></i><b>34.1.1</b> YAML frontmatter</a></li>
<li class="chapter" data-level="34.1.2" data-path="r-markdown-1.html"><a href="r-markdown-1.html#text-1"><i class="fa fa-check"></i><b>34.1.2</b> Text</a></li>
<li class="chapter" data-level="34.1.3" data-path="r-markdown-1.html"><a href="r-markdown-1.html#code"><i class="fa fa-check"></i><b>34.1.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="34.2" data-path="r-markdown-1.html"><a href="r-markdown-1.html#figures"><i class="fa fa-check"></i><b>34.2</b> Figures</a></li>
<li class="chapter" data-level="34.3" data-path="r-markdown-1.html"><a href="r-markdown-1.html#tables"><i class="fa fa-check"></i><b>34.3</b> Tables</a>
<ul>
<li class="chapter" data-level="34.3.1" data-path="r-markdown-1.html"><a href="r-markdown-1.html#html-tables"><i class="fa fa-check"></i><b>34.3.1</b> HTML tables</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="r-markdown-1.html"><a href="r-markdown-1.html#math"><i class="fa fa-check"></i><b>34.4</b> Math</a></li>
<li class="chapter" data-level="34.5" data-path="r-markdown-1.html"><a href="r-markdown-1.html#special-characters"><i class="fa fa-check"></i><b>34.5</b> Special characters</a></li>
<li class="chapter" data-level="34.6" data-path="r-markdown-1.html"><a href="r-markdown-1.html#section-folding"><i class="fa fa-check"></i><b>34.6</b> Section folding</a></li>
<li class="chapter" data-level="34.7" data-path="r-markdown-1.html"><a href="r-markdown-1.html#add-box"><i class="fa fa-check"></i><b>34.7</b> Add box</a></li>
<li class="chapter" data-level="34.8" data-path="r-markdown-1.html"><a href="r-markdown-1.html#template"><i class="fa fa-check"></i><b>34.8</b> Template</a></li>
<li class="chapter" data-level="34.9" data-path="r-markdown-1.html"><a href="r-markdown-1.html#good-output-formats"><i class="fa fa-check"></i><b>34.9</b> Good output formats</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>35</b> Bookdown</a>
<ul>
<li class="chapter" data-level="35.1" data-path="bookdown.html"><a href="bookdown.html#configuration"><i class="fa fa-check"></i><b>35.1</b> Configuration</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="bookdown.html"><a href="bookdown.html#bookdown.yml"><i class="fa fa-check"></i><b>35.1.1</b> <code>_bookdown.yml</code></a></li>
<li class="chapter" data-level="35.1.2" data-path="bookdown.html"><a href="bookdown.html#output.yml"><i class="fa fa-check"></i><b>35.1.2</b> <code>_output.yml</code></a></li>
<li class="chapter" data-level="35.1.3" data-path="bookdown.html"><a href="bookdown.html#yaml-header"><i class="fa fa-check"></i><b>35.1.3</b> yaml header</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="bookdown.html"><a href="bookdown.html#NewBookdownProject"><i class="fa fa-check"></i><b>35.2</b> Create new project</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="git-version-control.html"><a href="git-version-control.html"><i class="fa fa-check"></i><b>36</b> Git version control</a>
<ul>
<li class="chapter" data-level="36.1" data-path="git-version-control.html"><a href="git-version-control.html#bash-basics"><i class="fa fa-check"></i><b>36.1</b> Bash basics</a></li>
<li class="chapter" data-level="36.2" data-path="git-version-control.html"><a href="git-version-control.html#git-basics"><i class="fa fa-check"></i><b>36.2</b> Git basics</a></li>
<li class="chapter" data-level="36.3" data-path="git-version-control.html"><a href="git-version-control.html#global-config"><i class="fa fa-check"></i><b>36.3</b> Global config</a></li>
<li class="chapter" data-level="36.4" data-path="git-version-control.html"><a href="git-version-control.html#ssh-keys"><i class="fa fa-check"></i><b>36.4</b> SSH keys</a></li>
<li class="chapter" data-level="36.5" data-path="git-version-control.html"><a href="git-version-control.html#common-tasks"><i class="fa fa-check"></i><b>36.5</b> Common tasks</a></li>
<li class="chapter" data-level="36.6" data-path="git-version-control.html"><a href="git-version-control.html#single-user"><i class="fa fa-check"></i><b>36.6</b> Single user</a>
<ul>
<li class="chapter" data-level="36.6.1" data-path="git-version-control.html"><a href="git-version-control.html#regular-workflow"><i class="fa fa-check"></i><b>36.6.1</b> Regular workflow</a></li>
<li class="chapter" data-level="36.6.2" data-path="git-version-control.html"><a href="git-version-control.html#troubleshooting"><i class="fa fa-check"></i><b>36.6.2</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="36.7" data-path="git-version-control.html"><a href="git-version-control.html#multiple-users"><i class="fa fa-check"></i><b>36.7</b> Multiple users</a>
<ul>
<li class="chapter" data-level="36.7.1" data-path="git-version-control.html"><a href="git-version-control.html#get-foreign-respository-fork"><i class="fa fa-check"></i><b>36.7.1</b> get foreign respository (fork)</a></li>
</ul></li>
<li class="chapter" data-level="36.8" data-path="git-version-control.html"><a href="git-version-control.html#version-control-in-rstudio-1"><i class="fa fa-check"></i><b>36.8</b> Version Control in RStudio</a></li>
<li class="chapter" data-level="36.9" data-path="git-version-control.html"><a href="git-version-control.html#extensions"><i class="fa fa-check"></i><b>36.9</b> Extensions</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="git2.html"><a href="git2.html"><i class="fa fa-check"></i><b>37</b> git2</a>
<ul>
<li class="chapter" data-level="37.1" data-path="git2.html"><a href="git2.html#common-tasks-1"><i class="fa fa-check"></i><b>37.1</b> Common tasks</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="makefiles.html"><a href="makefiles.html"><i class="fa fa-check"></i><b>38</b> Makefiles</a>
<ul>
<li class="chapter" data-level="38.1" data-path="makefiles.html"><a href="makefiles.html#tutorials"><i class="fa fa-check"></i><b>38.1</b> Tutorials</a></li>
<li class="chapter" data-level="38.2" data-path="makefiles.html"><a href="makefiles.html#small-examples"><i class="fa fa-check"></i><b>38.2</b> Small examples</a></li>
<li class="chapter" data-level="38.3" data-path="makefiles.html"><a href="makefiles.html#explanantion"><i class="fa fa-check"></i><b>38.3</b> Explanantion</a></li>
<li class="chapter" data-level="38.4" data-path="makefiles.html"><a href="makefiles.html#usefull-commands"><i class="fa fa-check"></i><b>38.4</b> Usefull commands</a></li>
<li class="chapter" data-level="38.5" data-path="makefiles.html"><a href="makefiles.html#recursive-search-for-file-in-path"><i class="fa fa-check"></i><b>38.5</b> Recursive search for file in path</a></li>
<li class="chapter" data-level="38.6" data-path="makefiles.html"><a href="makefiles.html#print-variable-in-makefile"><i class="fa fa-check"></i><b>38.6</b> Print variable in Makefile</a></li>
<li class="chapter" data-level="38.7" data-path="makefiles.html"><a href="makefiles.html#sweave-and-knitr"><i class="fa fa-check"></i><b>38.7</b> Sweave and knitr</a></li>
<li class="chapter" data-level="38.8" data-path="makefiles.html"><a href="makefiles.html#general-recomondations-for-multi-file-latex-projects"><i class="fa fa-check"></i><b>38.8</b> General Recomondations for Multi-file LaTeX projects</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="packages-1.html"><a href="packages-1.html"><i class="fa fa-check"></i><b>39</b> Packages</a>
<ul>
<li class="chapter" data-level="39.1" data-path="packages-1.html"><a href="packages-1.html#package-environment-1"><i class="fa fa-check"></i><b>39.1</b> Package environment</a></li>
<li class="chapter" data-level="39.2" data-path="packages-1.html"><a href="packages-1.html#useful-packages-1"><i class="fa fa-check"></i><b>39.2</b> Useful packages</a></li>
</ul></li>
<li class="part"><span><b>VII Appendix</b></span></li>
<li class="chapter" data-level="40" data-path="cheat-sheets.html"><a href="cheat-sheets.html"><i class="fa fa-check"></i><b>40</b> Cheat sheets</a>
<ul>
<li class="chapter" data-level="40.1" data-path="cheat-sheets.html"><a href="cheat-sheets.html#data-import"><i class="fa fa-check"></i><b>40.1</b> Data import</a></li>
<li class="chapter" data-level="40.2" data-path="cheat-sheets.html"><a href="cheat-sheets.html#data-transformation"><i class="fa fa-check"></i><b>40.2</b> Data transformation</a></li>
<li class="chapter" data-level="40.3" data-path="cheat-sheets.html"><a href="cheat-sheets.html#data-visualization"><i class="fa fa-check"></i><b>40.3</b> Data visualization</a></li>
<li class="chapter" data-level="40.4" data-path="cheat-sheets.html"><a href="cheat-sheets.html#factors-1"><i class="fa fa-check"></i><b>40.4</b> Factors</a></li>
<li class="chapter" data-level="40.5" data-path="cheat-sheets.html"><a href="cheat-sheets.html#lubridate"><i class="fa fa-check"></i><b>40.5</b> Lubridate</a></li>
<li class="chapter" data-level="40.6" data-path="cheat-sheets.html"><a href="cheat-sheets.html#strings-1"><i class="fa fa-check"></i><b>40.6</b> Strings</a></li>
<li class="chapter" data-level="40.7" data-path="cheat-sheets.html"><a href="cheat-sheets.html#regex"><i class="fa fa-check"></i><b>40.7</b> Regex</a></li>
<li class="chapter" data-level="40.8" data-path="cheat-sheets.html"><a href="cheat-sheets.html#purrr"><i class="fa fa-check"></i><b>40.8</b> Purrr</a></li>
<li class="chapter" data-level="40.9" data-path="cheat-sheets.html"><a href="cheat-sheets.html#tidyeval"><i class="fa fa-check"></i><b>40.9</b> Tidyeval</a></li>
<li class="chapter" data-level="40.10" data-path="cheat-sheets.html"><a href="cheat-sheets.html#r-studio-1"><i class="fa fa-check"></i><b>40.10</b> R Studio</a></li>
<li class="chapter" data-level="40.11" data-path="cheat-sheets.html"><a href="cheat-sheets.html#r-markdown-2"><i class="fa fa-check"></i><b>40.11</b> R markdown</a></li>
<li class="chapter" data-level="40.12" data-path="cheat-sheets.html"><a href="cheat-sheets.html#shiny"><i class="fa fa-check"></i><b>40.12</b> Shiny</a></li>
<li class="chapter" data-level="40.13" data-path="cheat-sheets.html"><a href="cheat-sheets.html#package-development"><i class="fa fa-check"></i><b>40.13</b> Package development</a></li>
<li class="chapter" data-level="40.14" data-path="cheat-sheets.html"><a href="cheat-sheets.html#reticulate"><i class="fa fa-check"></i><b>40.14</b> Reticulate</a></li>
<li class="chapter" data-level="40.15" data-path="cheat-sheets.html"><a href="cheat-sheets.html#keras"><i class="fa fa-check"></i><b>40.15</b> Keras</a></li>
<li class="chapter" data-level="40.16" data-path="cheat-sheets.html"><a href="cheat-sheets.html#sparklyr"><i class="fa fa-check"></i><b>40.16</b> Sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i><b>41</b> Test</a></li>
<li class="chapter" data-level="42" data-path="stuff-still-to-include.html"><a href="stuff-still-to-include.html"><i class="fa fa-check"></i><b>42</b> Stuff still to include</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Reference Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<p style="display:none;"> % Tag useful such that part is included but already hidden even before rendering of MathJax.
\(
\newcommand{\bm}[1]{\boldsymbol{#1}}
% \newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}  % Use this if you prefere upright (not italic) vectors and matrices

% Operators
\newcommand{\tr}{{}^{\intercal}}               % transpose (needs amssymb)
\newcommand{\inv}{^{-1}}                       % inverse
\renewcommand{\d}[1]{\operatorname{d}\!{#1}}  % dx
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}           % L2 Norm
\DeclareMathOperator*{\argmin}{arg\, min}
\DeclareMathOperator*{\argmax}{arg\, max}
\DeclareMathOperator{\diag}{diag}

\newcommand{\E}{\mathbf{E}}  % Depreciated: delete as soon as possible... Use \ERW{}

% Matrix
\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}  % big zero in matrix
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}} % vertical bar to separate matrix

% SfS stuff
\newcommand{\iid}{\mbox{ i.i.d. }}
\newcommand{\Xsub}[2]{{#1}_{\mathrm{\scriptscriptstyle #2}}}
\newcommand{\wh}[1]{{}\kern0.1em\widehat{\kern-0.1em#1}{}}

\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Cor}{Corr}

\newcommand{\ekl}{[}     % Erwartungswert Klammer links
\newcommand{\ekr}{]}     % Erwartungswert Klammer rechts
\newcommand{\ckl}{(}     % (Co)variance Klammer links
\newcommand{\ckr}{)}
\newcommand{\pkl}{(}     % Probability Klammer links
\newcommand{\pkr}{)}
\newcommand{\vkl}{(}     % Verteilungs Klammer links
\newcommand{\vkr}{)}

\newcommand{\ERWSymbol}{\mathbf{E}}  % vorbereitet zum Anpassen an individuelle Styles
\newcommand{\VARSymbol}{\Var}
\newcommand{\COVSymbol}{\Cov}
\newcommand{\CORSymbol}{\Cor}
\DeclareMathOperator{\PRSymbol}{P}
\newcommand{\NormalSymbol}{\mathcal{N}}
\DeclareMathOperator{\BinomialSymbol}{\mathcal{B}} % Binomial
\DeclareMathOperator{\BernoulliSymbol}{\mathcal{B}ernoulli} % Bernoulli
\DeclareMathOperator{\ExponentialSymbol}{Exp}
\DeclareMathOperator{\PoissonSymbol}{Pois}

% die eigentlichen ``Funktionen''
\newcommand{\ERW}[1] {\ERWSymbol \left[ #1 \right]}
\newcommand{\VAR}[1] {\VARSymbol \left( #1 \right)}
\newcommand{\VARH}[1]{\wh\VARSymbol \left( #1 \right)}

\newcommand{\COV}[1] {\COVSymbol \left(#1 \right)}
\newcommand{\COVH}[1] {\wh\COVSymbol \left( #1 \right)}
\newcommand{\COR}[1] {\CORSymbol    \left( #1 \right)}
\newcommand{\CORH}[1] {\wh\CORSymbol \left( #1 \right)}
\newcommand{\PR}[1] {\PRSymbol \! \left( #1 \right)}
\newcommand{\Normal}[1] {\NormalSymbol   \left( #1 \right)}
\newcommand{\Binomial}[1] {\BinomialSymbol    \left( #1 \right)}
\newcommand{\Bernoulli}[1] {\BernoulliSymbol    \left( #1 \right)}
\newcommand{\Exponential}[1] {\ExponentialSymbol    \left( #1 \right)}
\newcommand{\Poisson}[1] {\PoissonSymbol   \left( #1 \right)}

\newcommand{\ERWi}[2]  {\Xsub{\ERWSymbol}{#1}    \left[ #2
    \right]}
\newcommand{\VARi}[2]  {\Xsub{\VARSymbol}{#1}    \left( #2
    \right)}
\newcommand{\VARHi}[2] {\Xsub{\wh\VARSymbol}{#1} \left( #2
    \right)}
\newcommand{\COVi}[2]  {\Xsub{\COVSymbol}{#1}    \left( #2
    \right)}
\newcommand{\COVHi}[2] {\Xsub{\wh\COVSymbol}{#1} \left( #2
    \right)}
\newcommand{\CORi}[2]  {\Xsub{\CORSymbol}{#1}    \left( #2
    \right)}
\newcommand{\CORHi}[2] {\Xsub{\wh\CORSymbol}{#1} \left( #2
    \right)}
\newcommand{\PRi}[2]   {\Xsub{\PRSymbol}{#1}     \left( #2
    \right)}
\newcommand{\Normali}[2]      {\Xsub{\NormalSymbol}{#1}   \left( #2
    \right)}
\newcommand{\Binomiali}[2]    {\Xsub{\BinomialSymbol}{#1}    \left( #2
    \right)}
\newcommand{\Bernoullii}[2]   {\Xsub{\BernoulliSymbol}{#1}    \left( #2
    \right)}
\newcommand{\Exponentiali}[2] {\Xsub{\ExponentialSymbol}{#1}    \left( #2
    \right)}
\newcommand{\Poissoni}[2]     {\Xsub{\PoissonSymbol}{#1}   \left( #2
    \right)}
\)
</p>
<div id="anova" class="section level1 hasAnchor" number="25">
<h1><span class="header-section-number">Chapter 25</span> ANOVA<a href="anova.html#anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Load data sets of this chapter</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="anova.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;meat&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-2"><a href="anova.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;snails&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-3"><a href="anova.html#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;pine&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-4"><a href="anova.html#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cheddar&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-5"><a href="anova.html#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;grasses&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-6"><a href="anova.html#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;animals&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-7"><a href="anova.html#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;trigly&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-8"><a href="anova.html#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ergoStool&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-9"><a href="anova.html#cb230-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Machines&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-10"><a href="anova.html#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cheese.data&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-11"><a href="anova.html#cb230-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;dish&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb230-12"><a href="anova.html#cb230-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-13"><a href="anova.html#cb230-13" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;PlantGrowth&quot;</span>)</span>
<span id="cb230-14"><a href="anova.html#cb230-14" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Pastes&quot;</span>, <span class="at">package =</span> <span class="st">&quot;lme4&quot;</span>)</span>
<span id="cb230-15"><a href="anova.html#cb230-15" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;oats&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span></code></pre></div>
<div id="idea" class="section level2 hasAnchor" number="25.1">
<h2><span class="header-section-number">25.1</span> Idea<a href="anova.html#idea" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-215-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="example-1" class="section level2 hasAnchor" number="25.2">
<h2><span class="header-section-number">25.2</span> Example<a href="anova.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="anova.html#cb231-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Yield <span class="sc">~</span> Genotype <span class="sc">+</span> Block, <span class="at">data =</span> data)</span>
<span id="cb231-2"><a href="anova.html#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)          <span class="co">#Anova table</span></span>
<span id="cb231-3"><a href="anova.html#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb231-4"><a href="anova.html#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb231-5"><a href="anova.html#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb231-6"><a href="anova.html#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb231-7"><a href="anova.html#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   1   4.00    4.00   25.00 0.1257</span></span>
<span id="cb231-8"><a href="anova.html#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      1   1.00    1.00    6.25 0.2422</span></span>
<span id="cb231-9"><a href="anova.html#cb231-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals  1   0.16    0.16</span></span>
<span id="cb231-10"><a href="anova.html#cb231-10" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)           <span class="co">#Effect of different Factors</span></span>
<span id="cb231-11"><a href="anova.html#cb231-11" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   Genotype2      Blockb </span></span>
<span id="cb231-12"><a href="anova.html#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="do">##         6.5        -2.0        -1.0</span></span>
<span id="cb231-13"><a href="anova.html#cb231-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit)        <span class="co">#Predict the fixed effect</span></span>
<span id="cb231-14"><a href="anova.html#cb231-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   2   3   4 </span></span>
<span id="cb231-15"><a href="anova.html#cb231-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 6.5 5.5 4.5 3.5</span></span>
<span id="cb231-16"><a href="anova.html#cb231-16" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit)      <span class="co">#Actual yield - predicted fixed effect</span></span>
<span id="cb231-17"><a href="anova.html#cb231-17" aria-hidden="true" tabindex="-1"></a><span class="do">##    1    2    3    4 </span></span>
<span id="cb231-18"><a href="anova.html#cb231-18" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.2  0.2  0.2 -0.2</span></span>
<span id="cb231-19"><a href="anova.html#cb231-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb231-20"><a href="anova.html#cb231-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-216-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="simulate-data" class="section level2 hasAnchor" number="25.3">
<h2><span class="header-section-number">25.3</span> Simulate data<a href="anova.html#simulate-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><code>rep()</code></li>
<li><code>seq()</code></li>
<li><code>rnorm()</code></li>
<li><code>factor()</code></li>
<li><code>gl()</code></li>
<li><code>expand.grid()</code> Cross product</li>
<li><code>combn()</code></li>
<li><code>interaction()</code></li>
<li><code>dput()</code> if you have data set and want to generate it from code</li>
</ul>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="anova.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="do">## rep() with arguments times, each, length.out</span></span>
<span id="cb232-2"><a href="anova.html#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="dv">2</span>)</span>
<span id="cb232-3"><a href="anova.html#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 1 2</span></span>
<span id="cb232-4"><a href="anova.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb232-5"><a href="anova.html#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 1 2 2</span></span>
<span id="cb232-6"><a href="anova.html#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb232-7"><a href="anova.html#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 1 2 1</span></span>
<span id="cb232-8"><a href="anova.html#cb232-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-9"><a href="anova.html#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="do">## gl() is a shortcut for factor(rep())</span></span>
<span id="cb232-10"><a href="anova.html#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gl</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treat&quot;</span>))</span>
<span id="cb232-11"><a href="anova.html#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] Control Control Control Treat   Treat   Treat  </span></span>
<span id="cb232-12"><a href="anova.html#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Levels: Control Treat</span></span>
<span id="cb232-13"><a href="anova.html#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treat&quot;</span>), <span class="at">each =</span> <span class="dv">3</span>)) <span class="co"># same output</span></span>
<span id="cb232-14"><a href="anova.html#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] Control Control Control Treat   Treat   Treat  </span></span>
<span id="cb232-15"><a href="anova.html#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Levels: Control Treat</span></span>
<span id="cb232-16"><a href="anova.html#cb232-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-17"><a href="anova.html#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="do">## expand.grid() and interaction()</span></span>
<span id="cb232-18"><a href="anova.html#cb232-18" aria-hidden="true" tabindex="-1"></a>(df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Block =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">Treat =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb232-19"><a href="anova.html#cb232-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   Block Treat</span></span>
<span id="cb232-20"><a href="anova.html#cb232-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     A     1</span></span>
<span id="cb232-21"><a href="anova.html#cb232-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     B     1</span></span>
<span id="cb232-22"><a href="anova.html#cb232-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     A     2</span></span>
<span id="cb232-23"><a href="anova.html#cb232-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     B     2</span></span>
<span id="cb232-24"><a href="anova.html#cb232-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     A     3</span></span>
<span id="cb232-25"><a href="anova.html#cb232-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     B     3</span></span>
<span id="cb232-26"><a href="anova.html#cb232-26" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction</span>(df<span class="sc">$</span>Block, df<span class="sc">$</span>Treat)</span>
<span id="cb232-27"><a href="anova.html#cb232-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] A.1 B.1 A.2 B.2 A.3 B.3</span></span>
<span id="cb232-28"><a href="anova.html#cb232-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Levels: A.1 B.1 A.2 B.2 A.3 B.3</span></span>
<span id="cb232-29"><a href="anova.html#cb232-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-30"><a href="anova.html#cb232-30" aria-hidden="true" tabindex="-1"></a><span class="do">## combn()</span></span>
<span id="cb232-31"><a href="anova.html#cb232-31" aria-hidden="true" tabindex="-1"></a><span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>) <span class="co"># Combinatorics: combine each element with every other element</span></span>
<span id="cb232-32"><a href="anova.html#cb232-32" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span id="cb232-33"><a href="anova.html#cb232-33" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    1    1    1    2    2    3</span></span>
<span id="cb232-34"><a href="anova.html#cb232-34" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    2    3    4    3    4    4</span></span>
<span id="cb232-35"><a href="anova.html#cb232-35" aria-hidden="true" tabindex="-1"></a><span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="co"># Make all possible 3-fold combinations (4 choose 3 combinations)</span></span>
<span id="cb232-36"><a href="anova.html#cb232-36" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1]</span></span>
<span id="cb232-37"><a href="anova.html#cb232-37" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    1</span></span>
<span id="cb232-38"><a href="anova.html#cb232-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    2</span></span>
<span id="cb232-39"><a href="anova.html#cb232-39" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]    3</span></span></code></pre></div>
<p>Simulate unbalanced data</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="anova.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb233-2"><a href="anova.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">expand_grid</span>(<span class="at">fac1 =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb233-3"><a href="anova.html#cb233-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">fac2 =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb233-4"><a href="anova.html#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb233-5"><a href="anova.html#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uncount</span>(<span class="at">weights =</span> count, <span class="at">.id =</span> <span class="st">&quot;rep&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 × 3
##   fac1  fac2    rep
##   &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
## 1 a     A         1
## 2 a     B         1
## 3 a     B         2
## 4 b     A         1
## 5 b     A         2
## 6 b     A         3
## 7 b     B         1</code></pre>
<div id="randomization" class="section level3 hasAnchor" number="25.3.1">
<h3><span class="header-section-number">25.3.1</span> Randomization<a href="anova.html#randomization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>sample()</code></li>
<li><code>agricolae::design.lsd()</code> Lattin square design</li>
</ul>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="anova.html#cb235-1" aria-hidden="true" tabindex="-1"></a>treat.ord <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb235-2"><a href="anova.html#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(treat.ord, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;C&quot; &quot;B&quot; &quot;D&quot; &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;D&quot; &quot;D&quot; &quot;A&quot; &quot;D&quot; &quot;C&quot; &quot;C&quot; &quot;B&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot;
## [20] &quot;C&quot;</code></pre>
</div>
</div>
<div id="visualization-2" class="section level2 hasAnchor" number="25.4">
<h2><span class="header-section-number">25.4</span> Visualization<a href="anova.html#visualization-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="stripchart" class="section level3 hasAnchor" number="25.4.1">
<h3><span class="header-section-number">25.4.1</span> Stripchart<a href="anova.html#stripchart" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="anova.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(weight <span class="sc">~</span> group, <span class="at">vertical =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> PlantGrowth)</span>
<span id="cb237-2"><a href="anova.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb237-3"><a href="anova.html#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Pastes, <span class="fu">aes</span> (<span class="at">y =</span> cask, <span class="at">x =</span> strength)) <span class="sc">+</span> <span class="fu">geom_point</span> () <span class="sc">+</span> <span class="fu">facet_grid</span> (batch <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-220-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-220-2.png" width="50%" /></p>
</div>
<div id="boxplot" class="section level3 hasAnchor" number="25.4.2">
<h3><span class="header-section-number">25.4.2</span> Boxplot<a href="anova.html#boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="anova.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-221-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="interaction-plot" class="section level3 hasAnchor" number="25.4.3">
<h3><span class="header-section-number">25.4.3</span> Interaction plot<a href="anova.html#interaction-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="anova.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(snails, <span class="fu">interaction.plot</span>(<span class="at">x.factor =</span> density, <span class="at">trace.factor =</span> season, <span class="at">response =</span> y))</span>
<span id="cb239-2"><a href="anova.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Machines, <span class="fu">aes</span> (<span class="at">x =</span> Machine, <span class="at">y =</span> score, <span class="at">group =</span> Worker, <span class="at">col =</span> Worker)) <span class="sc">+</span></span>
<span id="cb239-3"><a href="anova.html#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-222-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-222-2.png" width="50%" /></p>
</div>
<div id="summary-plot" class="section level3 hasAnchor" number="25.4.4">
<h3><span class="header-section-number">25.4.4</span> Summary plot<a href="anova.html#summary-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="anova.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.design</span>(y <span class="sc">~</span> location <span class="sc">+</span> exposure, <span class="at">data =</span> pine)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-223-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
</div>
<div id="fit-model" class="section level2 hasAnchor" number="25.5">
<h2><span class="header-section-number">25.5</span> Fit model<a href="anova.html#fit-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="identifiability" class="section level3 hasAnchor" number="25.5.1">
<h3><span class="header-section-number">25.5.1</span> Identifiability<a href="anova.html#identifiability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="anova.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="co"># Default</span></span></code></pre></div>
<pre><code>## $contrasts
##         unordered           ordered 
## &quot;contr.treatment&quot;      &quot;contr.poly&quot;</code></pre>
<ul>
<li>Unordered: Unordered factors (nominal scale)</li>
<li>Ordered: Ordered factors (ordinal scale)</li>
</ul>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="anova.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&quot;contr.treatment&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb243-2"><a href="anova.html#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&quot;contr.sum&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</span></code></pre></div>
<table>
<colgroup>
<col width="25%" />
<col width="27%" />
<col width="37%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Side-constraint</th>
<th align="left">Interpretation of <span class="math inline">\(\mu\)</span></th>
<th align="left"><code>R</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">weighted sum-to-zero</td>
<td align="left"><span class="math display">\[\sum_{i=1}^g n_i \alpha_i = 0\]</span></td>
<td align="left"><span class="math display">\[\mu = \frac{1}{N} \sum_{i=1}^g n_i \mu_i\]</span></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">sum-to-zero</td>
<td align="left"><span class="math display">\[\sum_{i=1}^g \alpha_i = 0\]</span></td>
<td align="left"><span class="math display">\[\mu = \frac{1}{g}\sum_{i=1}^g\mu_i\]</span></td>
<td align="left"><code>contr.sum</code></td>
</tr>
<tr class="odd">
<td align="left">reference group</td>
<td align="left"><span class="math display">\[\alpha_1=0\]</span></td>
<td align="left"><span class="math display">\[\mu=\mu_1\]</span></td>
<td align="left"><code>contr.treatment</code></td>
</tr>
</tbody>
</table>
</div>
<div id="fitting-2" class="section level3 hasAnchor" number="25.5.2">
<h3><span class="header-section-number">25.5.2</span> Fitting<a href="anova.html#fitting-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="anova.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One way ANOVA</span></span>
<span id="cb244-2"><a href="anova.html#cb244-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span>
<span id="cb244-3"><a href="anova.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Two way ANOVA</span></span>
<span id="cb244-4"><a href="anova.html#cb244-4" aria-hidden="true" tabindex="-1"></a>fit.cheddar <span class="ot">&lt;-</span> <span class="fu">aov</span>(acids <span class="sc">~</span> R50 <span class="sc">+</span> R21, <span class="at">data =</span> cheddar)</span>
<span id="cb244-5"><a href="anova.html#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="co"># With subset of data</span></span>
<span id="cb244-6"><a href="anova.html#cb244-6" aria-hidden="true" tabindex="-1"></a>fit.spring <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> density, <span class="at">data =</span> <span class="fu">subset</span>(snails, season <span class="sc">==</span> <span class="st">&quot;Spring&quot;</span>))</span></code></pre></div>

<div class="rmdnote">
<p><code>lm()</code> vs <code>aov()</code></p>
fits the same model but (i) <code>aov()</code> returns object of class <code>aov</code>, <code>lm()</code> returns object of class <code>lm</code> (ii) <code>print.aov()</code> and <code>summary.aov()</code> will not evaluate each factor level separately but an entire factor at once (similar to <code>drop1()</code>)
</div>
</div>
</div>
<div id="anova-table" class="section level2 hasAnchor" number="25.6">
<h2><span class="header-section-number">25.6</span> ANOVA table<a href="anova.html#anova-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><code>summary(fit)</code>
<ul>
<li>ANOVA table including F-test</li>
<li>Reports Type I Sum of Squares</li>
</ul></li>
<li><code>anova(fit)</code>
<ul>
<li>ANOVA table including F-test</li>
<li>Reports Type I Sum of Squares</li>
<li>identical output as <code>summary(fit)</code> for objects of class <code>aov</code></li>
</ul></li>
<li><code>drop1(fit, scope = ~., test = "F")</code>
<ul>
<li>ANOVA table including F-test</li>
<li>Reports Type III Sum of Squares</li>
<li>Technical issue! necessary to set <code>options(contrasts = c("contr.sum", "contr.sum"))</code></li>
<li>Tests in hirarchical order if scope is not set (does not test main factor if interaction is included). <code>scope = ~.</code> means that each term is tested.</li>
</ul></li>
<li><code>anova(fit, fit2)</code>
<ul>
<li>ANOVA table which compares RSS of two nested models</li>
</ul></li>
</ul>
<div id="types-of-sum-of-sqares" class="section level3 hasAnchor" number="25.6.1">
<h3><span class="header-section-number">25.6.1</span> Types of Sum of Sqares<a href="anova.html#types-of-sum-of-sqares" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sum of Squares do only differ if the data is unbalanced.</p>
<ul>
<li>Type I
<ul>
<li><code>summary(fit)</code></li>
</ul></li>
<li>Type II
<ul>
<li><code>car::Anova(fit, type = "II", data = df)</code></li>
</ul></li>
<li>Type III
<ul>
<li><code>drop1(fit, scope = ~., test = "F", data = df)</code></li>
<li>necessary to set <code>options(contrasts = c("contr.sum", "contr.poly"))</code></li>
</ul></li>
</ul>
</div>
</div>
<div id="model-comparison-2" class="section level2 hasAnchor" number="25.7">
<h2><span class="header-section-number">25.7</span> Model comparison<a href="anova.html#model-comparison-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="different-in-1-model-term" class="section level5 unnumbered hasAnchor">
<h5>Different in 1 model term<a href="anova.html#different-in-1-model-term" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="anova.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Type I Sum of Squares</span></span>
<span id="cb245-2"><a href="anova.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb245-3"><a href="anova.html#cb245-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-4"><a href="anova.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Type III Sum of Sqares</span></span>
<span id="cb245-5"><a href="anova.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(fit, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb245-6"><a href="anova.html#cb245-6" aria-hidden="true" tabindex="-1"></a><span class="fu">add1</span>(fit, <span class="at">scope =</span> <span class="sc">~</span>pred, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span></code></pre></div>
</div>
<div id="different-in-1-model-term-1" class="section level5 unnumbered hasAnchor">
<h5>Different in &gt;1 model term<a href="anova.html#different-in-1-model-term-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="anova.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit, fit2)</span></code></pre></div>

<div class="rmdnote">
Interpretation of significance in <code>anova()</code> always in favour of larger model no matter if <code>anova(fit, fit2)</code> or <code>anova(fit2, fit)</code>
</div>
</div>
</div>
<div id="coefficients" class="section level2 hasAnchor" number="25.8">
<h2><span class="header-section-number">25.8</span> Coefficients<a href="anova.html#coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><code>coef()</code> Levels which are shown depends on parameterization (contrast option)</li>
<li><code>dummy.coef()</code>
<ul>
<li>All levels are shown</li>
<li>Coef name according to factor level name</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="anova.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb247-2"><a href="anova.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   grouptrt1   grouptrt2 </span></span>
<span id="cb247-3"><a href="anova.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="do">##       5.032      -0.371       0.494</span></span>
<span id="cb247-4"><a href="anova.html#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dummy.coef</span>(fit)</span>
<span id="cb247-5"><a href="anova.html#cb247-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Full coefficients are </span></span>
<span id="cb247-6"><a href="anova.html#cb247-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                                     </span></span>
<span id="cb247-7"><a href="anova.html#cb247-7" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept):     5.032              </span></span>
<span id="cb247-8"><a href="anova.html#cb247-8" aria-hidden="true" tabindex="-1"></a><span class="do">## group:            ctrl   trt1   trt2</span></span>
<span id="cb247-9"><a href="anova.html#cb247-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                  0.000 -0.371  0.494</span></span></code></pre></div>
</div>
<div id="tests-and-ci-for-coeficients" class="section level2 hasAnchor" number="25.9">
<h2><span class="header-section-number">25.9</span> Tests and CI for coeficients<a href="anova.html#tests-and-ci-for-coeficients" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><code>summary.lm(fit)</code>
<ul>
<li>Estimates effect <span class="math inline">\(\hat{\alpha}_i\)</span> and p-value for each factor level</li>
<li>p-values not useful because we should not drop single factor levels but entire factors (<code>drop1()</code>)</li>
</ul></li>
<li><code>confint()</code>
<ul>
<li>CI for each coefficient</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="anova.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.lm</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## aov(formula = weight ~ group, data = PlantGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
## grouptrt1    -0.3710     0.2788  -1.331   0.1944    
## grouptrt2     0.4940     0.2788   1.772   0.0877 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="anova.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit)</span></code></pre></div>
<pre><code>##                   2.5 %    97.5 %
## (Intercept)  4.62752600 5.4364740
## grouptrt1   -0.94301261 0.2010126
## grouptrt2   -0.07801261 1.0660126</code></pre>
</div>
<div id="predict" class="section level2 hasAnchor" number="25.10">
<h2><span class="header-section-number">25.10</span> Predict<a href="anova.html#predict" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="anova.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">&quot;ctrl&quot;</span>, <span class="st">&quot;trt1&quot;</span>, <span class="st">&quot;trt2&quot;</span>)))</span></code></pre></div>
<pre><code>##     1     2     3 
## 5.032 4.661 5.526</code></pre>
<p><code>newdata</code> has to be a <code>data.frame</code> with all predictor variables in columns with the same name as the original predictor in the model (here <code>y ~ group</code>)</p>
</div>
<div id="diagnostic-plots-1" class="section level2 hasAnchor" number="25.11">
<h2><span class="header-section-number">25.11</span> Diagnostic plots<a href="anova.html#diagnostic-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="anova.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">which =</span> <span class="dv">1</span>) <span class="co"># Tukey-Anscombe plot</span></span>
<span id="cb254-2"><a href="anova.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">which =</span> <span class="dv">2</span>) <span class="co"># QQ-plot</span></span></code></pre></div>
<div id="simulations" class="section level3 hasAnchor" number="25.11.1">
<h3><span class="header-section-number">25.11.1</span> Simulations<a href="anova.html#simulations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulations can help to see if the observed pattern is far away from the assumptions. If our data is fine, the observed pattern should look similar to the simulated one (which fulfilles the assumptions).</p>
<p>Simulations for QQ plot</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="anova.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">rnorm</span>(<span class="fu">nrow</span>(df)))</span></code></pre></div>
<p>Simulations for Tukey-Anscombe plot</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="anova.html#cb256-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> PlantGrowth</span>
<span id="cb256-2"><a href="anova.html#cb256-2" aria-hidden="true" tabindex="-1"></a>df.sim <span class="ot">&lt;-</span> df</span>
<span id="cb256-3"><a href="anova.html#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb256-4"><a href="anova.html#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb256-5"><a href="anova.html#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb256-6"><a href="anova.html#cb256-6" aria-hidden="true" tabindex="-1"></a>  df.sim[, <span class="st">&quot;y&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">simulate</span>(fit)</span>
<span id="cb256-7"><a href="anova.html#cb256-7" aria-hidden="true" tabindex="-1"></a>  fit.sim <span class="ot">&lt;-</span> <span class="fu">update</span>(fit, <span class="at">data =</span> df.sim)  </span>
<span id="cb256-8"><a href="anova.html#cb256-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(fit.sim, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb256-9"><a href="anova.html#cb256-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-236-1.png" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="qq-plot-in-mixed-models" class="section level3 hasAnchor" number="25.11.2">
<h3><span class="header-section-number">25.11.2</span> QQ plot in mixed models<a href="anova.html#qq-plot-in-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Normal QQ plot for each random variable</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="anova.html#cb257-1" aria-hidden="true" tabindex="-1"></a>fit.lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> day) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> machine) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> machine<span class="sc">:</span>day), <span class="at">data =</span> trigly)</span>
<span id="cb257-2"><a href="anova.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(fit.lme)<span class="sc">$</span>day[,<span class="dv">1</span>], <span class="at">main =</span> <span class="st">&quot;day&quot;</span>)</span>
<span id="cb257-3"><a href="anova.html#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(fit.lme)<span class="sc">$</span>machine[,<span class="dv">1</span>], <span class="at">main =</span> <span class="st">&quot;machine&quot;</span>)</span>
<span id="cb257-4"><a href="anova.html#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(fit.lme)<span class="sc">$</span><span class="st">&#39;machine:day&#39;</span>[,<span class="dv">1</span>], <span class="at">main =</span> <span class="st">&quot;machine:day&quot;</span>)</span>
<span id="cb257-5"><a href="anova.html#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(fit.lme), <span class="at">main =</span> <span class="st">&quot;residuals&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="contrasts" class="section level2 hasAnchor" number="25.12">
<h2><span class="header-section-number">25.12</span> Contrasts<a href="anova.html#contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="anova.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb258-2"><a href="anova.html#cb258-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-3"><a href="anova.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="do">## manual contrast</span></span>
<span id="cb258-4"><a href="anova.html#cb258-4" aria-hidden="true" tabindex="-1"></a>fit.gh <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb258-5"><a href="anova.html#cb258-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-6"><a href="anova.html#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="do">## several manual contrasts</span></span>
<span id="cb258-7"><a href="anova.html#cb258-7" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">mycontr1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>), <span class="co"># ctrl vs. average of trt1 and trt2</span></span>
<span id="cb258-8"><a href="anova.html#cb258-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">mycontr2 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>))      <span class="co"># ctrl vs. trt1</span></span>
<span id="cb258-9"><a href="anova.html#cb258-9" aria-hidden="true" tabindex="-1"></a>fit.man <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group =</span> K))</span>
<span id="cb258-10"><a href="anova.html#cb258-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-11"><a href="anova.html#cb258-11" aria-hidden="true" tabindex="-1"></a><span class="do">## predefined contrasts</span></span>
<span id="cb258-12"><a href="anova.html#cb258-12" aria-hidden="true" tabindex="-1"></a>fit.gh <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb258-13"><a href="anova.html#cb258-13" aria-hidden="true" tabindex="-1"></a>fit.gh <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group =</span> <span class="st">&quot;Dunnett&quot;</span>))</span></code></pre></div>
<ul>
<li><code>K</code> has to be a matrix where each row is a contrast</li>
<li><code>TukeyHSD(fit)</code> does the same as <code>fit.gh &lt;- glht(fit, linfct = mcp(group = "Tukey"))</code></li>
</ul>
<div id="test-contrast" class="section level3 hasAnchor" number="25.12.1">
<h3><span class="header-section-number">25.12.1</span> Test contrast<a href="anova.html#test-contrast" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="anova.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.man, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">&quot;none&quot;</span>))</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: User-defined Contrasts
## 
## 
## Fit: aov(formula = weight ~ group, data = PlantGrowth)
## 
## Linear Hypotheses:
##               Estimate Std. Error t value Pr(&gt;|t|)
## mycontr1 == 0  -0.0615     0.2414  -0.255    0.801
## mycontr2 == 0   0.3710     0.2788   1.331    0.194
## (Adjusted p values reported -- none method)</code></pre>
</div>
</div>
<div id="multiple-comparison" class="section level2 hasAnchor" number="25.13">
<h2><span class="header-section-number">25.13</span> Multiple comparison<a href="anova.html#multiple-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bonferroni-holm-planned-contrasts" class="section level3 hasAnchor" number="25.13.1">
<h3><span class="header-section-number">25.13.1</span> Bonferroni Holm (Planned contrasts)<a href="anova.html#bonferroni-holm-planned-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="anova.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.man) <span class="co"># takes defalut option which is single-step</span></span>
<span id="cb261-2"><a href="anova.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.man, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">&quot;single-step&quot;</span>))  </span>
<span id="cb261-3"><a href="anova.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.man, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">&quot;none&quot;</span>))</span>
<span id="cb261-4"><a href="anova.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.man, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb261-5"><a href="anova.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.man, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">&quot;holm&quot;</span>))</span></code></pre></div>
</div>
<div id="scheffe-unplanned-contrasts" class="section level3 hasAnchor" number="25.13.2">
<h3><span class="header-section-number">25.13.2</span> Scheffe (Unplanned contrasts)<a href="anova.html#scheffe-unplanned-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="anova.html#cb262-1" aria-hidden="true" tabindex="-1"></a>fit.scheffe <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb262-2"><a href="anova.html#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="anova.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="do">## p-value according to Scheffe =&gt; do it manually</span></span>
<span id="cb262-4"><a href="anova.html#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate F value with nom-df = g-1 and denom-df = N-g</span></span>
<span id="cb262-5"><a href="anova.html#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="do">## in our case g-1 = 2, N-g = 27</span></span>
<span id="cb262-6"><a href="anova.html#cb262-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-7"><a href="anova.html#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>((<span class="fu">summary</span>(fit.scheffe)<span class="sc">$</span>test<span class="sc">$</span>tstat)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">27</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##          1 
## 0.05323245</code></pre>
<ul>
<li><code>summary(fit.sheffe)$test$tstat</code> returns t-value of glht t-test</li>
<li><code>^2</code> Squared =&gt; F-Test</li>
<li><code>/2</code> Divide by 2, don’t know why</li>
</ul>
</div>
<div id="tukey-hsd-all-pairwise-comparisons" class="section level3 hasAnchor" number="25.13.3">
<h3><span class="header-section-number">25.13.3</span> Tukey HSD (All pairwise comparisons)<a href="anova.html#tukey-hsd-all-pairwise-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="anova.html#cb264-1" aria-hidden="true" tabindex="-1"></a>fit.tukey <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb264-2"><a href="anova.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.tukey)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = weight ~ group, data = PlantGrowth)
## 
## Linear Hypotheses:
##                  Estimate Std. Error t value Pr(&gt;|t|)  
## trt1 - ctrl == 0  -0.3710     0.2788  -1.331   0.3909  
## trt2 - ctrl == 0   0.4940     0.2788   1.772   0.1981  
## trt2 - trt1 == 0   0.8650     0.2788   3.103   0.0121 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="anova.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">confint</span>(fit.tukey))</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-242-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<p>Example with compact letter display</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="anova.html#cb267-1" aria-hidden="true" tabindex="-1"></a>subCO2 <span class="ot">&lt;-</span> CO2[CO2<span class="sc">$</span>conc <span class="sc">==</span> <span class="dv">1000</span>,]</span>
<span id="cb267-2"><a href="anova.html#cb267-2" aria-hidden="true" tabindex="-1"></a>subCO2<span class="sc">$</span>tret <span class="ot">&lt;-</span> <span class="fu">interaction</span>(subCO2<span class="sc">$</span>Type, subCO2<span class="sc">$</span>Treatment)</span>
<span id="cb267-3"><a href="anova.html#cb267-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(uptake <span class="sc">~</span> tret, <span class="at">data =</span> subCO2)</span>
<span id="cb267-4"><a href="anova.html#cb267-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-5"><a href="anova.html#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey&#39;s HSD</span></span>
<span id="cb267-6"><a href="anova.html#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb267-7"><a href="anova.html#cb267-7" aria-hidden="true" tabindex="-1"></a>tuk <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">tret =</span> <span class="st">&#39;Tukey&#39;</span>))</span>
<span id="cb267-8"><a href="anova.html#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tuk)</span>
<span id="cb267-9"><a href="anova.html#cb267-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-10"><a href="anova.html#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compact letter display</span></span>
<span id="cb267-11"><a href="anova.html#cb267-11" aria-hidden="true" tabindex="-1"></a>tuk.cld <span class="ot">&lt;-</span> <span class="fu">cld</span>(tuk)</span>
<span id="cb267-12"><a href="anova.html#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">2</span>))</span>
<span id="cb267-13"><a href="anova.html#cb267-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tuk.cld)</span></code></pre></div>

<div class="rmdwarning">
Letters will not be displayed if treatment names contain a space (e.g. <code>Quebec nonchilled</code> instead of <code>Quebec.nonchilled</code>).
</div>
</div>
<div id="dunnett-comparison-with-control" class="section level3 hasAnchor" number="25.13.4">
<h3><span class="header-section-number">25.13.4</span> Dunnett (Comparison with control)<a href="anova.html#dunnett-comparison-with-control" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="anova.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="do">## fitst level is set as control</span></span>
<span id="cb268-2"><a href="anova.html#cb268-2" aria-hidden="true" tabindex="-1"></a>fit.dunnett <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group =</span> <span class="st">&quot;Dunnett&quot;</span>))</span>
<span id="cb268-3"><a href="anova.html#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.dunnett)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Dunnett Contrasts
## 
## 
## Fit: aov(formula = weight ~ group, data = PlantGrowth)
## 
## Linear Hypotheses:
##                  Estimate Std. Error t value Pr(&gt;|t|)
## trt1 - ctrl == 0  -0.3710     0.2788  -1.331    0.323
## trt2 - ctrl == 0   0.4940     0.2788   1.772    0.153
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<div id="designs" class="section level2 hasAnchor" number="25.14">
<h2><span class="header-section-number">25.14</span> Designs<a href="anova.html#designs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="factorial-design" class="section level3 hasAnchor" number="25.14.1">
<h3><span class="header-section-number">25.14.1</span> Factorial design<a href="anova.html#factorial-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>xtabs()</code> to count observations per treatment combination</li>
<li><code>interaction.plot()</code> to visualize interaction between factors</li>
</ul>
<div id="test-with-significant-interaction" class="section level4 hasAnchor" number="25.14.1.1">
<h4><span class="header-section-number">25.14.1.1</span> Test with significant interaction<a href="anova.html#test-with-significant-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="hyper-factor" class="section level5 unnumbered hasAnchor">
<h5>Hyper factor<a href="anova.html#hyper-factor" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="anova.html#cb270-1" aria-hidden="true" tabindex="-1"></a>snails<span class="sc">$</span>dens_seas <span class="ot">&lt;-</span> <span class="fu">interaction</span>(snails<span class="sc">$</span>density, snails<span class="sc">$</span>season)</span>
<span id="cb270-2"><a href="anova.html#cb270-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> dens_seas, <span class="at">data =</span> snails)</span>
<span id="cb270-3"><a href="anova.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
</div>
<div id="individual-analysis" class="section level5 unnumbered hasAnchor">
<h5>Individual analysis<a href="anova.html#individual-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="anova.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">## detect significant interation? Yes…</span></span>
<span id="cb271-2"><a href="anova.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) fit single model for each factor level (here: &quot;season&quot;, also for &quot;density&quot; possible)</span></span>
<span id="cb271-3"><a href="anova.html#cb271-3" aria-hidden="true" tabindex="-1"></a>fit.spring <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> density, <span class="at">data =</span> <span class="fu">subset</span>(snails, season <span class="sc">==</span> <span class="st">&quot;Spring&quot;</span>))</span>
<span id="cb271-4"><a href="anova.html#cb271-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-5"><a href="anova.html#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) extract mean square of factor &quot;density&quot;</span></span>
<span id="cb271-6"><a href="anova.html#cb271-6" aria-hidden="true" tabindex="-1"></a>MSS_dens <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit.spring) [[<span class="dv">1</span>]][<span class="st">&quot;density&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb271-7"><a href="anova.html#cb271-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-8"><a href="anova.html#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) extract mean square of Error from full model</span></span>
<span id="cb271-9"><a href="anova.html#cb271-9" aria-hidden="true" tabindex="-1"></a>MSS_er <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)[[<span class="dv">1</span>]][<span class="st">&quot;Residuals&quot;</span>, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb271-10"><a href="anova.html#cb271-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-11"><a href="anova.html#cb271-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) calculate F value and p value</span></span>
<span id="cb271-12"><a href="anova.html#cb271-12" aria-hidden="true" tabindex="-1"></a>F_value <span class="ot">&lt;-</span> MSS_dens<span class="sc">/</span>MSS_er</span>
<span id="cb271-13"><a href="anova.html#cb271-13" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(F_value, <span class="dv">2</span>, <span class="dv">12</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.6520635</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="anova.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2: df of &quot;density, 12: df of residuals</span></span></code></pre></div>
</div>
</div>
</div>
<div id="mixed-models" class="section level3 hasAnchor" number="25.14.2">
<h3><span class="header-section-number">25.14.2</span> Mixed models<a href="anova.html#mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>packages
<ul>
<li><code>lme4</code> original</li>
<li><code>lmerTest</code> additional features</li>
</ul></li>
<li><code>lmer()</code> fits mixed effects model</li>
<li><code>summary()</code> returns estimates of variance components and fixed effects</li>
<li><code>fixef()</code> fixed effects</li>
<li>Tests
<ul>
<li><code>anova()</code> and <code>drop1()</code></li>
<li><code>drop1()</code> considers hirarchy (only drops terms which are allowed to be droped) =&gt; make sense</li>
<li>with <code>lmer</code> objects <strong>no longer possible</strong> to extend range with <code>range = ~.</code></li>
</ul></li>
<li><code>confint()</code> CI of random and fixed effects</li>
</ul>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="anova.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Random effects models</span></span>
<span id="cb274-2"><a href="anova.html#cb274-2" aria-hidden="true" tabindex="-1"></a>fit.lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(weight <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> sire), <span class="at">data =</span> animals)</span>
<span id="cb274-3"><a href="anova.html#cb274-3" aria-hidden="true" tabindex="-1"></a>fit.lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> day) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> machine) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> machine<span class="sc">:</span>day), <span class="at">data =</span> trigly)</span>
<span id="cb274-4"><a href="anova.html#cb274-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-5"><a href="anova.html#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Mixed effects models</span></span>
<span id="cb274-6"><a href="anova.html#cb274-6" aria-hidden="true" tabindex="-1"></a>fit.lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(effort <span class="sc">~</span> Type <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject), <span class="at">data =</span> ergoStool)</span>
<span id="cb274-7"><a href="anova.html#cb274-7" aria-hidden="true" tabindex="-1"></a>fit.lme2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(score <span class="sc">~</span> Machine <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Worker) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Worker<span class="sc">:</span>Machine), <span class="at">data =</span> Machines)</span>
<span id="cb274-8"><a href="anova.html#cb274-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-9"><a href="anova.html#cb274-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Old</span></span>
<span id="cb274-10"><a href="anova.html#cb274-10" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> Machine <span class="sc">+</span> <span class="fu">Error</span>(Worker <span class="sc">+</span> Machine<span class="sc">:</span>Worker), <span class="at">data =</span> Machines)</span></code></pre></div>
<p>Old approach using <code>Error()</code> does <strong>not</strong> estimate standard deviations of error terms. But the F value of machine is now computed correctly (<span class="math inline">\(MS_{Machine}\)</span> is devided by <span class="math inline">\(MS_{Machine:Worker}\)</span> and not by <span class="math inline">\(MS_E\)</span>)</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="anova.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lme)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: effort ~ Type + (1 | Subject)
##    Data: ergoStool
## 
## REML criterion at convergence: 121.1
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -1.80200 -0.64317  0.05783  0.70100  1.63142 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Subject  (Intercept) 1.775    1.332   
##  Residual             1.211    1.100   
## Number of obs: 36, groups:  Subject, 9
## 
## Fixed effects:
##             Estimate Std. Error      df t value Pr(&gt;|t|)    
## (Intercept)   8.5556     0.5760 15.5298  14.853 1.36e-10 ***
## TypeT2        3.8889     0.5187 24.0000   7.498 9.75e-08 ***
## TypeT3        2.2222     0.5187 24.0000   4.284 0.000256 ***
## TypeT4        0.6667     0.5187 24.0000   1.285 0.210951    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##        (Intr) TypeT2 TypeT3
## TypeT2 -0.450              
## TypeT3 -0.450  0.500       
## TypeT4 -0.450  0.500  0.500</code></pre>

<div class="rmdwarning">
At section <code>Random effects</code>, the <code>Std.Dev</code> is simply the square root of the <code>Variance</code> <strong>not</strong> the standard error
</div>
<div id="fixed-effects" class="section level4 hasAnchor" number="25.14.2.1">
<h4><span class="header-section-number">25.14.2.1</span> Fixed effects<a href="anova.html#fixed-effects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Estimates</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="anova.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit.lme)</span></code></pre></div>
<pre><code>## (Intercept)      TypeT2      TypeT3      TypeT4 
##   8.5555556   3.8888889   2.2222222   0.6666667</code></pre>
<p>Tests</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="anova.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(fit.lme)</span></code></pre></div>
<pre><code>## Single term deletions using Satterthwaite&#39;s method:
## 
## Model:
## effort ~ Type + (1 | Subject)
##      Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
## Type 81.194  27.065     3    24  22.356 3.935e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>CI (random and fixed effects)</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="anova.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit.lme, <span class="at">oldNames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##                             2.5 %   97.5 %
## sd_(Intercept)|Subject  0.7342354 2.287261
## sigma                   0.8119798 1.390104
## (Intercept)             7.4238425 9.687269
## TypeT2                  2.8953043 4.882473
## TypeT3                  1.2286377 3.215807
## TypeT4                 -0.3269179 1.660251</code></pre>
</div>
<div id="random-effects" class="section level4 hasAnchor" number="25.14.2.2">
<h4><span class="header-section-number">25.14.2.2</span> Random effects<a href="anova.html#random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Estimates <span class="math inline">\(\sigma_W^2\)</span>, <span class="math inline">\(\sigma_{W:M}^2\)</span>, <span class="math inline">\(\sigma_E^2\)</span></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="anova.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">VarCorr</span>(fit.lme))</span></code></pre></div>
<pre><code>##  Subject 
## 1.775463</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="anova.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma</span>(fit.lme)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 1.210648</code></pre>

<div class="rmdwarning">
<code>VarCorr()</code> automatically prints standard deviation <span class="math inline">\(\sigma\)</span> but stores variance <span class="math inline">\(\sigma^2\)</span> if assigned or unlisted
</div>
<p>Estimates <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_j\)</span>, <span class="math inline">\((\alpha\beta)_{ij}\)</span></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="anova.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(fit.lme)</span></code></pre></div>
<pre><code>## $Subject
##     (Intercept)
## 8 -1.708716e+00
## 5 -1.495127e+00
## 4 -8.543581e-01
## 9 -2.135895e-01
## 6  1.641913e-15
## 3  4.271791e-01
## 7  4.271791e-01
## 1  1.708716e+00
## 2  1.708716e+00
## 
## with conditional variances for &quot;Subject&quot;</code></pre>
<p>Estimates <span class="math inline">\(E(\mu_i | \alpha_i)\)</span></p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="anova.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.lme)</span></code></pre></div>
<pre><code>## $Subject
##   (Intercept)   TypeT2   TypeT3    TypeT4
## 8    6.846839 3.888889 2.222222 0.6666667
## 5    7.060429 3.888889 2.222222 0.6666667
## 4    7.701197 3.888889 2.222222 0.6666667
## 9    8.341966 3.888889 2.222222 0.6666667
## 6    8.555556 3.888889 2.222222 0.6666667
## 3    8.982735 3.888889 2.222222 0.6666667
## 7    8.982735 3.888889 2.222222 0.6666667
## 1   10.264272 3.888889 2.222222 0.6666667
## 2   10.264272 3.888889 2.222222 0.6666667
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
<p>Tests</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="anova.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="do">## approximate</span></span>
<span id="cb291-2"><a href="anova.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ranova</span>(fit.lme)</span>
<span id="cb291-3"><a href="anova.html#cb291-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-4"><a href="anova.html#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="do">## exact</span></span>
<span id="cb291-5"><a href="anova.html#cb291-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RLRsim)</span></code></pre></div>
<p>CI</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="anova.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="do">## approximate</span></span>
<span id="cb292-2"><a href="anova.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit.lme, <span class="at">oldNames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb292-3"><a href="anova.html#cb292-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-4"><a href="anova.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="do">## exact</span></span>
<span id="cb292-5"><a href="anova.html#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RLRsim)</span></code></pre></div>
</div>
</div>
<div id="nested-model" class="section level3 hasAnchor" number="25.14.3">
<h3><span class="header-section-number">25.14.3</span> Nested model<a href="anova.html#nested-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="anova.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="do">## All equal, different options to specify the nesting</span></span>
<span id="cb293-2"><a href="anova.html#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(strength <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> batch) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> sample), Pastes)</span>
<span id="cb293-3"><a href="anova.html#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(strength <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> batch) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> cask<span class="sc">:</span>batch), <span class="at">data =</span> Pastes)</span>
<span id="cb293-4"><a href="anova.html#cb293-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(strength <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> batch<span class="sc">/</span>cask), <span class="at">data =</span> Pastes)</span>
<span id="cb293-5"><a href="anova.html#cb293-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-6"><a href="anova.html#cb293-6" aria-hidden="true" tabindex="-1"></a><span class="do">## nested as fixed effect</span></span>
<span id="cb293-7"><a href="anova.html#cb293-7" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(strength <span class="sc">~</span> batch <span class="sc">+</span> cask <span class="sc">%in%</span> batch, <span class="at">data =</span> Pastes)</span></code></pre></div>
<p>Nested factors are typically random</p>
</div>
<div id="split-plot" class="section level3 hasAnchor" number="25.14.4">
<h3><span class="header-section-number">25.14.4</span> Split plot<a href="anova.html#split-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Add main plot as random term. R will automatically recognize across which experimental unit V and N were randomized and test against the correct MS</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="anova.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb294-2"><a href="anova.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Y yield</span></span>
<span id="cb294-3"><a href="anova.html#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="do">## B block</span></span>
<span id="cb294-4"><a href="anova.html#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="do">## V variety (randomized among main plot)</span></span>
<span id="cb294-5"><a href="anova.html#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="do">## N nitrogen (randomized among sub plot)</span></span>
<span id="cb294-6"><a href="anova.html#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="do">## B:V main plot</span></span>
<span id="cb294-7"><a href="anova.html#cb294-7" aria-hidden="true" tabindex="-1"></a>fit.lme <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Y <span class="sc">~</span> B <span class="sc">+</span> V<span class="sc">*</span>N <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> B<span class="sc">:</span>V), <span class="at">data =</span> oats)</span></code></pre></div>
</div>
<div id="incomplete-block-designs" class="section level3 hasAnchor" number="25.14.5">
<h3><span class="header-section-number">25.14.5</span> Incomplete Block designs<a href="anova.html#incomplete-block-designs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="find-randomization" class="section level4 hasAnchor" number="25.14.5.1">
<h4><span class="header-section-number">25.14.5.1</span> Find randomization<a href="anova.html#find-randomization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Unreduced BIBDs (one block for all possible treatment combinations)
<ul>
<li><code>choose()</code></li>
<li><code>combn()</code></li>
</ul></li>
<li>Any BIBDs
<ul>
<li><code>crossdes::find.BIB()</code></li>
<li><code>ibd::ibd()</code></li>
</ul></li>
</ul>
</div>
<div id="fit-model-1" class="section level4 hasAnchor" number="25.14.5.2">
<h4><span class="header-section-number">25.14.5.2</span> Fit model<a href="anova.html#fit-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="anova.html#cb295-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(dishes <span class="sc">~</span> session <span class="sc">+</span> detergent, <span class="at">data =</span> dish)</span>
<span id="cb295-2"><a href="anova.html#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(fit, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>) <span class="co"># make sure to use drop1() to get Type III MS not summary()</span></span></code></pre></div>
</div>
</div>
</div>
<div id="power-analysis" class="section level2 hasAnchor" number="25.15">
<h2><span class="header-section-number">25.15</span> Power Analysis<a href="anova.html#power-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><code>power.anova.test()</code></li>
<li>package <code>pwr</code></li>
<li>simulations</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="MultivarStat.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": "https://github.com/retodomax/R_Ref_Book/edit/master/55-aov.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
