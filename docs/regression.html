<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 22 Regression | R Reference book</title>
  <meta name="description" content="This is a collection of useful R knowledge" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 22 Regression | R Reference book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/01_cover/Cover.svg" />
  <meta property="og:description" content="This is a collection of useful R knowledge" />
  <meta name="github-repo" content="retodomax/R_Ref_Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 22 Regression | R Reference book" />
  
  <meta name="twitter:description" content="This is a collection of useful R knowledge" />
  <meta name="twitter:image" content="figures/01_cover/Cover.svg" />

<meta name="author" content="Reto Zihlmann" />


<meta name="date" content="2021-02-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="figures/00_icon/icon2.ico" type="image/x-icon" />
<link rel="prev" href="basic-statistics.html"/>
<link rel="next" href="anova.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<!––JavaScript code for Show/Hide buttons––>
<!––see: https://web.stanford.edu/~naras/post/toggle-visibility-of-solutions-in-bookdown/––>
<!––and see: https://www.w3schools.com/howto/howto_js_toggle_hide_show.asp––>

<script>
function myFunction(myid) {
  var x = document.getElementById(myid);
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }
}
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Reference book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="table-of-content.html"><a href="table-of-content.html"><i class="fa fa-check"></i>Table of content</a></li>
<li class="part"><span><b>I R Language</b></span></li>
<li class="chapter" data-level="1" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>1</b> Objects</a><ul>
<li class="chapter" data-level="1.1" data-path="objects.html"><a href="objects.html#inspect-object"><i class="fa fa-check"></i><b>1.1</b> Inspect object</a></li>
<li class="chapter" data-level="1.2" data-path="objects.html"><a href="objects.html#classifications"><i class="fa fa-check"></i><b>1.2</b> Classifications</a></li>
<li class="chapter" data-level="1.3" data-path="objects.html"><a href="objects.html#basic-objects"><i class="fa fa-check"></i><b>1.3</b> Basic Objects</a><ul>
<li class="chapter" data-level="1.3.1" data-path="objects.html"><a href="objects.html#vectors-functions-and-environments"><i class="fa fa-check"></i><b>1.3.1</b> Vectors, functions and environments</a></li>
<li class="chapter" data-level="1.3.2" data-path="objects.html"><a href="objects.html#symbols"><i class="fa fa-check"></i><b>1.3.2</b> Symbols</a></li>
<li class="chapter" data-level="1.3.3" data-path="objects.html"><a href="objects.html#calls"><i class="fa fa-check"></i><b>1.3.3</b> Calls</a></li>
<li class="chapter" data-level="1.3.4" data-path="objects.html"><a href="objects.html#expression"><i class="fa fa-check"></i><b>1.3.4</b> Expression</a></li>
<li class="chapter" data-level="1.3.5" data-path="objects.html"><a href="objects.html#formulas"><i class="fa fa-check"></i><b>1.3.5</b> Formulas</a></li>
<li class="chapter" data-level="1.3.6" data-path="objects.html"><a href="objects.html#not-understand-yet"><i class="fa fa-check"></i><b>1.3.6</b> Not understand yet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vec.html"><a href="vec.html"><i class="fa fa-check"></i><b>2</b> Vectors</a><ul>
<li class="chapter" data-level="2.1" data-path="vec.html"><a href="vec.html#type"><i class="fa fa-check"></i><b>2.1</b> Type</a><ul>
<li class="chapter" data-level="2.1.1" data-path="vec.html"><a href="vec.html#atomic"><i class="fa fa-check"></i><b>2.1.1</b> Atomic</a></li>
<li class="chapter" data-level="2.1.2" data-path="vec.html"><a href="vec.html#list"><i class="fa fa-check"></i><b>2.1.2</b> List</a></li>
<li class="chapter" data-level="2.1.3" data-path="vec.html"><a href="vec.html#check-type-of-vector"><i class="fa fa-check"></i><b>2.1.3</b> Check type of vector</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="vec.html"><a href="vec.html#length"><i class="fa fa-check"></i><b>2.2</b> Length</a></li>
<li class="chapter" data-level="2.3" data-path="vec.html"><a href="vec.html#attributes"><i class="fa fa-check"></i><b>2.3</b> Attributes</a></li>
<li class="chapter" data-level="2.4" data-path="vec.html"><a href="vec.html#vec-factors"><i class="fa fa-check"></i><b>2.4</b> Factors</a></li>
<li class="chapter" data-level="2.5" data-path="vec.html"><a href="vec.html#matricesarrays"><i class="fa fa-check"></i><b>2.5</b> Matrices/Arrays</a></li>
<li class="chapter" data-level="2.6" data-path="vec.html"><a href="vec.html#data-frames"><i class="fa fa-check"></i><b>2.6</b> Data frames</a></li>
<li class="chapter" data-level="2.7" data-path="vec.html"><a href="vec.html#special-values"><i class="fa fa-check"></i><b>2.7</b> Special values</a><ul>
<li class="chapter" data-level="2.7.1" data-path="vec.html"><a href="vec.html#missing-values"><i class="fa fa-check"></i><b>2.7.1</b> Missing values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fun.html"><a href="fun.html"><i class="fa fa-check"></i><b>3</b> Functions</a><ul>
<li class="chapter" data-level="3.1" data-path="fun.html"><a href="fun.html#FunTypes"><i class="fa fa-check"></i><b>3.1</b> Types</a><ul>
<li class="chapter" data-level="3.1.1" data-path="fun.html"><a href="fun.html#primitive-functions"><i class="fa fa-check"></i><b>3.1.1</b> Primitive functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fun.html"><a href="fun.html#function-components"><i class="fa fa-check"></i><b>3.2</b> Function components</a></li>
<li class="chapter" data-level="3.3" data-path="fun.html"><a href="fun.html#function-arguments"><i class="fa fa-check"></i><b>3.3</b> Arguments</a><ul>
<li class="chapter" data-level="3.3.1" data-path="fun.html"><a href="fun.html#lazy-evaluation"><i class="fa fa-check"></i><b>3.3.1</b> Lazy evaluation:</a></li>
<li class="chapter" data-level="3.3.2" data-path="fun.html"><a href="fun.html#elipsis-..."><i class="fa fa-check"></i><b>3.3.2</b> Elipsis <code>...</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="fun.html"><a href="fun.html#function-environment"><i class="fa fa-check"></i><b>3.4</b> Environment</a><ul>
<li class="chapter" data-level="3.4.1" data-path="fun.html"><a href="fun.html#lexical-scoping"><i class="fa fa-check"></i><b>3.4.1</b> Lexical scoping</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="fun.html"><a href="fun.html#return-value"><i class="fa fa-check"></i><b>3.5</b> Return value</a></li>
<li class="chapter" data-level="3.6" data-path="fun.html"><a href="fun.html#special-calls"><i class="fa fa-check"></i><b>3.6</b> Special calls</a></li>
<li class="chapter" data-level="3.7" data-path="fun.html"><a href="fun.html#generic-functions"><i class="fa fa-check"></i><b>3.7</b> Generic functions</a><ul>
<li class="chapter" data-level="3.7.1" data-path="fun.html"><a href="fun.html#s3-and-s4"><i class="fa fa-check"></i><b>3.7.1</b> S3 and S4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="env.html"><a href="env.html"><i class="fa fa-check"></i><b>4</b> Environments</a><ul>
<li class="chapter" data-level="4.1" data-path="env.html"><a href="env.html#general-properties"><i class="fa fa-check"></i><b>4.1</b> General properties</a><ul>
<li class="chapter" data-level="4.1.1" data-path="env.html"><a href="env.html#definition"><i class="fa fa-check"></i><b>4.1.1</b> Definition</a></li>
<li class="chapter" data-level="4.1.2" data-path="env.html"><a href="env.html#attributes-1"><i class="fa fa-check"></i><b>4.1.2</b> Attributes</a></li>
<li class="chapter" data-level="4.1.3" data-path="env.html"><a href="env.html#special-environments"><i class="fa fa-check"></i><b>4.1.3</b> Special environments</a></li>
<li class="chapter" data-level="4.1.4" data-path="env.html"><a href="env.html#search-path-and-search-list"><i class="fa fa-check"></i><b>4.1.4</b> Search path and search list</a></li>
<li class="chapter" data-level="4.1.5" data-path="env.html"><a href="env.html#objects-within-the-environment"><i class="fa fa-check"></i><b>4.1.5</b> Objects within the environment</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="env.html"><a href="env.html#environment-of-functions"><i class="fa fa-check"></i><b>4.2</b> Environment of functions</a></li>
<li class="chapter" data-level="4.3" data-path="env.html"><a href="env.html#packages"><i class="fa fa-check"></i><b>4.3</b> Packages</a><ul>
<li class="chapter" data-level="4.3.1" data-path="env.html"><a href="env.html#package-environment"><i class="fa fa-check"></i><b>4.3.1</b> Package environment</a></li>
<li class="chapter" data-level="4.3.2" data-path="env.html"><a href="env.html#namespace-environment"><i class="fa fa-check"></i><b>4.3.2</b> Namespace environment</a></li>
<li class="chapter" data-level="4.3.3" data-path="env.html"><a href="env.html#imports-environment"><i class="fa fa-check"></i><b>4.3.3</b> Imports environment</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="env.html"><a href="env.html#examples"><i class="fa fa-check"></i><b>4.4</b> Examples</a><ul>
<li class="chapter" data-level="4.4.1" data-path="env.html"><a href="env.html#example-1-pass-object-of-class-acf-to-plot"><i class="fa fa-check"></i><b>4.4.1</b> Example 1: pass object of class “acf” to <code>plot()</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="env.html"><a href="env.html#example-2-search-list-call-stack"><i class="fa fa-check"></i><b>4.4.2</b> Example 2: Search list ≠ call stack</a></li>
<li class="chapter" data-level="4.4.3" data-path="env.html"><a href="env.html#example-3-change-package-function"><i class="fa fa-check"></i><b>4.4.3</b> Example 3: Change package function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="settings.html"><a href="settings.html"><i class="fa fa-check"></i><b>5</b> Settings</a><ul>
<li class="chapter" data-level="5.1" data-path="settings.html"><a href="settings.html#error-language"><i class="fa fa-check"></i><b>5.1</b> Error language</a></li>
<li class="chapter" data-level="5.2" data-path="settings.html"><a href="settings.html#local"><i class="fa fa-check"></i><b>5.2</b> Local</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>6</b> Miscellaneous</a><ul>
<li class="chapter" data-level="6.1" data-path="miscellaneous.html"><a href="miscellaneous.html#how-does-r-save-numbers"><i class="fa fa-check"></i><b>6.1</b> How does R save numbers</a><ul>
<li class="chapter" data-level="6.1.1" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-avoid-problems-with-doubles"><i class="fa fa-check"></i><b>6.1.1</b> How to avoid problems with doubles</a></li>
<li class="chapter" data-level="6.1.2" data-path="miscellaneous.html"><a href="miscellaneous.html#more-interesting-information-about-double-representation"><i class="fa fa-check"></i><b>6.1.2</b> More interesting information about double representation</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="miscellaneous.html"><a href="miscellaneous.html#how-packages-can-exist"><i class="fa fa-check"></i><b>6.2</b> How packages can exist</a></li>
</ul></li>
<li class="part"><span><b>II R Basics</b></span></li>
<li class="chapter" data-level="7" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>7</b> Data Import/Export</a><ul>
<li class="chapter" data-level="7.1" data-path="data-importexport.html"><a href="data-importexport.html#directories"><i class="fa fa-check"></i><b>7.1</b> Directories</a><ul>
<li class="chapter" data-level="7.1.1" data-path="data-importexport.html"><a href="data-importexport.html#functions"><i class="fa fa-check"></i><b>7.1.1</b> Functions</a></li>
<li class="chapter" data-level="7.1.2" data-path="data-importexport.html"><a href="data-importexport.html#path-to-your-file"><i class="fa fa-check"></i><b>7.1.2</b> Path to your file</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-importexport.html"><a href="data-importexport.html#read-data"><i class="fa fa-check"></i><b>7.2</b> Read data</a></li>
<li class="chapter" data-level="7.3" data-path="data-importexport.html"><a href="data-importexport.html#clipboard"><i class="fa fa-check"></i><b>7.3</b> Clipboard</a></li>
<li class="chapter" data-level="7.4" data-path="data-importexport.html"><a href="data-importexport.html#github"><i class="fa fa-check"></i><b>7.4</b> Github</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>8</b> Data handling</a><ul>
<li class="chapter" data-level="8.1" data-path="data-handling.html"><a href="data-handling.html#atomic-vectors"><i class="fa fa-check"></i><b>8.1</b> Atomic vectors</a><ul>
<li class="chapter" data-level="8.1.1" data-path="data-handling.html"><a href="data-handling.html#basic-operations"><i class="fa fa-check"></i><b>8.1.1</b> Basic operations</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-handling.html"><a href="data-handling.html#factors"><i class="fa fa-check"></i><b>8.1.2</b> Factors</a></li>
<li class="chapter" data-level="8.1.3" data-path="data-handling.html"><a href="data-handling.html#date-time"><i class="fa fa-check"></i><b>8.1.3</b> Date Time</a></li>
<li class="chapter" data-level="8.1.4" data-path="data-handling.html"><a href="data-handling.html#strings"><i class="fa fa-check"></i><b>8.1.4</b> Strings</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-handling.html"><a href="data-handling.html#lists"><i class="fa fa-check"></i><b>8.2</b> Lists</a><ul>
<li class="chapter" data-level="8.2.1" data-path="data-handling.html"><a href="data-handling.html#apply-familiy"><i class="fa fa-check"></i><b>8.2.1</b> Apply familiy</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-handling.html"><a href="data-handling.html#long-and-wide-format"><i class="fa fa-check"></i><b>8.2.2</b> Long and wide format</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-handling.html"><a href="data-handling.html#aggregate"><i class="fa fa-check"></i><b>8.2.3</b> Aggregate</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-handling.html"><a href="data-handling.html#sql-joins"><i class="fa fa-check"></i><b>8.2.4</b> SQL joins</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>9</b> Regular expressions</a></li>
<li class="part"><span><b>III R Programming</b></span></li>
<li class="chapter" data-level="10" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>10</b> Basics</a><ul>
<li class="chapter" data-level="10.1" data-path="basics.html"><a href="basics.html#objects-in-enviornment"><i class="fa fa-check"></i><b>10.1</b> Objects in Enviornment</a></li>
<li class="chapter" data-level="10.2" data-path="basics.html"><a href="basics.html#functions-2"><i class="fa fa-check"></i><b>10.2</b> Functions</a><ul>
<li class="chapter" data-level="10.2.1" data-path="basics.html"><a href="basics.html#function-debugging"><i class="fa fa-check"></i><b>10.2.1</b> Function debugging</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="basics.html"><a href="basics.html#control-structures"><i class="fa fa-check"></i><b>10.3</b> Control structures</a><ul>
<li class="chapter" data-level="10.3.1" data-path="basics.html"><a href="basics.html#conditional-statements"><i class="fa fa-check"></i><b>10.3.1</b> Conditional statements</a></li>
<li class="chapter" data-level="10.3.2" data-path="basics.html"><a href="basics.html#loops"><i class="fa fa-check"></i><b>10.3.2</b> Loops</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>11</b> Performance</a><ul>
<li class="chapter" data-level="11.1" data-path="performance.html"><a href="performance.html#in-general"><i class="fa fa-check"></i><b>11.1</b> In general</a></li>
<li class="chapter" data-level="11.2" data-path="performance.html"><a href="performance.html#profiling"><i class="fa fa-check"></i><b>11.2</b> Profiling</a></li>
<li class="chapter" data-level="11.3" data-path="performance.html"><a href="performance.html#microbenchmark"><i class="fa fa-check"></i><b>11.3</b> Microbenchmark</a></li>
<li class="chapter" data-level="11.4" data-path="performance.html"><a href="performance.html#use-package-compiler"><i class="fa fa-check"></i><b>11.4</b> Use package compiler</a></li>
<li class="chapter" data-level="11.5" data-path="performance.html"><a href="performance.html#parallelise"><i class="fa fa-check"></i><b>11.5</b> Parallelise</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="functional-programming.html"><a href="functional-programming.html"><i class="fa fa-check"></i><b>12</b> Functional programming</a><ul>
<li class="chapter" data-level="12.1" data-path="functional-programming.html"><a href="functional-programming.html#FunProgClosures"><i class="fa fa-check"></i><b>12.1</b> Closures</a></li>
<li class="chapter" data-level="12.2" data-path="functional-programming.html"><a href="functional-programming.html#lists-of-functions"><i class="fa fa-check"></i><b>12.2</b> Lists of functions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="r-from-the-shell.html"><a href="r-from-the-shell.html"><i class="fa fa-check"></i><b>13</b> R from the shell</a></li>
<li class="chapter" data-level="14" data-path="use-r-interactively-in-console-linux.html"><a href="use-r-interactively-in-console-linux.html"><i class="fa fa-check"></i><b>14</b> Use R interactively in console (Linux)</a></li>
<li class="chapter" data-level="15" data-path="remote-servers.html"><a href="remote-servers.html"><i class="fa fa-check"></i><b>15</b> Remote Servers</a><ul>
<li class="chapter" data-level="15.1" data-path="remote-servers.html"><a href="remote-servers.html#uzh-thinlinc"><i class="fa fa-check"></i><b>15.1</b> UZH Thinlinc</a></li>
<li class="chapter" data-level="15.2" data-path="remote-servers.html"><a href="remote-servers.html#eth-euler"><i class="fa fa-check"></i><b>15.2</b> ETH Euler</a></li>
<li class="chapter" data-level="15.3" data-path="remote-servers.html"><a href="remote-servers.html#renkulab"><i class="fa fa-check"></i><b>15.3</b> Renkulab</a></li>
<li class="chapter" data-level="15.4" data-path="remote-servers.html"><a href="remote-servers.html#get-notification-when-finished"><i class="fa fa-check"></i><b>15.4</b> Get notification when finished</a><ul>
<li class="chapter" data-level="15.4.1" data-path="remote-servers.html"><a href="remote-servers.html#mail-notification"><i class="fa fa-check"></i><b>15.4.1</b> Mail notification</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV R Output</b></span></li>
<li class="chapter" data-level="16" data-path="Plots.html"><a href="Plots.html"><i class="fa fa-check"></i><b>16</b> Base graphics</a><ul>
<li class="chapter" data-level="16.1" data-path="Plots.html"><a href="Plots.html#graphical-parameters-par"><i class="fa fa-check"></i><b>16.1</b> Graphical parameters <code>par()</code></a><ul>
<li class="chapter" data-level="16.1.1" data-path="Plots.html"><a href="Plots.html#set-graphical-parameters"><i class="fa fa-check"></i><b>16.1.1</b> Set graphical parameters</a></li>
<li class="chapter" data-level="16.1.2" data-path="Plots.html"><a href="Plots.html#default"><i class="fa fa-check"></i><b>16.1.2</b> Default</a></li>
<li class="chapter" data-level="16.1.3" data-path="Plots.html"><a href="Plots.html#device"><i class="fa fa-check"></i><b>16.1.3</b> Device</a></li>
<li class="chapter" data-level="16.1.4" data-path="Plots.html"><a href="Plots.html#device-region"><i class="fa fa-check"></i><b>16.1.4</b> Device region</a></li>
<li class="chapter" data-level="16.1.5" data-path="Plots.html"><a href="Plots.html#coordinate-sytem"><i class="fa fa-check"></i><b>16.1.5</b> Coordinate sytem</a></li>
<li class="chapter" data-level="16.1.6" data-path="Plots.html"><a href="Plots.html#define-device-regions"><i class="fa fa-check"></i><b>16.1.6</b> Define device regions</a></li>
<li class="chapter" data-level="16.1.7" data-path="Plots.html"><a href="Plots.html#user-coordinates-limits"><i class="fa fa-check"></i><b>16.1.7</b> User coordinates limits</a></li>
<li class="chapter" data-level="16.1.8" data-path="Plots.html"><a href="Plots.html#general-appearence"><i class="fa fa-check"></i><b>16.1.8</b> General appearence</a></li>
<li class="chapter" data-level="16.1.9" data-path="Plots.html"><a href="Plots.html#symbols-1"><i class="fa fa-check"></i><b>16.1.9</b> Symbols</a></li>
<li class="chapter" data-level="16.1.10" data-path="Plots.html"><a href="Plots.html#lines"><i class="fa fa-check"></i><b>16.1.10</b> Lines</a></li>
<li class="chapter" data-level="16.1.11" data-path="Plots.html"><a href="Plots.html#text"><i class="fa fa-check"></i><b>16.1.11</b> Text</a></li>
<li class="chapter" data-level="16.1.12" data-path="Plots.html"><a href="Plots.html#axis-labels"><i class="fa fa-check"></i><b>16.1.12</b> Axis labels</a></li>
<li class="chapter" data-level="16.1.13" data-path="Plots.html"><a href="Plots.html#axis"><i class="fa fa-check"></i><b>16.1.13</b> Axis</a></li>
<li class="chapter" data-level="16.1.14" data-path="Plots.html"><a href="Plots.html#ticks"><i class="fa fa-check"></i><b>16.1.14</b> Ticks</a></li>
<li class="chapter" data-level="16.1.15" data-path="Plots.html"><a href="Plots.html#box"><i class="fa fa-check"></i><b>16.1.15</b> Box</a></li>
<li class="chapter" data-level="16.1.16" data-path="Plots.html"><a href="Plots.html#title"><i class="fa fa-check"></i><b>16.1.16</b> Title</a></li>
<li class="chapter" data-level="16.1.17" data-path="Plots.html"><a href="Plots.html#r.o.-read-only"><i class="fa fa-check"></i><b>16.1.17</b> R.O. (Read only)</a></li>
<li class="chapter" data-level="16.1.18" data-path="Plots.html"><a href="Plots.html#useless"><i class="fa fa-check"></i><b>16.1.18</b> Useless</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="Plots.html"><a href="Plots.html#colors"><i class="fa fa-check"></i><b>16.2</b> Colors</a><ul>
<li class="chapter" data-level="16.2.1" data-path="Plots.html"><a href="Plots.html#convert-fromto-different-color-specification"><i class="fa fa-check"></i><b>16.2.1</b> Convert from/to different color specification</a></li>
<li class="chapter" data-level="16.2.2" data-path="Plots.html"><a href="Plots.html#make-new-palettes"><i class="fa fa-check"></i><b>16.2.2</b> Make new palettes</a></li>
<li class="chapter" data-level="16.2.3" data-path="Plots.html"><a href="Plots.html#partially-transparent-colors"><i class="fa fa-check"></i><b>16.2.3</b> Partially transparent colors</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="Plots.html"><a href="Plots.html#mathematical-annotation"><i class="fa fa-check"></i><b>16.3</b> Mathematical annotation</a></li>
<li class="chapter" data-level="16.4" data-path="Plots.html"><a href="Plots.html#high-level-plots"><i class="fa fa-check"></i><b>16.4</b> High level plots</a><ul>
<li class="chapter" data-level="16.4.1" data-path="Plots.html"><a href="Plots.html#plot-function"><i class="fa fa-check"></i><b>16.4.1</b> Plot function</a></li>
<li class="chapter" data-level="16.4.2" data-path="Plots.html"><a href="Plots.html#example-barplot"><i class="fa fa-check"></i><b>16.4.2</b> Example: Barplot</a></li>
<li class="chapter" data-level="16.4.3" data-path="Plots.html"><a href="Plots.html#example-matplot"><i class="fa fa-check"></i><b>16.4.3</b> Example: Matplot</a></li>
<li class="chapter" data-level="16.4.4" data-path="Plots.html"><a href="Plots.html#example-image-and-contour-plot"><i class="fa fa-check"></i><b>16.4.4</b> Example: image and contour plot</a></li>
<li class="chapter" data-level="16.4.5" data-path="Plots.html"><a href="Plots.html#example-boxplot"><i class="fa fa-check"></i><b>16.4.5</b> Example: Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="Plots.html"><a href="Plots.html#low-level-plots"><i class="fa fa-check"></i><b>16.5</b> Low level plots</a><ul>
<li class="chapter" data-level="16.5.1" data-path="Plots.html"><a href="Plots.html#legends"><i class="fa fa-check"></i><b>16.5.1</b> Legends</a></li>
<li class="chapter" data-level="16.5.2" data-path="Plots.html"><a href="Plots.html#arrow"><i class="fa fa-check"></i><b>16.5.2</b> Arrow</a></li>
<li class="chapter" data-level="16.5.3" data-path="Plots.html"><a href="Plots.html#panel.first"><i class="fa fa-check"></i><b>16.5.3</b> panel.first</a></li>
<li class="chapter" data-level="16.5.4" data-path="Plots.html"><a href="Plots.html#area-under-curve"><i class="fa fa-check"></i><b>16.5.4</b> Area under curve</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="Plots.html"><a href="Plots.html#plot-math-coordinate-system"><i class="fa fa-check"></i><b>16.6</b> Plot Math Coordinate System</a></li>
<li class="chapter" data-level="16.7" data-path="Plots.html"><a href="Plots.html#plot-empty"><i class="fa fa-check"></i><b>16.7</b> Plot empty</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="interactive-plots.html"><a href="interactive-plots.html"><i class="fa fa-check"></i><b>17</b> Interactive Plots</a></li>
<li class="chapter" data-level="18" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>18</b> ggplot</a><ul>
<li class="chapter" data-level="18.1" data-path="ggplot.html"><a href="ggplot.html#aesthetic-mappings-aes"><i class="fa fa-check"></i><b>18.1</b> Aesthetic mappings <code>aes</code></a></li>
<li class="chapter" data-level="18.2" data-path="ggplot.html"><a href="ggplot.html#goemetric-objects-geoms"><i class="fa fa-check"></i><b>18.2</b> Goemetric objects <code>geoms</code></a></li>
<li class="chapter" data-level="18.3" data-path="ggplot.html"><a href="ggplot.html#statistical-transformations-stat"><i class="fa fa-check"></i><b>18.3</b> Statistical transformations <code>stat</code></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="text-output.html"><a href="text-output.html"><i class="fa fa-check"></i><b>19</b> Text output</a><ul>
<li class="chapter" data-level="19.1" data-path="text-output.html"><a href="text-output.html#format"><i class="fa fa-check"></i><b>19.1</b> Format</a></li>
<li class="chapter" data-level="19.2" data-path="text-output.html"><a href="text-output.html#new-lines"><i class="fa fa-check"></i><b>19.2</b> New lines</a></li>
</ul></li>
<li class="part"><span><b>V R Statistics</b></span></li>
<li class="chapter" data-level="20" data-path="topics.html"><a href="topics.html"><i class="fa fa-check"></i><b>20</b> Topics</a></li>
<li class="chapter" data-level="21" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>21</b> Basic Statistics</a><ul>
<li class="chapter" data-level="21.1" data-path="basic-statistics.html"><a href="basic-statistics.html#distributions"><i class="fa fa-check"></i><b>21.1</b> Distributions</a><ul>
<li class="chapter" data-level="21.1.1" data-path="basic-statistics.html"><a href="basic-statistics.html#relationships-between-distributions"><i class="fa fa-check"></i><b>21.1.1</b> Relationships between distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>22</b> Regression</a><ul>
<li class="chapter" data-level="22.1" data-path="regression.html"><a href="regression.html#preperation"><i class="fa fa-check"></i><b>22.1</b> Preperation</a></li>
<li class="chapter" data-level="22.2" data-path="regression.html"><a href="regression.html#fit"><i class="fa fa-check"></i><b>22.2</b> Fit</a></li>
<li class="chapter" data-level="22.3" data-path="regression.html"><a href="regression.html#inference"><i class="fa fa-check"></i><b>22.3</b> Inference</a></li>
<li class="chapter" data-level="22.4" data-path="regression.html"><a href="regression.html#prediction"><i class="fa fa-check"></i><b>22.4</b> Prediction</a></li>
<li class="chapter" data-level="22.5" data-path="regression.html"><a href="regression.html#plot-regression"><i class="fa fa-check"></i><b>22.5</b> Plot regression</a></li>
<li class="chapter" data-level="22.6" data-path="regression.html"><a href="regression.html#model-comparison"><i class="fa fa-check"></i><b>22.6</b> Model comparison</a></li>
<li class="chapter" data-level="22.7" data-path="regression.html"><a href="regression.html#diagnostic-plots"><i class="fa fa-check"></i><b>22.7</b> Diagnostic plots</a><ul>
<li class="chapter" data-level="22.7.1" data-path="regression.html"><a href="regression.html#tukey-anscombe-plot"><i class="fa fa-check"></i><b>22.7.1</b> Tukey-Anscombe plot</a></li>
<li class="chapter" data-level="22.7.2" data-path="regression.html"><a href="regression.html#normal-qq-plot"><i class="fa fa-check"></i><b>22.7.2</b> Normal QQ plot</a></li>
<li class="chapter" data-level="22.7.3" data-path="regression.html"><a href="regression.html#scale-location-plot"><i class="fa fa-check"></i><b>22.7.3</b> Scale-Location plot</a></li>
<li class="chapter" data-level="22.7.4" data-path="regression.html"><a href="regression.html#leverage-plot"><i class="fa fa-check"></i><b>22.7.4</b> Leverage plot</a></li>
<li class="chapter" data-level="22.7.5" data-path="regression.html"><a href="regression.html#residuals-vs-any"><i class="fa fa-check"></i><b>22.7.5</b> Residuals vs any</a></li>
<li class="chapter" data-level="22.7.6" data-path="regression.html"><a href="regression.html#partial-residual-plot"><i class="fa fa-check"></i><b>22.7.6</b> Partial residual plot</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="regression.html"><a href="regression.html#model-improvement"><i class="fa fa-check"></i><b>22.8</b> Model improvement</a><ul>
<li class="chapter" data-level="22.8.1" data-path="regression.html"><a href="regression.html#multicollinearity"><i class="fa fa-check"></i><b>22.8.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="22.8.2" data-path="regression.html"><a href="regression.html#aicbic"><i class="fa fa-check"></i><b>22.8.2</b> AIC/BIC</a></li>
<li class="chapter" data-level="22.8.3" data-path="regression.html"><a href="regression.html#variable-selection"><i class="fa fa-check"></i><b>22.8.3</b> Variable selection</a></li>
<li class="chapter" data-level="22.8.4" data-path="regression.html"><a href="regression.html#predictor-relevance"><i class="fa fa-check"></i><b>22.8.4</b> Predictor relevance</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="regression.html"><a href="regression.html#shrinkage"><i class="fa fa-check"></i><b>22.9</b> Shrinkage</a></li>
<li class="chapter" data-level="22.10" data-path="regression.html"><a href="regression.html#smoothing"><i class="fa fa-check"></i><b>22.10</b> Smoothing</a><ul>
<li class="chapter" data-level="22.10.1" data-path="regression.html"><a href="regression.html#running-mean-yellow-box"><i class="fa fa-check"></i><b>22.10.1</b> Running mean (yellow box)</a></li>
<li class="chapter" data-level="22.10.2" data-path="regression.html"><a href="regression.html#gaussian-kernel-estimate-green-gaussian"><i class="fa fa-check"></i><b>22.10.2</b> Gaussian kernel estimate (green gaussian)</a></li>
<li class="chapter" data-level="22.10.3" data-path="regression.html"><a href="regression.html#loess-smoother"><i class="fa fa-check"></i><b>22.10.3</b> LOESS smoother</a></li>
</ul></li>
<li class="chapter" data-level="22.11" data-path="regression.html"><a href="regression.html#gam"><i class="fa fa-check"></i><b>22.11</b> GAM</a></li>
<li class="chapter" data-level="22.12" data-path="regression.html"><a href="regression.html#glm"><i class="fa fa-check"></i><b>22.12</b> GLM</a><ul>
<li class="chapter" data-level="22.12.1" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>22.12.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="22.12.2" data-path="regression.html"><a href="regression.html#poisson-regression"><i class="fa fa-check"></i><b>22.12.2</b> Poisson Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>23</b> ANOVA</a><ul>
<li class="chapter" data-level="23.1" data-path="anova.html"><a href="anova.html#idea"><i class="fa fa-check"></i><b>23.1</b> Idea</a></li>
<li class="chapter" data-level="23.2" data-path="anova.html"><a href="anova.html#example-1"><i class="fa fa-check"></i><b>23.2</b> Example</a></li>
<li class="chapter" data-level="23.3" data-path="anova.html"><a href="anova.html#simulate-data"><i class="fa fa-check"></i><b>23.3</b> Simulate data</a><ul>
<li class="chapter" data-level="23.3.1" data-path="anova.html"><a href="anova.html#randomization"><i class="fa fa-check"></i><b>23.3.1</b> Randomization</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="anova.html"><a href="anova.html#visualization-2"><i class="fa fa-check"></i><b>23.4</b> Visualization</a><ul>
<li class="chapter" data-level="23.4.1" data-path="anova.html"><a href="anova.html#stripchart"><i class="fa fa-check"></i><b>23.4.1</b> Stripchart</a></li>
<li class="chapter" data-level="23.4.2" data-path="anova.html"><a href="anova.html#boxplot"><i class="fa fa-check"></i><b>23.4.2</b> Boxplot</a></li>
<li class="chapter" data-level="23.4.3" data-path="anova.html"><a href="anova.html#interaction-plot"><i class="fa fa-check"></i><b>23.4.3</b> Interaction plot</a></li>
<li class="chapter" data-level="23.4.4" data-path="anova.html"><a href="anova.html#summary-plot"><i class="fa fa-check"></i><b>23.4.4</b> Summary plot</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="anova.html"><a href="anova.html#fit-model"><i class="fa fa-check"></i><b>23.5</b> Fit model</a><ul>
<li class="chapter" data-level="23.5.1" data-path="anova.html"><a href="anova.html#identifiability"><i class="fa fa-check"></i><b>23.5.1</b> Identifiability</a></li>
<li class="chapter" data-level="23.5.2" data-path="anova.html"><a href="anova.html#fitting-2"><i class="fa fa-check"></i><b>23.5.2</b> Fitting</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="anova.html"><a href="anova.html#anova-table"><i class="fa fa-check"></i><b>23.6</b> ANOVA table</a><ul>
<li class="chapter" data-level="23.6.1" data-path="anova.html"><a href="anova.html#types-of-sum-of-sqares"><i class="fa fa-check"></i><b>23.6.1</b> Types of Sum of Sqares</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="anova.html"><a href="anova.html#model-comparison-2"><i class="fa fa-check"></i><b>23.7</b> Model comparison</a></li>
<li class="chapter" data-level="23.8" data-path="anova.html"><a href="anova.html#coefficients"><i class="fa fa-check"></i><b>23.8</b> Coefficients</a></li>
<li class="chapter" data-level="23.9" data-path="anova.html"><a href="anova.html#tests-and-ci-for-coeficients"><i class="fa fa-check"></i><b>23.9</b> Tests and CI for coeficients</a></li>
<li class="chapter" data-level="23.10" data-path="anova.html"><a href="anova.html#predict"><i class="fa fa-check"></i><b>23.10</b> Predict</a></li>
<li class="chapter" data-level="23.11" data-path="anova.html"><a href="anova.html#diagnostic-plots-1"><i class="fa fa-check"></i><b>23.11</b> Diagnostic plots</a><ul>
<li class="chapter" data-level="23.11.1" data-path="anova.html"><a href="anova.html#simulations"><i class="fa fa-check"></i><b>23.11.1</b> Simulations</a></li>
<li class="chapter" data-level="23.11.2" data-path="anova.html"><a href="anova.html#qq-plot-in-mixed-models"><i class="fa fa-check"></i><b>23.11.2</b> QQ plot in mixed models</a></li>
</ul></li>
<li class="chapter" data-level="23.12" data-path="anova.html"><a href="anova.html#contrasts"><i class="fa fa-check"></i><b>23.12</b> Contrasts</a><ul>
<li class="chapter" data-level="23.12.1" data-path="anova.html"><a href="anova.html#test-contrast"><i class="fa fa-check"></i><b>23.12.1</b> Test contrast</a></li>
</ul></li>
<li class="chapter" data-level="23.13" data-path="anova.html"><a href="anova.html#multiple-comparison"><i class="fa fa-check"></i><b>23.13</b> Multiple comparison</a><ul>
<li class="chapter" data-level="23.13.1" data-path="anova.html"><a href="anova.html#bonferroni-holm-planned-contrasts"><i class="fa fa-check"></i><b>23.13.1</b> Bonferroni Holm (Planned contrasts)</a></li>
<li class="chapter" data-level="23.13.2" data-path="anova.html"><a href="anova.html#scheffe-unplanned-contrasts"><i class="fa fa-check"></i><b>23.13.2</b> Scheffe (Unplanned contrasts)</a></li>
<li class="chapter" data-level="23.13.3" data-path="anova.html"><a href="anova.html#tukey-hsd-all-pairwise-comparisons"><i class="fa fa-check"></i><b>23.13.3</b> Tukey HSD (All pairwise comparisons)</a></li>
<li class="chapter" data-level="23.13.4" data-path="anova.html"><a href="anova.html#dunnett-comparison-with-control"><i class="fa fa-check"></i><b>23.13.4</b> Dunnett (Comparison with control)</a></li>
</ul></li>
<li class="chapter" data-level="23.14" data-path="anova.html"><a href="anova.html#designs"><i class="fa fa-check"></i><b>23.14</b> Designs</a><ul>
<li class="chapter" data-level="23.14.1" data-path="anova.html"><a href="anova.html#factorial-design"><i class="fa fa-check"></i><b>23.14.1</b> Factorial design</a></li>
<li class="chapter" data-level="23.14.2" data-path="anova.html"><a href="anova.html#mixed-models"><i class="fa fa-check"></i><b>23.14.2</b> Mixed models</a></li>
<li class="chapter" data-level="23.14.3" data-path="anova.html"><a href="anova.html#nested-model"><i class="fa fa-check"></i><b>23.14.3</b> Nested model</a></li>
<li class="chapter" data-level="23.14.4" data-path="anova.html"><a href="anova.html#split-plot"><i class="fa fa-check"></i><b>23.14.4</b> Split plot</a></li>
<li class="chapter" data-level="23.14.5" data-path="anova.html"><a href="anova.html#incomplete-block-designs"><i class="fa fa-check"></i><b>23.14.5</b> Incomplete Block designs</a></li>
</ul></li>
<li class="chapter" data-level="23.15" data-path="anova.html"><a href="anova.html#power-analysis"><i class="fa fa-check"></i><b>23.15</b> Power Analysis</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="MultivarStat.html"><a href="MultivarStat.html"><i class="fa fa-check"></i><b>24</b> Multivariate Statistics</a><ul>
<li class="chapter" data-level="24.1" data-path="MultivarStat.html"><a href="MultivarStat.html#data-sets"><i class="fa fa-check"></i><b>24.1</b> Data sets</a></li>
<li class="chapter" data-level="24.2" data-path="MultivarStat.html"><a href="MultivarStat.html#some-functions"><i class="fa fa-check"></i><b>24.2</b> Some functions</a><ul>
<li class="chapter" data-level="24.2.1" data-path="MultivarStat.html"><a href="MultivarStat.html#visualization-3"><i class="fa fa-check"></i><b>24.2.1</b> Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="TimeSeries.html"><a href="TimeSeries.html"><i class="fa fa-check"></i><b>25</b> Time series</a><ul>
<li class="chapter" data-level="25.1" data-path="TimeSeries.html"><a href="TimeSeries.html#data-sets-1"><i class="fa fa-check"></i><b>25.1</b> Data sets</a></li>
<li class="chapter" data-level="25.2" data-path="TimeSeries.html"><a href="TimeSeries.html#date-and-time"><i class="fa fa-check"></i><b>25.2</b> Date and Time</a><ul>
<li class="chapter" data-level="25.2.1" data-path="TimeSeries.html"><a href="TimeSeries.html#date"><i class="fa fa-check"></i><b>25.2.1</b> Date</a></li>
<li class="chapter" data-level="25.2.2" data-path="TimeSeries.html"><a href="TimeSeries.html#date-time-1"><i class="fa fa-check"></i><b>25.2.2</b> Date-Time</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="TimeSeries.html"><a href="TimeSeries.html#time-series-classes"><i class="fa fa-check"></i><b>25.3</b> Time series classes</a><ul>
<li class="chapter" data-level="25.3.1" data-path="TimeSeries.html"><a href="TimeSeries.html#ts"><i class="fa fa-check"></i><b>25.3.1</b> ts</a></li>
<li class="chapter" data-level="25.3.2" data-path="TimeSeries.html"><a href="TimeSeries.html#zoo"><i class="fa fa-check"></i><b>25.3.2</b> zoo</a></li>
<li class="chapter" data-level="25.3.3" data-path="TimeSeries.html"><a href="TimeSeries.html#futher-classes"><i class="fa fa-check"></i><b>25.3.3</b> futher classes</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="TimeSeries.html"><a href="TimeSeries.html#differencing"><i class="fa fa-check"></i><b>25.4</b> Differencing</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html"><i class="fa fa-check"></i><b>26</b> Computational statistics</a><ul>
<li class="chapter" data-level="26.1" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html#cross-validation"><i class="fa fa-check"></i><b>26.1</b> Cross validation</a></li>
<li class="chapter" data-level="26.2" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html#k-nearest-neighbor"><i class="fa fa-check"></i><b>26.2</b> k nearest neighbor</a></li>
<li class="chapter" data-level="26.3" data-path="Computational-Statistics.html"><a href="Computational-Statistics.html#bootstrap"><i class="fa fa-check"></i><b>26.3</b> Bootstrap</a></li>
</ul></li>
<li class="part"><span><b>VI R Workflow</b></span></li>
<li class="chapter" data-level="27" data-path="reproducible-research.html"><a href="reproducible-research.html"><i class="fa fa-check"></i><b>27</b> Reproducible Research</a><ul>
<li class="chapter" data-level="27.1" data-path="reproducible-research.html"><a href="reproducible-research.html#tasks"><i class="fa fa-check"></i><b>27.1</b> Tasks</a></li>
<li class="chapter" data-level="27.2" data-path="reproducible-research.html"><a href="reproducible-research.html#chronology"><i class="fa fa-check"></i><b>27.2</b> Chronology</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="r-studio.html"><a href="r-studio.html"><i class="fa fa-check"></i><b>28</b> R Studio</a><ul>
<li class="chapter" data-level="28.1" data-path="r-studio.html"><a href="r-studio.html#shortcuts"><i class="fa fa-check"></i><b>28.1</b> Shortcuts</a></li>
<li class="chapter" data-level="28.2" data-path="r-studio.html"><a href="r-studio.html#version-control-in-rstudio"><i class="fa fa-check"></i><b>28.2</b> Version Control in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="literate-programming.html"><a href="literate-programming.html"><i class="fa fa-check"></i><b>29</b> Literate programming</a><ul>
<li class="chapter" data-level="29.1" data-path="literate-programming.html"><a href="literate-programming.html#sweave"><i class="fa fa-check"></i><b>29.1</b> Sweave</a></li>
<li class="chapter" data-level="29.2" data-path="literate-programming.html"><a href="literate-programming.html#knitr"><i class="fa fa-check"></i><b>29.2</b> Knitr</a></li>
<li class="chapter" data-level="29.3" data-path="literate-programming.html"><a href="literate-programming.html#r-markdown"><i class="fa fa-check"></i><b>29.3</b> R Markdown</a></li>
<li class="chapter" data-level="29.4" data-path="literate-programming.html"><a href="literate-programming.html#basic-elements-of-latex-and-r-markdown"><i class="fa fa-check"></i><b>29.4</b> Basic Elements of Latex and R Markdown</a></li>
<li class="chapter" data-level="29.5" data-path="literate-programming.html"><a href="literate-programming.html#templates"><i class="fa fa-check"></i><b>29.5</b> Templates</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="latex.html"><a href="latex.html"><i class="fa fa-check"></i><b>30</b> Latex</a><ul>
<li class="chapter" data-level="30.1" data-path="latex.html"><a href="latex.html#symbols-2"><i class="fa fa-check"></i><b>30.1</b> Symbols</a></li>
<li class="chapter" data-level="30.2" data-path="latex.html"><a href="latex.html#important"><i class="fa fa-check"></i><b>30.2</b> Important</a></li>
<li class="chapter" data-level="30.3" data-path="latex.html"><a href="latex.html#reto-math"><i class="fa fa-check"></i><b>30.3</b> Reto Math</a></li>
<li class="chapter" data-level="30.4" data-path="latex.html"><a href="latex.html#sfs"><i class="fa fa-check"></i><b>30.4</b> SfS</a></li>
<li class="chapter" data-level="30.5" data-path="latex.html"><a href="latex.html#constructs"><i class="fa fa-check"></i><b>30.5</b> Constructs</a></li>
<li class="chapter" data-level="30.6" data-path="latex.html"><a href="latex.html#text-format"><i class="fa fa-check"></i><b>30.6</b> Text format</a></li>
<li class="chapter" data-level="30.7" data-path="latex.html"><a href="latex.html#math-environments"><i class="fa fa-check"></i><b>30.7</b> Math environments</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="reference-management.html"><a href="reference-management.html"><i class="fa fa-check"></i><b>31</b> Reference management</a><ul>
<li class="chapter" data-level="31.1" data-path="reference-management.html"><a href="reference-management.html#literature"><i class="fa fa-check"></i><b>31.1</b> Literature</a><ul>
<li class="chapter" data-level="31.1.1" data-path="reference-management.html"><a href="reference-management.html#recommended-using-zotero"><i class="fa fa-check"></i><b>31.1.1</b> Recommended: Using Zotero</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="reference-management.html"><a href="reference-management.html#cross-references"><i class="fa fa-check"></i><b>31.2</b> Cross-References</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="r-markdown-1.html"><a href="r-markdown-1.html"><i class="fa fa-check"></i><b>32</b> R Markdown</a><ul>
<li class="chapter" data-level="32.1" data-path="r-markdown-1.html"><a href="r-markdown-1.html#components-1"><i class="fa fa-check"></i><b>32.1</b> Components</a><ul>
<li class="chapter" data-level="32.1.1" data-path="r-markdown-1.html"><a href="r-markdown-1.html#yaml-frontmatter"><i class="fa fa-check"></i><b>32.1.1</b> YAML frontmatter</a></li>
<li class="chapter" data-level="32.1.2" data-path="r-markdown-1.html"><a href="r-markdown-1.html#text-1"><i class="fa fa-check"></i><b>32.1.2</b> Text</a></li>
<li class="chapter" data-level="32.1.3" data-path="r-markdown-1.html"><a href="r-markdown-1.html#code"><i class="fa fa-check"></i><b>32.1.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="32.2" data-path="r-markdown-1.html"><a href="r-markdown-1.html#figures"><i class="fa fa-check"></i><b>32.2</b> Figures</a></li>
<li class="chapter" data-level="32.3" data-path="r-markdown-1.html"><a href="r-markdown-1.html#tables"><i class="fa fa-check"></i><b>32.3</b> Tables</a><ul>
<li class="chapter" data-level="32.3.1" data-path="r-markdown-1.html"><a href="r-markdown-1.html#html-tables"><i class="fa fa-check"></i><b>32.3.1</b> HTML tables</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="r-markdown-1.html"><a href="r-markdown-1.html#math"><i class="fa fa-check"></i><b>32.4</b> Math</a></li>
<li class="chapter" data-level="32.5" data-path="r-markdown-1.html"><a href="r-markdown-1.html#special-characters"><i class="fa fa-check"></i><b>32.5</b> Special characters</a></li>
<li class="chapter" data-level="32.6" data-path="r-markdown-1.html"><a href="r-markdown-1.html#section-folding"><i class="fa fa-check"></i><b>32.6</b> Section folding</a></li>
<li class="chapter" data-level="32.7" data-path="r-markdown-1.html"><a href="r-markdown-1.html#add-box"><i class="fa fa-check"></i><b>32.7</b> Add box</a></li>
<li class="chapter" data-level="32.8" data-path="r-markdown-1.html"><a href="r-markdown-1.html#template"><i class="fa fa-check"></i><b>32.8</b> Template</a></li>
<li class="chapter" data-level="32.9" data-path="r-markdown-1.html"><a href="r-markdown-1.html#good-output-formats"><i class="fa fa-check"></i><b>32.9</b> Good output formats</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>33</b> Bookdown</a><ul>
<li class="chapter" data-level="33.1" data-path="bookdown.html"><a href="bookdown.html#configuration"><i class="fa fa-check"></i><b>33.1</b> Configuration</a><ul>
<li class="chapter" data-level="33.1.1" data-path="bookdown.html"><a href="bookdown.html#bookdown.yml"><i class="fa fa-check"></i><b>33.1.1</b> <code>_bookdown.yml</code></a></li>
<li class="chapter" data-level="33.1.2" data-path="bookdown.html"><a href="bookdown.html#output.yml"><i class="fa fa-check"></i><b>33.1.2</b> <code>_output.yml</code></a></li>
<li class="chapter" data-level="33.1.3" data-path="bookdown.html"><a href="bookdown.html#yaml-header"><i class="fa fa-check"></i><b>33.1.3</b> yaml header</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="bookdown.html"><a href="bookdown.html#NewBookdownProject"><i class="fa fa-check"></i><b>33.2</b> Create new project</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="git-version-control.html"><a href="git-version-control.html"><i class="fa fa-check"></i><b>34</b> Git version control</a><ul>
<li class="chapter" data-level="34.1" data-path="git-version-control.html"><a href="git-version-control.html#bash-basics"><i class="fa fa-check"></i><b>34.1</b> Bash basics</a></li>
<li class="chapter" data-level="34.2" data-path="git-version-control.html"><a href="git-version-control.html#git-basics"><i class="fa fa-check"></i><b>34.2</b> Git basics</a></li>
<li class="chapter" data-level="34.3" data-path="git-version-control.html"><a href="git-version-control.html#global-config"><i class="fa fa-check"></i><b>34.3</b> Global config</a></li>
<li class="chapter" data-level="34.4" data-path="git-version-control.html"><a href="git-version-control.html#ssh-keys"><i class="fa fa-check"></i><b>34.4</b> SSH keys</a></li>
<li class="chapter" data-level="34.5" data-path="git-version-control.html"><a href="git-version-control.html#common-tasks"><i class="fa fa-check"></i><b>34.5</b> Common tasks</a></li>
<li class="chapter" data-level="34.6" data-path="git-version-control.html"><a href="git-version-control.html#single-user"><i class="fa fa-check"></i><b>34.6</b> Single user</a><ul>
<li class="chapter" data-level="34.6.1" data-path="git-version-control.html"><a href="git-version-control.html#regular-workflow"><i class="fa fa-check"></i><b>34.6.1</b> Regular workflow</a></li>
<li class="chapter" data-level="34.6.2" data-path="git-version-control.html"><a href="git-version-control.html#troubleshooting"><i class="fa fa-check"></i><b>34.6.2</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="34.7" data-path="git-version-control.html"><a href="git-version-control.html#multiple-users"><i class="fa fa-check"></i><b>34.7</b> Multiple users</a><ul>
<li class="chapter" data-level="34.7.1" data-path="git-version-control.html"><a href="git-version-control.html#get-foreign-respository-fork"><i class="fa fa-check"></i><b>34.7.1</b> get foreign respository (fork)</a></li>
</ul></li>
<li class="chapter" data-level="34.8" data-path="git-version-control.html"><a href="git-version-control.html#version-control-in-rstudio-1"><i class="fa fa-check"></i><b>34.8</b> Version Control in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="git2.html"><a href="git2.html"><i class="fa fa-check"></i><b>35</b> git2</a><ul>
<li class="chapter" data-level="35.1" data-path="git2.html"><a href="git2.html#common-tasks-1"><i class="fa fa-check"></i><b>35.1</b> Common tasks</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="packages-1.html"><a href="packages-1.html"><i class="fa fa-check"></i><b>36</b> Packages</a><ul>
<li class="chapter" data-level="36.1" data-path="packages-1.html"><a href="packages-1.html#package-environment-1"><i class="fa fa-check"></i><b>36.1</b> Package environment</a></li>
<li class="chapter" data-level="36.2" data-path="packages-1.html"><a href="packages-1.html#useful-packages"><i class="fa fa-check"></i><b>36.2</b> Useful packages</a></li>
</ul></li>
<li class="part"><span><b>VII Appendix</b></span></li>
<li class="chapter" data-level="37" data-path="cheat-sheets.html"><a href="cheat-sheets.html"><i class="fa fa-check"></i><b>37</b> Cheat sheets</a><ul>
<li class="chapter" data-level="37.1" data-path="cheat-sheets.html"><a href="cheat-sheets.html#data-import"><i class="fa fa-check"></i><b>37.1</b> Data import</a></li>
<li class="chapter" data-level="37.2" data-path="cheat-sheets.html"><a href="cheat-sheets.html#data-transformation"><i class="fa fa-check"></i><b>37.2</b> Data transformation</a></li>
<li class="chapter" data-level="37.3" data-path="cheat-sheets.html"><a href="cheat-sheets.html#data-visualization"><i class="fa fa-check"></i><b>37.3</b> Data visualization</a></li>
<li class="chapter" data-level="37.4" data-path="cheat-sheets.html"><a href="cheat-sheets.html#factors-1"><i class="fa fa-check"></i><b>37.4</b> Factors</a></li>
<li class="chapter" data-level="37.5" data-path="cheat-sheets.html"><a href="cheat-sheets.html#lubridate"><i class="fa fa-check"></i><b>37.5</b> Lubridate</a></li>
<li class="chapter" data-level="37.6" data-path="cheat-sheets.html"><a href="cheat-sheets.html#strings-1"><i class="fa fa-check"></i><b>37.6</b> Strings</a></li>
<li class="chapter" data-level="37.7" data-path="cheat-sheets.html"><a href="cheat-sheets.html#regex"><i class="fa fa-check"></i><b>37.7</b> Regex</a></li>
<li class="chapter" data-level="37.8" data-path="cheat-sheets.html"><a href="cheat-sheets.html#purrr"><i class="fa fa-check"></i><b>37.8</b> Purrr</a></li>
<li class="chapter" data-level="37.9" data-path="cheat-sheets.html"><a href="cheat-sheets.html#tidyeval"><i class="fa fa-check"></i><b>37.9</b> Tidyeval</a></li>
<li class="chapter" data-level="37.10" data-path="cheat-sheets.html"><a href="cheat-sheets.html#r-studio-1"><i class="fa fa-check"></i><b>37.10</b> R Studio</a></li>
<li class="chapter" data-level="37.11" data-path="cheat-sheets.html"><a href="cheat-sheets.html#r-markdown-2"><i class="fa fa-check"></i><b>37.11</b> R markdown</a></li>
<li class="chapter" data-level="37.12" data-path="cheat-sheets.html"><a href="cheat-sheets.html#shiny"><i class="fa fa-check"></i><b>37.12</b> Shiny</a></li>
<li class="chapter" data-level="37.13" data-path="cheat-sheets.html"><a href="cheat-sheets.html#package-development"><i class="fa fa-check"></i><b>37.13</b> Package development</a></li>
<li class="chapter" data-level="37.14" data-path="cheat-sheets.html"><a href="cheat-sheets.html#reticulate"><i class="fa fa-check"></i><b>37.14</b> Reticulate</a></li>
<li class="chapter" data-level="37.15" data-path="cheat-sheets.html"><a href="cheat-sheets.html#keras"><i class="fa fa-check"></i><b>37.15</b> Keras</a></li>
<li class="chapter" data-level="37.16" data-path="cheat-sheets.html"><a href="cheat-sheets.html#sparklyr"><i class="fa fa-check"></i><b>37.16</b> Sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i><b>38</b> Test</a></li>
<li class="chapter" data-level="39" data-path="stuff-still-to-include.html"><a href="stuff-still-to-include.html"><i class="fa fa-check"></i><b>39</b> Stuff still to include</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Reference book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<p style="visibility:hidden;">% Tag useful such that part is included but already hidden even before rendering of MathJax
\(
\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}

% Operators
\newcommand{\tr}{{}^{\intercal}}               % transpose (needs amssymb)
\newcommand{\inv}{^{-1}}                       % inverse
\renewcommand{\d}[1]{\ensuremath{\operatorname{d}\!{#1}}}  % dx
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}           % L2 Norm
\DeclareMathOperator*{\argmin}{arg\, min}
\DeclareMathOperator*{\argmax}{arg\, max}
\DeclareMathOperator{\diag}{diag}

\newcommand{\E}{\mathbf{E}}  % Depreciated: delete as soon as possible... Use \ERW{}

% Matrix
\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}  % big zero in matrix
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}} % vertical bar to separate matrix

% SfS stuff
\newcommand{\iid}{\mbox{ i.i.d. }}
\newcommand{\Xsub}[2]{{#1}_{\mathrm{\scriptscriptstyle #2}}}
\newcommand{\wh}[1]{{}\kern0.1em\widehat{\kern-0.1em#1}{}}

\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Cor}{Corr}

\newcommand{\ekl}{[}     % Erwartungswert Klammer links
\newcommand{\ekr}{]}     % Erwartungswert Klammer rechts
\newcommand{\ckl}{(}     % (Co)variance Klammer links
\newcommand{\ckr}{)}
\newcommand{\pkl}{(}     % Probability Klammer links
\newcommand{\pkr}{)}
\newcommand{\vkl}{(}     % Verteilungs Klammer links
\newcommand{\vkr}{)}

\newcommand{\ERWSymbol}{\mathbf{E}}  % vorbereitet zum Anpassen an individuelle Styles
\newcommand{\VARSymbol}{\Var}
\newcommand{\COVSymbol}{\Cov}
\newcommand{\CORSymbol}{\Cor}
\DeclareMathOperator{\PRSymbol}{P}
\newcommand{\NormalSymbol}{\mathcal{N}}
\DeclareMathOperator{\BinomialSymbol}{\mathcal{B}} % Binomial
\DeclareMathOperator{\BernoulliSymbol}{\mathcal{B}ernoulli} % Bernoulli
\DeclareMathOperator{\ExponentialSymbol}{Exp}
\DeclareMathOperator{\PoissonSymbol}{Pois}

% die eigentlichen ``Funktionen''
\newcommand{\ERW}[1] {\ERWSymbol \left[ #1 \right]}
\newcommand{\VAR}[1] {\VARSymbol \left( #1 \right)}
\newcommand{\VARH}[1]{\wh\VARSymbol \left( #1 \right)}

\newcommand{\COV}[1] {\COVSymbol \left(#1 \right)}
\newcommand{\COVH}[1] {\wh\COVSymbol \left( #1 \right)}
\newcommand{\COR}[1] {\CORSymbol    \left( #1 \right)}
\newcommand{\CORH}[1] {\wh\CORSymbol \left( #1 \right)}
\newcommand{\PR}[1] {\PRSymbol \! \left( #1 \right)}
\newcommand{\Normal}[1] {\NormalSymbol   \left( #1 \right)}
\newcommand{\Binomial}[1] {\BinomialSymbol    \left( #1 \right)}
\newcommand{\Bernoulli}[1] {\BernoulliSymbol    \left( #1 \right)}
\newcommand{\Exponential}[1] {\ExponentialSymbol    \left( #1 \right)}
\newcommand{\Poisson}[1] {\PoissonSymbol   \left( #1 \right)}

\newcommand{\ERWi}[2]  {\Xsub{\ERWSymbol}{#1}    \left[ #2
    \right]}
\newcommand{\VARi}[2]  {\Xsub{\VARSymbol}{#1}    \left( #2
    \right)}
\newcommand{\VARHi}[2] {\Xsub{\wh\VARSymbol}{#1} \left( #2
    \right)}
\newcommand{\COVi}[2]  {\Xsub{\COVSymbol}{#1}    \left( #2
    \right)}
\newcommand{\COVHi}[2] {\Xsub{\wh\COVSymbol}{#1} \left( #2
    \right)}
\newcommand{\CORi}[2]  {\Xsub{\CORSymbol}{#1}    \left( #2
    \right)}
\newcommand{\CORHi}[2] {\Xsub{\wh\CORSymbol}{#1} \left( #2
    \right)}
\newcommand{\PRi}[2]   {\Xsub{\PRSymbol}{#1}     \left( #2
    \right)}
\newcommand{\Normali}[2]      {\Xsub{\NormalSymbol}{#1}   \left( #2
    \right)}
\newcommand{\Binomiali}[2]    {\Xsub{\BinomialSymbol}{#1}    \left( #2
    \right)}
\newcommand{\Bernoullii}[2]   {\Xsub{\BernoulliSymbol}{#1}    \left( #2
    \right)}
\newcommand{\Exponentiali}[2] {\Xsub{\ExponentialSymbol}{#1}    \left( #2
    \right)}
\newcommand{\Poissoni}[2]     {\Xsub{\PoissonSymbol}{#1}   \left( #2
    \right)}

\)
</p>
<div id="regression" class="section level1">
<h1><span class="header-section-number">Chapter 22</span> Regression</h1>
<p>Load data sets of this chapter</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="regression.html#cb159-1"></a><span class="kw">data</span>(<span class="st">&quot;apm&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb159-2"><a href="regression.html#cb159-2"></a><span class="kw">data</span>(<span class="st">&quot;unique2010&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb159-3"><a href="regression.html#cb159-3"></a><span class="kw">data</span>(<span class="st">&quot;baby&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;DataRZ&quot;</span>)</span>
<span id="cb159-4"><a href="regression.html#cb159-4"></a></span>
<span id="cb159-5"><a href="regression.html#cb159-5"></a><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</span>
<span id="cb159-6"><a href="regression.html#cb159-6"></a><span class="kw">data</span>(<span class="st">&quot;Leinhardt&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;carData&quot;</span>)</span>
<span id="cb159-7"><a href="regression.html#cb159-7"></a><span class="kw">data</span>(<span class="st">&quot;Prestige&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;carData&quot;</span>)</span>
<span id="cb159-8"><a href="regression.html#cb159-8"></a><span class="kw">data</span>(<span class="st">&quot;gala&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;faraway&quot;</span>)</span></code></pre></div>
<div id="preperation" class="section level2">
<h2><span class="header-section-number">22.1</span> Preperation</h2>
<div id="plot-predictors" class="section level5 unnumbered">
<h5>Plot predictors</h5>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="regression.html#cb160-1"></a><span class="kw">library</span>(FunRZ)</span>
<span id="cb160-2"><a href="regression.html#cb160-2"></a><span class="kw">pairs</span>(iris, <span class="dt">lower.panel =</span> panel.smooth, <span class="dt">diag.panel =</span> panel.hist,</span>
<span id="cb160-3"><a href="regression.html#cb160-3"></a>      <span class="dt">upper.panel =</span> panel.cor)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-155-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="transform-and-check-for-na" class="section level5 unnumbered">
<h5>Transform and check for NA</h5>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="regression.html#cb161-1"></a><span class="kw">any</span>(<span class="kw">is.na</span>(iris<span class="op">$</span>Sepal.length))</span>
<span id="cb161-2"><a href="regression.html#cb161-2"></a>iris<span class="op">$</span>log_sepal &lt;-<span class="st"> </span><span class="kw">log</span>(iris<span class="op">$</span>Sepal.length)</span></code></pre></div>
</div>
</div>
<div id="fit" class="section level2">
<h2><span class="header-section-number">22.2</span> Fit</h2>
<ul>
<li><code>lm()</code> fit linear model</li>
<li>Extract values
<ul>
<li><code>residuals()</code> raw residuals</li>
<li><code>rstandard()</code> standardized residuals</li>
<li><code>rstudent()</code> studentized residuals</li>
<li><code>sigma()</code> residual standard deviation <span class="math inline">\(\sigma_E\)</span> (alternative <code>summary(fit)$sigma</code>)</li>
</ul></li>
</ul>
</div>
<div id="inference" class="section level2">
<h2><span class="header-section-number">22.3</span> Inference</h2>
<ul>
<li><code>summary()</code> estimates, std. error, p values, multiple R-squared</li>
<li><code>confint()</code> CI</li>
</ul>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="regression.html#cb162-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Pax <span class="op">~</span><span class="st"> </span>ATM, <span class="dt">data =</span> unique2010)</span></code></pre></div>
<p>Automatic testing <span class="math inline">\(H_0: \beta_j = 0\)</span></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="regression.html#cb163-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Pax ~ ATM, data = unique2010)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -104188  -40885    2099   48588   89154 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.198e+06  1.524e+05  -7.858 7.94e-08 ***
## ATM          1.388e+02  6.878e+00  20.176 1.11e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 59700 on 22 degrees of freedom
## Multiple R-squared:  0.9487, Adjusted R-squared:  0.9464 
## F-statistic: 407.1 on 1 and 22 DF,  p-value: 1.11e-15</code></pre>
<p>Manual testing <span class="math inline">\(H_0: \beta_j = b\)</span></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="regression.html#cb165-1"></a>b &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co"># for example</span></span>
<span id="cb165-2"><a href="regression.html#cb165-2"></a>mycoef &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)<span class="op">$</span>coefficients</span>
<span id="cb165-3"><a href="regression.html#cb165-3"></a>t_val &lt;-<span class="st"> </span>(mycoef[<span class="st">&quot;(Intercept)&quot;</span>,<span class="st">&quot;Estimate&quot;</span>]<span class="op">-</span>b)<span class="op">/</span>mycoef[<span class="st">&quot;(Intercept)&quot;</span>,<span class="st">&quot;Std. Error&quot;</span>]</span>
<span id="cb165-4"><a href="regression.html#cb165-4"></a>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(t_val), df))<span class="op">*</span><span class="dv">2</span>    <span class="co">## df = degrees of freedom of residuals (find in summary)</span></span>
<span id="cb165-5"><a href="regression.html#cb165-5"></a>                            <span class="co">## *2 two sided test</span></span></code></pre></div>
<p>Automatic CI</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="regression.html#cb166-1"></a><span class="kw">confint</span>(fit, <span class="st">&quot;ATM&quot;</span>)</span>
<span id="cb166-2"><a href="regression.html#cb166-2"></a><span class="kw">confint</span>(fit, <span class="st">&quot;(Intercept)&quot;</span>)</span></code></pre></div>
<p>Manual CI</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="regression.html#cb167-1"></a>mycoef &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)<span class="op">$</span>coefficients</span>
<span id="cb167-2"><a href="regression.html#cb167-2"></a>mycoef[<span class="st">&quot;(Intercept)&quot;</span>,<span class="st">&quot;Estimate&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>), df)<span class="op">*</span>mycoef[<span class="st">&quot;(Intercept)&quot;</span>,<span class="st">&quot;Std. Error&quot;</span>] <span class="co">## df = degrees of freedom of residuals</span></span></code></pre></div>
</div>
<div id="prediction" class="section level2">
<h2><span class="header-section-number">22.4</span> Prediction</h2>
<ul>
<li><code>fitted()</code> fitted values</li>
<li><code>predict()</code> predict for any predictor value
<ul>
<li><code>newdata</code> needs to be a <code>data.frame</code> with same colomn name as predictors</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="regression.html#cb168-1"></a><span class="co">## Predict values for any predictor values</span></span>
<span id="cb168-2"><a href="regression.html#cb168-2"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ATM=</span><span class="kw">c</span>(<span class="dv">24000</span>))</span>
<span id="cb168-3"><a href="regression.html#cb168-3"></a><span class="kw">predict</span>(fit, <span class="dt">newdata=</span>dat)</span></code></pre></div>
<pre><code>##       1 
## 2132598</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="regression.html#cb170-1"></a><span class="co">## CI for regression line</span></span>
<span id="cb170-2"><a href="regression.html#cb170-2"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ATM=</span><span class="kw">seq</span>(<span class="dv">18000</span>, <span class="dv">26000</span>, <span class="dt">length=</span><span class="dv">200</span>))</span>
<span id="cb170-3"><a href="regression.html#cb170-3"></a>ci &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata=</span>dat, <span class="dt">interval=</span><span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb170-4"><a href="regression.html#cb170-4"></a></span>
<span id="cb170-5"><a href="regression.html#cb170-5"></a><span class="co">## PI for regression line</span></span>
<span id="cb170-6"><a href="regression.html#cb170-6"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ATM=</span><span class="kw">seq</span>(<span class="dv">18000</span>, <span class="dv">26000</span>, <span class="dt">length=</span><span class="dv">200</span>))</span>
<span id="cb170-7"><a href="regression.html#cb170-7"></a>pi &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata=</span>dat, <span class="dt">interval=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
</div>
<div id="plot-regression" class="section level2">
<h2><span class="header-section-number">22.5</span> Plot regression</h2>
<p>Include regression formula</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="regression.html#cb171-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb171-2"><a href="regression.html#cb171-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb171-3"><a href="regression.html#cb171-3"></a>y &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb171-4"><a href="regression.html#cb171-4"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb171-5"><a href="regression.html#cb171-5"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb171-6"><a href="regression.html#cb171-6"></a><span class="kw">abline</span>(fit)</span>
<span id="cb171-7"><a href="regression.html#cb171-7"></a>x_cor &lt;-<span class="st"> </span><span class="kw">grconvertX</span>(<span class="fl">0.1</span>, <span class="dt">from =</span> <span class="st">&#39;npc&#39;</span>)</span>
<span id="cb171-8"><a href="regression.html#cb171-8"></a>y_cor &lt;-<span class="st"> </span><span class="kw">grconvertY</span>(<span class="fl">0.9</span>, <span class="dt">from =</span> <span class="st">&#39;npc&#39;</span>)</span>
<span id="cb171-9"><a href="regression.html#cb171-9"></a>fit_eq &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">coef</span>(fit), <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb171-10"><a href="regression.html#cb171-10"></a>fit_r_sq &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">summary</span>(fit)<span class="op">$</span>adj.r.squared, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb171-11"><a href="regression.html#cb171-11"></a>fit_cor &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">cor</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb171-12"><a href="regression.html#cb171-12"></a></span>
<span id="cb171-13"><a href="regression.html#cb171-13"></a><span class="kw">text</span>(<span class="dt">x =</span> x_cor, <span class="dt">y =</span> y_cor, <span class="dt">pos =</span> <span class="dv">4</span>,</span>
<span id="cb171-14"><a href="regression.html#cb171-14"></a>     <span class="dt">labels =</span> <span class="kw">bquote</span>(y <span class="op">==</span><span class="st"> </span>.(fit_eq[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>.(fit_eq[<span class="dv">1</span>])))</span>
<span id="cb171-15"><a href="regression.html#cb171-15"></a><span class="kw">text</span>(<span class="dt">x =</span> x_cor, <span class="dt">y =</span> y_cor<span class="dv">-1</span>, <span class="dt">pos =</span> <span class="dv">4</span>,</span>
<span id="cb171-16"><a href="regression.html#cb171-16"></a>     <span class="dt">labels =</span> <span class="kw">bquote</span>(R[adj]<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span>.(fit_r_sq)))</span>
<span id="cb171-17"><a href="regression.html#cb171-17"></a><span class="kw">text</span>(<span class="dt">x =</span> x_cor, <span class="dt">y =</span> y_cor<span class="dv">-2</span>, <span class="dt">pos =</span> <span class="dv">4</span>,</span>
<span id="cb171-18"><a href="regression.html#cb171-18"></a>     <span class="dt">labels =</span> <span class="kw">bquote</span>(cor <span class="op">==</span><span class="st"> </span>.(fit_cor)))</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-163-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<p>Include CI and PI</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="regression.html#cb172-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Pax <span class="op">~</span><span class="st"> </span>ATM, <span class="dt">data =</span> unique2010)</span>
<span id="cb172-2"><a href="regression.html#cb172-2"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ATM=</span><span class="kw">seq</span>(<span class="dv">18000</span>, <span class="dv">26000</span>, <span class="dt">length=</span><span class="dv">200</span>))</span>
<span id="cb172-3"><a href="regression.html#cb172-3"></a>ci &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata=</span>dat, <span class="dt">interval=</span><span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb172-4"><a href="regression.html#cb172-4"></a>pi &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata=</span>dat, <span class="dt">interval=</span><span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb172-5"><a href="regression.html#cb172-5"></a><span class="kw">plot</span>(Pax <span class="op">~</span><span class="st"> </span>ATM, <span class="dt">data=</span>unique2010, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb172-6"><a href="regression.html#cb172-6"></a></span>
<span id="cb172-7"><a href="regression.html#cb172-7"></a><span class="kw">lines</span>(dat<span class="op">$</span>ATM, ci[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb172-8"><a href="regression.html#cb172-8"></a><span class="kw">lines</span>(dat<span class="op">$</span>ATM, ci[,<span class="dv">3</span>], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb172-9"><a href="regression.html#cb172-9"></a><span class="kw">lines</span>(dat<span class="op">$</span>ATM, pi[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb172-10"><a href="regression.html#cb172-10"></a><span class="kw">lines</span>(dat<span class="op">$</span>ATM, pi[,<span class="dv">3</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb172-11"><a href="regression.html#cb172-11"></a><span class="kw">abline</span>(fit, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-164-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<p>Regression line with log transformation</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="regression.html#cb173-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(infant) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(income), <span class="dt">data =</span> Leinhardt)</span>
<span id="cb173-2"><a href="regression.html#cb173-2"></a><span class="kw">plot</span>(infant <span class="op">~</span><span class="st"> </span>income, <span class="dt">data =</span> Leinhardt)</span>
<span id="cb173-3"><a href="regression.html#cb173-3"></a>my_pre &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">income =</span> <span class="kw">seq</span>(<span class="kw">min</span>(Leinhardt<span class="op">$</span>income), <span class="kw">max</span>(Leinhardt<span class="op">$</span>income), <span class="dt">length.out =</span> <span class="dv">200</span>))</span>
<span id="cb173-4"><a href="regression.html#cb173-4"></a>my_pre<span class="op">$</span>infant &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">predict</span>(fit, <span class="dt">newdata =</span> my_pre))</span>
<span id="cb173-5"><a href="regression.html#cb173-5"></a><span class="kw">lines</span>(my_pre<span class="op">$</span>income, my_pre<span class="op">$</span>infant)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-165-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="model-comparison" class="section level2">
<h2><span class="header-section-number">22.6</span> Model comparison</h2>
<ul>
<li>Gobal F-test <code>summary()</code></li>
<li>Partial F-test
<ul>
<li><code>anova()</code>
<ul>
<li>perfect but both models need to be specified</li>
<li>significance means evidence against the simpler model</li>
</ul></li>
<li><code>drop1()</code>
<ul>
<li>drops only single terms</li>
<li>correctly handles factors/interactions
<ul>
<li>no testing of single factor levels (factor as a whole is tested)</li>
<li>hirarchical structure is considered (first drop interaction before droping main factor)</li>
</ul></li>
</ul></li>
<li><code>summary()</code>
<ul>
<li>drops only single parameters</li>
<li>wrong handling of factors/interactions</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="diagnostic-plots" class="section level2">
<h2><span class="header-section-number">22.7</span> Diagnostic plots</h2>
<div id="tukey-anscombe-plot" class="section level3">
<h3><span class="header-section-number">22.7.1</span> Tukey-Anscombe plot</h3>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-167-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-167-2.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-167-3.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-167-4.png" width="50%" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="regression.html#cb174-1"></a><span class="co"># Automatic</span></span>
<span id="cb174-2"><a href="regression.html#cb174-2"></a><span class="kw">plot</span>(fit, <span class="dt">which =</span> <span class="dv">1</span>)</span>
<span id="cb174-3"><a href="regression.html#cb174-3"></a></span>
<span id="cb174-4"><a href="regression.html#cb174-4"></a><span class="co"># Manual</span></span>
<span id="cb174-5"><a href="regression.html#cb174-5"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(fit), <span class="kw">residuals</span>(fit))</span>
<span id="cb174-6"><a href="regression.html#cb174-6"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</span>
<span id="cb174-7"><a href="regression.html#cb174-7"></a><span class="kw">lines</span>(<span class="kw">loess.smooth</span>(<span class="kw">fitted</span>(fit), <span class="kw">residuals</span>(fit)),</span>
<span id="cb174-8"><a href="regression.html#cb174-8"></a>      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb174-9"><a href="regression.html#cb174-9"></a></span>
<span id="cb174-10"><a href="regression.html#cb174-10"></a><span class="co"># Resampling</span></span>
<span id="cb174-11"><a href="regression.html#cb174-11"></a>FunRZ<span class="op">::</span><span class="kw">FunResplot</span>(fit, <span class="dt">plot =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="normal-qq-plot" class="section level3">
<h3><span class="header-section-number">22.7.2</span> Normal QQ plot</h3>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-169-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-169-2.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-169-3.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-169-4.png" width="50%" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="regression.html#cb175-1"></a><span class="co"># Automatic</span></span>
<span id="cb175-2"><a href="regression.html#cb175-2"></a><span class="kw">plot</span>(fit, <span class="dt">which =</span> <span class="dv">2</span>)</span>
<span id="cb175-3"><a href="regression.html#cb175-3"></a></span>
<span id="cb175-4"><a href="regression.html#cb175-4"></a><span class="co"># Manual</span></span>
<span id="cb175-5"><a href="regression.html#cb175-5"></a><span class="kw">qqnorm</span>(<span class="kw">rstandard</span>(fit))</span>
<span id="cb175-6"><a href="regression.html#cb175-6"></a><span class="kw">qqline</span>(<span class="kw">rstandard</span>(fit))</span>
<span id="cb175-7"><a href="regression.html#cb175-7"></a></span>
<span id="cb175-8"><a href="regression.html#cb175-8"></a><span class="co"># Resampling</span></span>
<span id="cb175-9"><a href="regression.html#cb175-9"></a>FunRZ<span class="op">::</span><span class="kw">FunResplot</span>(fit, <span class="dt">plot =</span> <span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="scale-location-plot" class="section level3">
<h3><span class="header-section-number">22.7.3</span> Scale-Location plot</h3>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-171-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-171-2.png" width="50%" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="regression.html#cb176-1"></a><span class="co"># Automatic</span></span>
<span id="cb176-2"><a href="regression.html#cb176-2"></a><span class="kw">plot</span>(fit, <span class="dt">which =</span> <span class="dv">3</span>)</span>
<span id="cb176-3"><a href="regression.html#cb176-3"></a></span>
<span id="cb176-4"><a href="regression.html#cb176-4"></a><span class="co"># Manual</span></span>
<span id="cb176-5"><a href="regression.html#cb176-5"></a>res &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">abs</span>((<span class="kw">rstandard</span>(fit))))</span>
<span id="cb176-6"><a href="regression.html#cb176-6"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(fit), res)</span>
<span id="cb176-7"><a href="regression.html#cb176-7"></a><span class="kw">lines</span>(<span class="kw">loess.smooth</span>(<span class="kw">fitted</span>(fit), res),</span>
<span id="cb176-8"><a href="regression.html#cb176-8"></a>      <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb176-9"><a href="regression.html#cb176-9"></a></span>
<span id="cb176-10"><a href="regression.html#cb176-10"></a><span class="co"># Resampling</span></span>
<span id="cb176-11"><a href="regression.html#cb176-11"></a>FunRZ<span class="op">::</span><span class="kw">FunResplot</span>(fit, <span class="dt">plot =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="leverage-plot" class="section level3">
<h3><span class="header-section-number">22.7.4</span> Leverage plot</h3>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-173-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-173-2.png" width="50%" /></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="regression.html#cb177-1"></a><span class="co"># Automatic</span></span>
<span id="cb177-2"><a href="regression.html#cb177-2"></a><span class="kw">plot</span>(fit, <span class="dt">which =</span> <span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="residuals-vs-any" class="section level3">
<h3><span class="header-section-number">22.7.5</span> Residuals vs any</h3>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-175-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-175-2.png" width="50%" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="regression.html#cb178-1"></a><span class="co"># vs Predictors</span></span>
<span id="cb178-2"><a href="regression.html#cb178-2"></a><span class="kw">plot</span>(<span class="kw">residuals</span>(fit) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> df)</span>
<span id="cb178-3"><a href="regression.html#cb178-3"></a></span>
<span id="cb178-4"><a href="regression.html#cb178-4"></a><span class="co"># vs Possible predictors</span></span>
<span id="cb178-5"><a href="regression.html#cb178-5"></a><span class="kw">plot</span>(<span class="kw">residuals</span>(fit) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> df)</span>
<span id="cb178-6"><a href="regression.html#cb178-6"></a></span>
<span id="cb178-7"><a href="regression.html#cb178-7"></a><span class="co"># vs Temporal/Spatial information</span></span>
<span id="cb178-8"><a href="regression.html#cb178-8"></a><span class="kw">plot</span>(<span class="kw">residuals</span>(fit))  <span class="co">## against Index</span></span>
<span id="cb178-9"><a href="regression.html#cb178-9"></a><span class="kw">plot</span>(<span class="kw">residuals</span>(fit) <span class="op">~</span><span class="st"> </span>Time<span class="op">-</span>Space<span class="op">-</span>Variable)</span></code></pre></div>
</div>
<div id="partial-residual-plot" class="section level3">
<h3><span class="header-section-number">22.7.6</span> Partial residual plot</h3>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-177-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-177-2.png" width="50%" /></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="regression.html#cb179-1"></a><span class="co"># Automatic</span></span>
<span id="cb179-2"><a href="regression.html#cb179-2"></a>car<span class="op">::</span><span class="kw">crPlots</span>(fit)</span>
<span id="cb179-3"><a href="regression.html#cb179-3"></a>car<span class="op">::</span><span class="kw">crPlot</span>(fit, <span class="dt">variable =</span> x1)</span>
<span id="cb179-4"><a href="regression.html#cb179-4"></a></span>
<span id="cb179-5"><a href="regression.html#cb179-5"></a><span class="co"># Manual</span></span>
<span id="cb179-6"><a href="regression.html#cb179-6"></a>myres &lt;-<span class="st"> </span><span class="kw">residuals</span>(fit, <span class="dt">type =</span> <span class="st">&quot;partial&quot;</span>)</span>
<span id="cb179-7"><a href="regression.html#cb179-7"></a>mycof &lt;-<span class="st"> </span>fit<span class="op">$</span>coefficients</span>
<span id="cb179-8"><a href="regression.html#cb179-8"></a><span class="co">## for target variable x1</span></span>
<span id="cb179-9"><a href="regression.html#cb179-9"></a><span class="kw">plot</span>(myres[,<span class="st">&quot;x1&quot;</span>] <span class="op">~</span><span class="st"> </span>x1)</span>
<span id="cb179-10"><a href="regression.html#cb179-10"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="op">-</span>mycof[<span class="st">&quot;x1&quot;</span>]<span class="op">*</span><span class="kw">mean</span>(x1), <span class="dt">b =</span> mycof[<span class="st">&quot;x1&quot;</span>])</span>
<span id="cb179-11"><a href="regression.html#cb179-11"></a><span class="kw">lines</span>(<span class="kw">loess.smooth</span>(x1, myres[,<span class="st">&quot;x1&quot;</span>]), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="model-improvement" class="section level2">
<h2><span class="header-section-number">22.8</span> Model improvement</h2>
<div id="multicollinearity" class="section level3">
<h3><span class="header-section-number">22.8.1</span> Multicollinearity</h3>
<p>The variance inflation factor <span class="math inline">\(\text{VIF}\)</span> quantifies the multicollinearity between predictor variables.</p>
<ul>
<li>Fit contains only numerical predictors: <span class="math inline">\(\text{VIF} &gt; 5\)</span> critically</li>
<li>Fit contains also factorial predictors: <code>GVIF^(1/(2*Df))</code> <span class="math inline">\(&gt; 5\)</span> critically</li>
</ul>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="regression.html#cb180-1"></a><span class="co">## Only numerical predictors</span></span>
<span id="cb180-2"><a href="regression.html#cb180-2"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Pax <span class="op">~</span><span class="st"> </span>ATM <span class="op">+</span><span class="st"> </span>Cargo, <span class="dt">data =</span> unique2010)</span>
<span id="cb180-3"><a href="regression.html#cb180-3"></a>car<span class="op">::</span><span class="kw">vif</span>(fit)</span>
<span id="cb180-4"><a href="regression.html#cb180-4"></a><span class="co">##      ATM    Cargo </span></span>
<span id="cb180-5"><a href="regression.html#cb180-5"></a><span class="co">## 1.052416 1.052416</span></span>
<span id="cb180-6"><a href="regression.html#cb180-6"></a></span>
<span id="cb180-7"><a href="regression.html#cb180-7"></a><span class="co">## Contains fatorial predictor</span></span>
<span id="cb180-8"><a href="regression.html#cb180-8"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width <span class="op">+</span><span class="st"> </span>Species, <span class="dt">data =</span> iris)</span>
<span id="cb180-9"><a href="regression.html#cb180-9"></a>car<span class="op">::</span><span class="kw">vif</span>(fit)</span>
<span id="cb180-10"><a href="regression.html#cb180-10"></a><span class="co">##                 GVIF Df GVIF^(1/(2*Df))</span></span>
<span id="cb180-11"><a href="regression.html#cb180-11"></a><span class="co">## Sepal.Width 1.668844  1        1.291837</span></span>
<span id="cb180-12"><a href="regression.html#cb180-12"></a><span class="co">## Species     1.668844  2        1.136590</span></span></code></pre></div>
</div>
<div id="aicbic" class="section level3">
<h3><span class="header-section-number">22.8.2</span> AIC/BIC</h3>
<p><span class="math display">\[\begin{align*}
\text{AIC} &amp;= -2\log(\text{L}) + 2p \\
\text{BIC} &amp;= -2\log(\text{L}) + \log(n)p
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\log(\text{L})\)</span> is the log likelihood, <span class="math inline">\(p\)</span> is the number of estimated parameters and <span class="math inline">\(n\)</span> is the number of observations.</p>
<ul>
<li><code>AIC()</code> Akaike information criterion</li>
<li><code>BIC()</code> Bayesian information criterion</li>
</ul>
<p>Interpretation</p>
<ul>
<li>Smaller is better</li>
<li>BIC usually stronger penalization for numbers of parameters</li>
<li>Evidence (<span class="math inline">\(\Delta \text{AIC}\)</span>, <span class="math inline">\(\Delta \text{BIC}\)</span>)
<ul>
<li>0-2 Weak</li>
<li>2-6 Positive</li>
<li>6-10 Strong</li>
<li>&gt; 10 Very strong</li>
</ul></li>
</ul>
</div>
<div id="variable-selection" class="section level3">
<h3><span class="header-section-number">22.8.3</span> Variable selection</h3>
<div id="backward-elimination" class="section level4">
<h4><span class="header-section-number">22.8.3.1</span> Backward elimination</h4>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="regression.html#cb181-1"></a><span class="co">## Manual</span></span>
<span id="cb181-2"><a href="regression.html#cb181-2"></a>fit01 &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span>JanTemp <span class="op">+</span><span class="st"> </span>JulyTemp <span class="op">+</span><span class="st"> </span>RelHum <span class="op">+</span><span class="st"> </span></span>
<span id="cb181-3"><a href="regression.html#cb181-3"></a><span class="st">        </span>Rain <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Dens <span class="op">+</span><span class="st"> </span>NonWhite <span class="op">+</span><span class="st"> </span>WhiteCollar <span class="op">+</span></span>
<span id="cb181-4"><a href="regression.html#cb181-4"></a><span class="st">        </span><span class="kw">log</span>(Pop) <span class="op">+</span><span class="st"> </span>House <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(HC) <span class="op">+</span></span>
<span id="cb181-5"><a href="regression.html#cb181-5"></a><span class="st">        </span><span class="kw">log</span>(NOx) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(SO2), <span class="dt">data=</span>apm) <span class="co"># full model</span></span>
<span id="cb181-6"><a href="regression.html#cb181-6"></a></span>
<span id="cb181-7"><a href="regression.html#cb181-7"></a><span class="kw">drop1</span>(fit01, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb181-8"><a href="regression.html#cb181-8"></a>fit02 &lt;-<span class="st"> </span><span class="kw">update</span>(fit, .<span class="op">~</span>. – House ) <span class="co"># remove predictor with highest p-value / highest AIC/BIC</span></span>
<span id="cb181-9"><a href="regression.html#cb181-9"></a><span class="kw">drop1</span>(fit02, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb181-10"><a href="regression.html#cb181-10"></a><span class="co"># ...</span></span>
<span id="cb181-11"><a href="regression.html#cb181-11"></a></span>
<span id="cb181-12"><a href="regression.html#cb181-12"></a><span class="co">## Automatic</span></span>
<span id="cb181-13"><a href="regression.html#cb181-13"></a>fit01 &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span>JanTemp <span class="op">+</span><span class="st"> </span>JulyTemp <span class="op">+</span><span class="st"> </span>RelHum <span class="op">+</span></span>
<span id="cb181-14"><a href="regression.html#cb181-14"></a><span class="st">        </span>Rain <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Dens <span class="op">+</span><span class="st"> </span>NonWhite <span class="op">+</span><span class="st"> </span>WhiteCollar <span class="op">+</span></span>
<span id="cb181-15"><a href="regression.html#cb181-15"></a><span class="st">        </span><span class="kw">log</span>(Pop) <span class="op">+</span><span class="st"> </span>House <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(HC) <span class="op">+</span></span>
<span id="cb181-16"><a href="regression.html#cb181-16"></a><span class="st">        </span><span class="kw">log</span>(NOx) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(SO2), <span class="dt">data=</span>apm)</span>
<span id="cb181-17"><a href="regression.html#cb181-17"></a>fit02 &lt;-<span class="st"> </span><span class="kw">step</span>(fit01, <span class="dt">direction =</span> <span class="st">&quot;backward&quot;</span>, <span class="dt">k =</span> <span class="dv">2</span>) <span class="co"># k defines selection criterion (AIC, BIC)</span></span></code></pre></div>
</div>
<div id="forward-selection" class="section level4">
<h4><span class="header-section-number">22.8.3.2</span> Forward selection</h4>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="regression.html#cb182-1"></a><span class="co">## Manual</span></span>
<span id="cb182-2"><a href="regression.html#cb182-2"></a>fit01 &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> apm)</span>
<span id="cb182-3"><a href="regression.html#cb182-3"></a>f_full &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span>JanTemp <span class="op">+</span><span class="st"> </span>JulyTemp <span class="op">+</span><span class="st"> </span>RelHum <span class="op">+</span></span>
<span id="cb182-4"><a href="regression.html#cb182-4"></a><span class="st">          </span>Rain <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Dens <span class="op">+</span><span class="st"> </span>NonWhite <span class="op">+</span><span class="st"> </span>WhiteCollar <span class="op">+</span></span>
<span id="cb182-5"><a href="regression.html#cb182-5"></a><span class="st">          </span><span class="kw">log</span>(Pop) <span class="op">+</span><span class="st"> </span>House <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(HC) <span class="op">+</span></span>
<span id="cb182-6"><a href="regression.html#cb182-6"></a><span class="st">          </span><span class="kw">log</span>(NOx) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(SO2), <span class="dt">data=</span>apm)</span>
<span id="cb182-7"><a href="regression.html#cb182-7"></a><span class="kw">add1</span>(fit01, <span class="dt">scope =</span> f_full, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb182-8"><a href="regression.html#cb182-8"></a>fit02 &lt;-<span class="st"> </span><span class="kw">update</span>(fit01, .<span class="op">~</span>. <span class="op">+</span><span class="st"> </span>NonWhite ) <span class="co"># add predictor with lowest p-value / lowest AIC/BIC</span></span>
<span id="cb182-9"><a href="regression.html#cb182-9"></a><span class="kw">add1</span>(fit02, <span class="dt">scope =</span> f_full, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb182-10"><a href="regression.html#cb182-10"></a><span class="co"># ...</span></span>
<span id="cb182-11"><a href="regression.html#cb182-11"></a></span>
<span id="cb182-12"><a href="regression.html#cb182-12"></a><span class="co">## Automatic</span></span>
<span id="cb182-13"><a href="regression.html#cb182-13"></a>f_full &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span>JanTemp <span class="op">+</span><span class="st"> </span>JulyTemp <span class="op">+</span><span class="st"> </span>RelHum <span class="op">+</span></span>
<span id="cb182-14"><a href="regression.html#cb182-14"></a><span class="st">        </span>Rain <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Dens <span class="op">+</span><span class="st"> </span>NonWhite <span class="op">+</span><span class="st"> </span>WhiteCollar <span class="op">+</span></span>
<span id="cb182-15"><a href="regression.html#cb182-15"></a><span class="st">        </span><span class="kw">log</span>(Pop) <span class="op">+</span><span class="st"> </span>House <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(HC) <span class="op">+</span></span>
<span id="cb182-16"><a href="regression.html#cb182-16"></a><span class="st">        </span><span class="kw">log</span>(NOx) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(SO2), <span class="dt">data=</span>apm)</span>
<span id="cb182-17"><a href="regression.html#cb182-17"></a>f_null &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> apm)</span>
<span id="cb182-18"><a href="regression.html#cb182-18"></a>sc &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">lower =</span> f_null, <span class="dt">upper =</span> f_full)</span>
<span id="cb182-19"><a href="regression.html#cb182-19"></a>fit02 &lt;-<span class="st"> </span><span class="kw">step</span>(f_null, <span class="dt">scope =</span> sc, <span class="dt">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="dt">k =</span> <span class="dv">2</span>) <span class="co"># k defines selection criterion (AIC, BIC)</span></span></code></pre></div>
</div>
<div id="both-directions" class="section level4">
<h4><span class="header-section-number">22.8.3.3</span> Both directions</h4>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="regression.html#cb183-1"></a>f_full &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span>JanTemp <span class="op">+</span><span class="st"> </span>JulyTemp <span class="op">+</span><span class="st"> </span>RelHum <span class="op">+</span></span>
<span id="cb183-2"><a href="regression.html#cb183-2"></a><span class="st">        </span>Rain <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Dens <span class="op">+</span><span class="st"> </span>NonWhite <span class="op">+</span><span class="st"> </span>WhiteCollar <span class="op">+</span></span>
<span id="cb183-3"><a href="regression.html#cb183-3"></a><span class="st">        </span><span class="kw">log</span>(Pop) <span class="op">+</span><span class="st"> </span>House <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(HC) <span class="op">+</span></span>
<span id="cb183-4"><a href="regression.html#cb183-4"></a><span class="st">        </span><span class="kw">log</span>(NOx) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(SO2), <span class="dt">data=</span>apm)</span>
<span id="cb183-5"><a href="regression.html#cb183-5"></a>fit02 &lt;-<span class="st"> </span><span class="kw">step</span>(f_full, <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="dt">k =</span> <span class="dv">2</span>) <span class="co"># k defines selection criterion (AIC, BIC)</span></span></code></pre></div>
</div>
<div id="all-possible-models" class="section level4">
<h4><span class="header-section-number">22.8.3.4</span> All possible models</h4>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="regression.html#cb184-1"></a>f_full &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span>JanTemp <span class="op">+</span><span class="st"> </span>JulyTemp <span class="op">+</span><span class="st"> </span>RelHum <span class="op">+</span></span>
<span id="cb184-2"><a href="regression.html#cb184-2"></a><span class="st">        </span>Rain <span class="op">+</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Dens <span class="op">+</span><span class="st"> </span>NonWhite <span class="op">+</span><span class="st"> </span>WhiteCollar <span class="op">+</span></span>
<span id="cb184-3"><a href="regression.html#cb184-3"></a><span class="st">        </span><span class="kw">log</span>(Pop) <span class="op">+</span><span class="st"> </span>House <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(HC) <span class="op">+</span></span>
<span id="cb184-4"><a href="regression.html#cb184-4"></a><span class="st">        </span><span class="kw">log</span>(NOx) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(SO2), <span class="dt">data=</span>apm)</span>
<span id="cb184-5"><a href="regression.html#cb184-5"></a>fit02 &lt;-<span class="st"> </span>leaps<span class="op">::</span><span class="kw">regsubsets</span>(<span class="kw">formula</span>(f_full), <span class="dt">nbest =</span> <span class="dv">1</span>, <span class="dt">dat =</span> apm, <span class="dt">nvmax =</span> <span class="dv">14</span>)</span>
<span id="cb184-6"><a href="regression.html#cb184-6"></a><span class="kw">plot</span>(fit02) <span class="co"># black predictors are included in the model</span></span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-183-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>

<div class="rmdcaution">
<code>leaps::regsubsets</code> cannot deal correctly with factor variables and interaction terms
(removes single factor levels instead of entire factor, removes main term even if interaction is still included)
</div>

</div>
<div id="select-model-with-lowest-predictive-mse" class="section level4">
<h4><span class="header-section-number">22.8.3.5</span> Select model with lowest predictive MSE</h4>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="regression.html#cb185-1"></a><span class="co">## Automatic (not recommended)</span></span>
<span id="cb185-2"><a href="regression.html#cb185-2"></a>DAAG<span class="op">::</span><span class="kw">CVlm</span>(data, formula, fold.number, ...)</span>
<span id="cb185-3"><a href="regression.html#cb185-3"></a></span>
<span id="cb185-4"><a href="regression.html#cb185-4"></a></span>
<span id="cb185-5"><a href="regression.html#cb185-5"></a><span class="co">## Manual (this code only test one possible model)</span></span>
<span id="cb185-6"><a href="regression.html#cb185-6"></a>dat &lt;-<span class="st"> </span>apm</span>
<span id="cb185-7"><a href="regression.html#cb185-7"></a></span>
<span id="cb185-8"><a href="regression.html#cb185-8"></a><span class="co"># Randomly shuffle the data</span></span>
<span id="cb185-9"><a href="regression.html#cb185-9"></a>dat &lt;-<span class="st"> </span>dat[<span class="kw">sample</span>(<span class="kw">nrow</span>(dat)), ]</span>
<span id="cb185-10"><a href="regression.html#cb185-10"></a></span>
<span id="cb185-11"><a href="regression.html#cb185-11"></a><span class="co"># Create 10 equally size folds</span></span>
<span id="cb185-12"><a href="regression.html#cb185-12"></a>f &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb185-13"><a href="regression.html#cb185-13"></a>folds &lt;-<span class="st"> </span><span class="kw">cut</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(dat)), <span class="dt">breaks =</span> f, <span class="dt">labels =</span> <span class="ot">FALSE</span>)</span>
<span id="cb185-14"><a href="regression.html#cb185-14"></a></span>
<span id="cb185-15"><a href="regression.html#cb185-15"></a><span class="co"># Perform 10 fold cross validation</span></span>
<span id="cb185-16"><a href="regression.html#cb185-16"></a>SE &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>, f)</span>
<span id="cb185-17"><a href="regression.html#cb185-17"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>f){</span>
<span id="cb185-18"><a href="regression.html#cb185-18"></a>  <span class="co">#Segement your data by fold using the which() function</span></span>
<span id="cb185-19"><a href="regression.html#cb185-19"></a>  testIndexes &lt;-<span class="st"> </span><span class="kw">which</span>(folds<span class="op">==</span>i,<span class="dt">arr.ind=</span><span class="ot">TRUE</span>)</span>
<span id="cb185-20"><a href="regression.html#cb185-20"></a>  testData &lt;-<span class="st"> </span>dat[testIndexes, ]</span>
<span id="cb185-21"><a href="regression.html#cb185-21"></a>  trainData &lt;-<span class="st"> </span>dat[<span class="op">-</span>testIndexes, ]</span>
<span id="cb185-22"><a href="regression.html#cb185-22"></a>  </span>
<span id="cb185-23"><a href="regression.html#cb185-23"></a>  <span class="co">#Use the test and train data partitions to check one model</span></span>
<span id="cb185-24"><a href="regression.html#cb185-24"></a>  fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Mortality <span class="op">~</span><span class="st"> </span>NonWhite, <span class="dt">data =</span> trainData)</span>
<span id="cb185-25"><a href="regression.html#cb185-25"></a>  pred &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata =</span> testData)</span>
<span id="cb185-26"><a href="regression.html#cb185-26"></a>  SE[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((testData<span class="op">$</span>Mortality <span class="op">-</span><span class="st"> </span>pred)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb185-27"><a href="regression.html#cb185-27"></a>}</span>
<span id="cb185-28"><a href="regression.html#cb185-28"></a><span class="kw">mean</span>(SE)</span></code></pre></div>
</div>
</div>
<div id="predictor-relevance" class="section level3">
<h3><span class="header-section-number">22.8.4</span> Predictor relevance</h3>
<p>significance <span class="math inline">\(\neq\)</span> relevance</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="regression.html#cb186-1"></a><span class="co">## Standardized coefficients</span></span>
<span id="cb186-2"><a href="regression.html#cb186-2"></a>lelaimpo<span class="op">::</span><span class="kw">calc.relim</span>(fit, <span class="dt">type =</span> <span class="st">&quot;betasq&quot;</span>, <span class="dt">rela =</span> <span class="ot">TRUE</span>)</span>
<span id="cb186-3"><a href="regression.html#cb186-3"></a></span>
<span id="cb186-4"><a href="regression.html#cb186-4"></a><span class="co">## LMG criterion</span></span>
<span id="cb186-5"><a href="regression.html#cb186-5"></a>lelaimpo<span class="op">::</span><span class="kw">calc.relim</span>(fit, <span class="dt">type =</span> <span class="st">&quot;lmg&quot;</span>, <span class="dt">rela =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="shrinkage" class="section level2">
<h2><span class="header-section-number">22.9</span> Shrinkage</h2>
<p>See chapter <a href="Computational-Statistics.html#Computational-Statistics">26</a></p>
</div>
<div id="smoothing" class="section level2">
<h2><span class="header-section-number">22.10</span> Smoothing</h2>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-187-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<div id="running-mean-yellow-box" class="section level3">
<h3><span class="header-section-number">22.10.1</span> Running mean (yellow box)</h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="regression.html#cb187-1"></a>fit &lt;-<span class="st"> </span><span class="kw">ksmooth</span>(unique2010<span class="op">$</span>ATM,unique2010<span class="op">$</span>Pax,  <span class="co"># Data</span></span>
<span id="cb187-2"><a href="regression.html#cb187-2"></a>               <span class="dt">kernel =</span> <span class="st">&quot;box&quot;</span>,                 <span class="co"># weighting of points</span></span>
<span id="cb187-3"><a href="regression.html#cb187-3"></a>               <span class="dt">bandwidth =</span> <span class="dv">1000</span>,               <span class="co"># spread of weighting function</span></span>
<span id="cb187-4"><a href="regression.html#cb187-4"></a>               <span class="dt">n.points =</span> <span class="dv">24</span>,                  <span class="co"># number of points which should be evaluated</span></span>
<span id="cb187-5"><a href="regression.html#cb187-5"></a>               <span class="dt">x.points =</span> unique2010<span class="op">$</span>ATM)      <span class="co"># where they should be evaluated</span></span>
<span id="cb187-6"><a href="regression.html#cb187-6"></a><span class="kw">plot</span>(unique2010<span class="op">$</span>ATM, unique2010<span class="op">$</span>Pax)</span>
<span id="cb187-7"><a href="regression.html#cb187-7"></a><span class="kw">lines</span>(fit)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-188-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<p><span class="math display">\[\begin{align*}
    &amp;&amp; 0.25 \cdot \text{bandwith} &amp;= Q_{75\%} \\
    \Rightarrow &amp;&amp; \text{bandwith} &amp;= \text{complete width of box}
\end{align*}\]</span></p>
</div>
<div id="gaussian-kernel-estimate-green-gaussian" class="section level3">
<h3><span class="header-section-number">22.10.2</span> Gaussian kernel estimate (green gaussian)</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="regression.html#cb188-1"></a>fit &lt;-<span class="st"> </span><span class="kw">ksmooth</span>(unique2010<span class="op">$</span>ATM,unique2010<span class="op">$</span>Pax,</span>
<span id="cb188-2"><a href="regression.html#cb188-2"></a>          <span class="dt">kernel =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb188-3"><a href="regression.html#cb188-3"></a>          <span class="dt">bandwidth =</span> <span class="dv">1000</span>,</span>
<span id="cb188-4"><a href="regression.html#cb188-4"></a>          <span class="dt">n.points =</span> <span class="dv">1000</span>)</span>
<span id="cb188-5"><a href="regression.html#cb188-5"></a><span class="kw">plot</span>(unique2010<span class="op">$</span>ATM, unique2010<span class="op">$</span>Pax)</span>
<span id="cb188-6"><a href="regression.html#cb188-6"></a><span class="kw">lines</span>(fit)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-189-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<p><span class="math display">\[\begin{align*}
 &amp;&amp; P(X \leq 0.25 \cdot \text{bandwith}) &amp;= 0.75 \\
 \Rightarrow &amp;&amp; P\left(Z \leq \frac{0.25 \cdot \text{bandwith}}{\sigma}\right) &amp;= 0.75 \\
 \Rightarrow &amp;&amp; \frac{0.25 \cdot \text{bandwith}}{\sigma} &amp;= \Phi^{-1}(0.75) \\
 \Rightarrow &amp;&amp; \text{bandwith} &amp;= \frac{\Phi^{-1}(0.75)}{0.25}\sigma
\end{align*}\]</span></p>
</div>
<div id="loess-smoother" class="section level3">
<h3><span class="header-section-number">22.10.3</span> LOESS smoother</h3>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="regression.html#cb189-1"></a>smoo &lt;-<span class="st"> </span><span class="kw">loess.smooth</span>(unique2010<span class="op">$</span>ATM,unique2010<span class="op">$</span>Pax,  <span class="co"># Data</span></span>
<span id="cb189-2"><a href="regression.html#cb189-2"></a>                     <span class="dt">span =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>,                     <span class="co"># smoothing parameter (smaller =&gt; smoother)</span></span>
<span id="cb189-3"><a href="regression.html#cb189-3"></a>                     <span class="dt">degree =</span> <span class="dv">1</span>,                     <span class="co"># 1: local linear regr, 2: local polynomial regr</span></span>
<span id="cb189-4"><a href="regression.html#cb189-4"></a>                     <span class="dt">family =</span> <span class="st">&quot;symmetric&quot;</span>)           <span class="co"># &quot;symmetric&quot;: robust fitting, &quot;gaussian&quot;: least squares fitting</span></span>
<span id="cb189-5"><a href="regression.html#cb189-5"></a></span>
<span id="cb189-6"><a href="regression.html#cb189-6"></a><span class="kw">plot</span>(unique2010<span class="op">$</span>ATM, unique2010<span class="op">$</span>Pax)</span>
<span id="cb189-7"><a href="regression.html#cb189-7"></a><span class="kw">lines</span>(fit)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-190-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
</div>
<div id="gam" class="section level2">
<h2><span class="header-section-number">22.11</span> GAM</h2>
<p>Use package <code>mgcv</code> and have a look into the book of Wood.</p>
<ul>
<li><code>mgcv::s()</code> smooth spline</li>
<li><code>mgcv::te()</code> interaction between two predictors</li>
<li><code>mgcv::ti()</code></li>
<li><code>mgcv::t2()</code></li>
<li><code>splines::ns()</code> natural spline</li>
<li><code>gam::lo()</code> loess</li>
</ul>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="regression.html#cb190-1"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb190-2"><a href="regression.html#cb190-2"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>)<span class="op">+</span><span class="dv">10</span><span class="op">*</span><span class="kw">sin</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>)<span class="op">*</span><span class="fl">0.2</span>)</span>
<span id="cb190-3"><a href="regression.html#cb190-3"></a><span class="kw">plot</span>(x, y)</span>
<span id="cb190-4"><a href="regression.html#cb190-4"></a><span class="kw">library</span>(mgcv)</span>
<span id="cb190-5"><a href="regression.html#cb190-5"></a>fit &lt;-<span class="st"> </span><span class="kw">gam</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x))</span>
<span id="cb190-6"><a href="regression.html#cb190-6"></a><span class="kw">lines</span>(x, <span class="kw">fitted</span>(fit))</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-191-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="regression.html#cb191-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## y ~ s(x)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   0.2373     0.1850   1.283    0.212
## 
## Approximate significance of smooth terms:
##        edf Ref.df     F p-value    
## s(x) 5.958  7.117 219.2  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.982   Deviance explained = 98.6%
## GCV = 1.3369  Scale est. = 1.0268    n = 30</code></pre>
<ul>
<li><code>edf</code> Empirical degrees of freedom</li>
<li><code>Ref.df</code> Alternative way to calculate df</li>
<li><code>GCV</code> Generalized cross validation score</li>
<li><code>Deviance explained</code> Equivalent to <span class="math inline">\(R^2\)</span></li>
<li><code>Scale est.</code> estimate of <span class="math inline">\(\sigma_E^2\)</span></li>
</ul>
<p>Deviance explained: Equivalent to R2 (not adjusted)
Scale est.: estimate of 𝜎_𝐸^2</p>
<div id="options" class="section level5 unnumbered">
<h5>Options</h5>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="regression.html#cb193-1"></a><span class="kw">s</span>(x1, <span class="dt">bs =</span> <span class="st">&quot;tp&quot;</span>) <span class="co"># tp: thin plate, cr: cubic spline</span></span>
<span id="cb193-2"><a href="regression.html#cb193-2"></a><span class="kw">s</span>(x1, <span class="dt">df =</span> <span class="dv">3</span>)    <span class="co"># prespecify the df (instead of determine it by CV)</span></span></code></pre></div>
</div>
<div id="diagnostics" class="section level5 unnumbered">
<h5>Diagnostics</h5>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="regression.html#cb194-1"></a>fit &lt;-<span class="st"> </span><span class="kw">gam</span>(Mortality <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(Educ), <span class="dt">data =</span> apm)</span>
<span id="cb194-2"><a href="regression.html#cb194-2"></a><span class="kw">gam.check</span>(fit)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-193-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<pre><code>## 
## Method: GCV   Optimizer: magic
## Smoothing parameter selection converged after 5 iterations.
## The RMS GCV score gradient at convergence was 0.0003494895 .
## The Hessian was positive definite.
## Model rank =  10 / 10 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##          k&#39; edf k-index p-value
## s(Educ) 9.0 2.1    1.03    0.54</code></pre>
<ul>
<li>low <code>p-value</code> and <code>k-index</code> &lt; 1 indicate that actual fit might need more flexibility
<ul>
<li>increase k-value manually</li>
<li><code>gam(Mortality ~ s(Educ, k = 50), data = apm)</code></li>
</ul></li>
</ul>
</div>
<div id="visualization" class="section level5 unnumbered">
<h5>Visualization</h5>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="regression.html#cb196-1"></a><span class="co">## Partial residual plot</span></span>
<span id="cb196-2"><a href="regression.html#cb196-2"></a>fit_gam &lt;-<span class="st"> </span><span class="kw">gam</span>(prestige <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(income) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(education), <span class="dt">data =</span> Prestige)</span>
<span id="cb196-3"><a href="regression.html#cb196-3"></a><span class="kw">plot</span>(fit_gam, <span class="dt">shade =</span> T, <span class="dt">residuals =</span> T, <span class="dt">main =</span> <span class="st">&quot;GAM Partial Residual Plot&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>)</span>
<span id="cb196-4"><a href="regression.html#cb196-4"></a></span>
<span id="cb196-5"><a href="regression.html#cb196-5"></a><span class="co">## 3D plot (only with exactly two s() terms)</span></span>
<span id="cb196-6"><a href="regression.html#cb196-6"></a><span class="kw">vis.gam</span>(fit_gam, <span class="dt">theta =</span> <span class="dv">45</span>, <span class="dt">phi =</span> <span class="dv">30</span>) <span class="co"># rotation arround vertical (theta) and horizontal (phi) axis</span></span>
<span id="cb196-7"><a href="regression.html#cb196-7"></a></span>
<span id="cb196-8"><a href="regression.html#cb196-8"></a><span class="co">## Interaction spline</span></span>
<span id="cb196-9"><a href="regression.html#cb196-9"></a>fit_gam &lt;-<span class="st"> </span><span class="kw">gam</span>(prestige <span class="op">~</span><span class="st"> </span><span class="kw">te</span>(income, education), <span class="dt">data =</span> Prestige)</span>
<span id="cb196-10"><a href="regression.html#cb196-10"></a><span class="kw">plot</span>(fit_gam)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-194-1.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-194-2.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-194-3.png" width="50%" /><img src="R_Ref_Book_files/figure-html/unnamed-chunk-194-4.png" width="50%" /></p>
</div>
<div id="model-comparison-1" class="section level5 unnumbered">
<h5>Model comparison</h5>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="regression.html#cb197-1"></a>fit_ols &lt;-<span class="st"> </span><span class="kw">lm</span>(prestige <span class="op">~</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>education, <span class="dt">data =</span> Prestige)</span>
<span id="cb197-2"><a href="regression.html#cb197-2"></a>fit_gam &lt;-<span class="st"> </span><span class="kw">gam</span>(prestige <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(income) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(education), <span class="dt">data =</span> Prestige)</span>
<span id="cb197-3"><a href="regression.html#cb197-3"></a><span class="kw">anova</span>(fit_ols, fit_gam, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: prestige ~ income + education
## Model 2: prestige ~ s(income) + s(education)
##   Res.Df    RSS     Df Sum of Sq  Pr(&gt;Chi)    
## 1 99.000 6038.9                               
## 2 94.705 4585.0 4.2951    1453.9 6.783e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In our case clear evidence for the more complex GAM model.</p>
</div>
<div id="alternatives" class="section level5 unnumbered">
<h5>Alternatives</h5>
<ul>
<li><code>smooth.spline()</code> only one dimensional splines</li>
<li>package <code>gam</code></li>
<li>package <code>earth</code></li>
</ul>
</div>
</div>
<div id="glm" class="section level2">
<h2><span class="header-section-number">22.12</span> GLM</h2>
<div id="logistic-regression" class="section level3">
<h3><span class="header-section-number">22.12.1</span> Logistic Regression</h3>
<div id="fitting" class="section level5 unnumbered">
<h5>Fitting</h5>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="regression.html#cb199-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(survival <span class="op">~</span><span class="st"> </span><span class="kw">log10</span>(weight) <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> baby, <span class="dt">family=</span>binomial)</span></code></pre></div>
<p>Possible warning messages of fitting</p>
<pre><code>Warning message:
glm.fit: algorithm did not converge</code></pre>
<p>Numerical optimization failed, coefficients are not trustworthy</p>
<pre><code>Warning message:
glm.fit: fitted probabilities numerically 0 or 1 occured</code></pre>
<p>Perfect separation between binary response options, possible to continue…</p>
</div>
<div id="inference-1" class="section level5 unnumbered">
<h5>Inference</h5>
<ul>
<li><code>summary()</code></li>
<li><code>drop1()</code></li>
</ul>
<p>Both should yield in similar results. <code>drop1()</code> might be better suited for factorial predictors and interactions (drops only terms which can be dropped).</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="regression.html#cb202-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survival ~ log10(weight) + age, family = binomial, 
##     data = baby)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2694  -0.7032   0.3813   0.6899   2.2186  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -42.81347    7.40864  -5.779 7.52e-09 ***
## log10(weight)  12.87954    2.72022   4.735 2.19e-06 ***
## age             0.15187    0.08857   1.715   0.0864 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 230.79  on 166  degrees of freedom
## Residual deviance: 158.56  on 164  degrees of freedom
## AIC: 164.56
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="regression.html#cb204-1"></a><span class="kw">drop1</span>(fit, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## survival ~ log10(weight) + age
##               Df Deviance    AIC     LRT  Pr(&gt;Chi)    
## &lt;none&gt;             158.56 164.56                      
## log10(weight)  1   188.70 192.70 30.1382 4.023e-08 ***
## age            1   161.58 165.58  3.0182   0.08234 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>A p-value for a “global F-test” can be manually computed</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="regression.html#cb206-1"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(fit<span class="op">$</span>null.deviance<span class="op">-</span>fit<span class="op">$</span>deviance, <span class="dt">df=</span>(fit<span class="op">$</span>df.null<span class="op">-</span>fit<span class="op">$</span>df.res))</span></code></pre></div>
<pre><code>## [1] 2.220446e-16</code></pre>
<p><strong>CI</strong></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="regression.html#cb208-1"></a><span class="co">## Automatic (slightly different (better) than manual CI)</span></span>
<span id="cb208-2"><a href="regression.html#cb208-2"></a><span class="kw">confint</span>(fit, <span class="st">&quot;log10(weight)&quot;</span>)</span></code></pre></div>
<pre><code>##     2.5 %    97.5 % 
##  7.868942 18.592123</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="regression.html#cb210-1"></a><span class="kw">confint</span>(fit, <span class="st">&quot;(Intercept)&quot;</span>)</span></code></pre></div>
<pre><code>##     2.5 %    97.5 % 
## -58.49314 -29.29536</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="regression.html#cb212-1"></a><span class="co">## Manual</span></span>
<span id="cb212-2"><a href="regression.html#cb212-2"></a>mycoef &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)<span class="op">$</span>coefficients</span>
<span id="cb212-3"><a href="regression.html#cb212-3"></a>mycoef[<span class="st">&quot;(Intercept)&quot;</span>,<span class="st">&quot;Estimate&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))<span class="op">*</span>mycoef[<span class="st">&quot;(Intercept)&quot;</span>,<span class="st">&quot;Std. Error&quot;</span>]</span></code></pre></div>
<pre><code>## [1] -57.33414 -28.29280</code></pre>
<p><strong>Coefficient of determination</strong> <span class="math inline">\(R^2\)</span></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="regression.html#cb214-1"></a>fit_dev &lt;-<span class="st"> </span>fit<span class="op">$</span>deviance</span>
<span id="cb214-2"><a href="regression.html#cb214-2"></a>fit_null &lt;-<span class="st"> </span>fit<span class="op">$</span>null.deviance</span>
<span id="cb214-3"><a href="regression.html#cb214-3"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(baby<span class="op">$</span>weight)</span>
<span id="cb214-4"><a href="regression.html#cb214-4"></a>R_<span class="dv">2</span> &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>((fit_dev<span class="op">-</span>fit_null)<span class="op">/</span>n))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>fit_null<span class="op">/</span>n))</span></code></pre></div>
</div>
<div id="visualization-1" class="section level5 unnumbered">
<h5>Visualization</h5>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="regression.html#cb215-1"></a><span class="co">## Bernoulli probability</span></span>
<span id="cb215-2"><a href="regression.html#cb215-2"></a>lin_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">type=</span><span class="st">&quot;link&quot;</span>)       <span class="co">## linear predictor</span></span>
<span id="cb215-3"><a href="regression.html#cb215-3"></a>bern_prob &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)  <span class="co">## bernoulli probability</span></span>
<span id="cb215-4"><a href="regression.html#cb215-4"></a><span class="kw">plot</span>(lin_pred, baby<span class="op">$</span>survival, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;linear predictor&quot;</span>)</span>
<span id="cb215-5"><a href="regression.html#cb215-5"></a><span class="kw">points</span>(lin_pred[baby<span class="op">$</span>survival<span class="op">==</span><span class="dv">0</span>], baby<span class="op">$</span>survival[baby<span class="op">$</span>survival<span class="op">==</span><span class="dv">0</span>], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb215-6"><a href="regression.html#cb215-6"></a><span class="kw">points</span>(lin_pred[baby<span class="op">$</span>survival<span class="op">==</span><span class="dv">1</span>], baby<span class="op">$</span>survival[baby<span class="op">$</span>survival<span class="op">==</span><span class="dv">1</span>], <span class="dt">pch =</span> <span class="dv">17</span>)</span>
<span id="cb215-7"><a href="regression.html#cb215-7"></a><span class="kw">lines</span>(<span class="kw">sort</span>(lin_pred), <span class="kw">sort</span>(bern_prob), <span class="dt">lty=</span><span class="dv">3</span>)</span>
<span id="cb215-8"><a href="regression.html#cb215-8"></a><span class="kw">title</span>(<span class="st">&quot;Survival vs. Linear Predictor&quot;</span>)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-201-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="regression.html#cb216-1"></a><span class="co">## Predictor space (only if exactly two predictors)</span></span>
<span id="cb216-2"><a href="regression.html#cb216-2"></a><span class="kw">plot</span>(age <span class="op">~</span><span class="st"> </span>weight, <span class="dt">data=</span>baby, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb216-3"><a href="regression.html#cb216-3"></a><span class="kw">points</span>(age <span class="op">~</span><span class="st"> </span>weight, <span class="dt">subset=</span>(survival<span class="op">==</span><span class="dv">0</span>), <span class="dt">data=</span>baby, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb216-4"><a href="regression.html#cb216-4"></a><span class="kw">points</span>(age <span class="op">~</span><span class="st"> </span>weight, <span class="dt">subset=</span>(survival<span class="op">==</span><span class="dv">1</span>), <span class="dt">data=</span>baby, <span class="dt">pch =</span> <span class="dv">17</span>)</span>
<span id="cb216-5"><a href="regression.html#cb216-5"></a><span class="kw">title</span>(<span class="st">&quot;Survival after Premature Birth&quot;</span>)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-201-2.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="diagnostics-1" class="section level5 unnumbered">
<h5>Diagnostics</h5>
<p>Different types of residuals</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="regression.html#cb217-1"></a><span class="kw">resid</span>(fit, <span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb217-2"><a href="regression.html#cb217-2"></a><span class="kw">resid</span>(fit, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>)</span></code></pre></div>
<p>Tukey-Anscombe plot should be done manually because we need a non-robust smoother</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="regression.html#cb218-1"></a>xx &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">type=</span><span class="st">&quot;link&quot;</span>)</span>
<span id="cb218-2"><a href="regression.html#cb218-2"></a>yy &lt;-<span class="st"> </span><span class="kw">residuals</span>(fit, <span class="dt">type=</span><span class="st">&quot;deviance&quot;</span>)</span>
<span id="cb218-3"><a href="regression.html#cb218-3"></a><span class="kw">plot</span>(xx, yy, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">main=</span><span class="st">&quot;Tukey-Anscombe Plot&quot;</span>)</span>
<span id="cb218-4"><a href="regression.html#cb218-4"></a><span class="kw">lines</span>(<span class="kw">loess.smooth</span>(xx, yy, <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb218-5"><a href="regression.html#cb218-5"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-203-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
</div>
<div id="poisson-regression" class="section level3">
<h3><span class="header-section-number">22.12.2</span> Poisson Regression</h3>
<div id="fitting-1" class="section level5 unnumbered">
<h5>Fitting</h5>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="regression.html#cb219-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(Species <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(Area) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Elevation) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Nearest) <span class="op">+</span></span>
<span id="cb219-2"><a href="regression.html#cb219-2"></a><span class="st">             </span><span class="kw">I</span>(<span class="kw">log</span>(Scruz<span class="fl">+0.4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Adjacent), <span class="dt">data =</span> gala, <span class="dt">family =</span> poisson)</span></code></pre></div>
</div>
<div id="inference-2" class="section level5 unnumbered">
<h5>Inference</h5>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="regression.html#cb220-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Species ~ log(Area) + log(Elevation) + log(Nearest) + 
##     I(log(Scruz + 0.4)) + log(Adjacent), family = poisson, data = gala)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -5.4226  -2.7223  -0.4634   2.5587   8.3320  
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          3.323245   0.286430  11.602  &lt; 2e-16 ***
## log(Area)            0.350370   0.018005  19.459  &lt; 2e-16 ***
## log(Elevation)       0.033108   0.057034   0.580  0.56158    
## log(Nearest)        -0.040153   0.014071  -2.854  0.00432 ** 
## I(log(Scruz + 0.4)) -0.035848   0.013207  -2.714  0.00664 ** 
## log(Adjacent)       -0.089452   0.006944 -12.882  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 3510.73  on 29  degrees of freedom
## Residual deviance:  359.94  on 24  degrees of freedom
## AIC: 532.77
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="diagnostics-2" class="section level5 unnumbered">
<h5>Diagnostics</h5>
<p>Residuals should lie within range <span class="math inline">\([-2, 2]\)</span>, this would not be fulfilled in our example:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="regression.html#cb222-1"></a>xx &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">type=</span><span class="st">&quot;link&quot;</span>)</span>
<span id="cb222-2"><a href="regression.html#cb222-2"></a>yy &lt;-<span class="st"> </span><span class="kw">resid</span>(fit, <span class="dt">type=</span><span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb222-3"><a href="regression.html#cb222-3"></a><span class="kw">plot</span>(xx, yy, <span class="dt">main=</span><span class="st">&quot;Tukey-Anscombe Plot&quot;</span>,</span>
<span id="cb222-4"><a href="regression.html#cb222-4"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Linear Predictor&quot;</span>,</span>
<span id="cb222-5"><a href="regression.html#cb222-5"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Pearson Residuals&quot;</span>,</span>
<span id="cb222-6"><a href="regression.html#cb222-6"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb222-7"><a href="regression.html#cb222-7"></a>smoo &lt;-<span class="st"> </span><span class="kw">loess.smooth</span>(xx, yy)</span>
<span id="cb222-8"><a href="regression.html#cb222-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb222-9"><a href="regression.html#cb222-9"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb222-10"><a href="regression.html#cb222-10"></a><span class="kw">lines</span>(smoo, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="R_Ref_Book_files/figure-html/unnamed-chunk-206-1.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": "https://github.com/retodomax/R_Ref_Book/edit/master/54-regr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
